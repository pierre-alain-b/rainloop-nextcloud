!function(n){var o={};function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="rainloop/v/0.0.0/static/js/min/",i(i.s=205)}([function(e,t,n){"use strict";n.r(t),n.d(t,"FileType",function(){return o}),n.d(t,"StorageResultType",function(){return i}),n.d(t,"Focused",function(){return a}),n.d(t,"State",function(){return r}),n.d(t,"StateType",function(){return s}),n.d(t,"Capa",function(){return c}),n.d(t,"KeyState",function(){return l}),n.d(t,"FolderType",function(){return u}),n.d(t,"ServerFolderType",function(){return d}),n.d(t,"LoginSignMeTypeAsString",function(){return p}),n.d(t,"LoginSignMeType",function(){return h}),n.d(t,"ComposeType",function(){return f}),n.d(t,"UploadErrorCode",function(){return m}),n.d(t,"SetSystemFoldersNotification",function(){return b}),n.d(t,"ClientSideKeyName",function(){return g}),n.d(t,"EventKeyCode",function(){return y}),n.d(t,"MessageSetAction",function(){return v}),n.d(t,"MessageSelectAction",function(){return S}),n.d(t,"DesktopNotification",function(){return O}),n.d(t,"MessagePriority",function(){return w}),n.d(t,"EditorDefaultType",function(){return T}),n.d(t,"ServerSecure",function(){return C}),n.d(t,"SearchDateType",function(){return A}),n.d(t,"SaveSettingsStep",function(){return E}),n.d(t,"Layout",function(){return F}),n.d(t,"FilterConditionField",function(){return j}),n.d(t,"FilterConditionType",function(){return N}),n.d(t,"FiltersAction",function(){return R}),n.d(t,"FilterRulesType",function(){return I}),n.d(t,"SignedVerifyStatus",function(){return L}),n.d(t,"ContactPropertyType",function(){return _}),n.d(t,"Magics",function(){return P}),n.d(t,"Ports",function(){return M}),n.d(t,"Notification",function(){return D});var o={Unknown:"unknown",Text:"text",Html:"html",Code:"code",Eml:"eml",WordText:"word-text",Pdf:"pdf",Image:"image",Audio:"audio",Video:"video",Sheet:"sheet",Presentation:"presentation",Certificate:"certificate",CertificateBin:"certificate-bin",Archive:"archive"},i={Success:"success",Abort:"abort",Error:"error",Unload:"unload"},a={None:"none",MessageList:"message-list",MessageView:"message-view",FolderList:"folder-list"},r={Empty:10,Login:20,Auth:30},s={Webmail:0,Admin:1},c={TwoFactor:"TWO_FACTOR",TwoFactorForce:"TWO_FACTOR_FORCE",OpenPGP:"OPEN_PGP",Prefetch:"PREFETCH",Gravatar:"GRAVATAR",Folders:"FOLDERS",Composer:"COMPOSER",Contacts:"CONTACTS",Reload:"RELOAD",Search:"SEARCH",SearchAdv:"SEARCH_ADV",MessageActions:"MESSAGE_ACTIONS",MessageListActions:"MESSAGELIST_ACTIONS",AttachmentsActions:"ATTACHMENTS_ACTIONS",DangerousActions:"DANGEROUS_ACTIONS",Settings:"SETTINGS",Help:"HELP",Themes:"THEMES",UserBackground:"USER_BACKGROUND",Sieve:"SIEVE",Filters:"FILTERS",AttachmentThumbnails:"ATTACHMENT_THUMBNAILS",Templates:"TEMPLATES",AutoLogout:"AUTOLOGOUT",AdditionalAccounts:"ADDITIONAL_ACCOUNTS",Identities:"IDENTITIES"},l={All:"all",None:"none",ContactList:"contact-list",MessageList:"message-list",FolderList:"folder-list",MessageView:"message-view",Compose:"compose",Settings:"settings",Menu:"menu",PopupComposeOpenPGP:"compose-open-pgp",PopupMessageOpenPGP:"message-open-pgp",PopupViewOpenPGP:"view-open-pgp",PopupKeyboardShortcutsHelp:"popup-keyboard-shortcuts-help",PopupAsk:"popup-ask"},u={Inbox:10,SentItems:11,Draft:12,Trash:13,Spam:14,Archive:15,NotSpam:80,User:99},d={USER:0,INBOX:1,SENT:2,DRAFTS:3,JUNK:4,TRASH:5,IMPORTANT:10,FLAGGED:11,ALL:12},p={DefaultOff:"defaultoff",DefaultOn:"defaulton",Unused:"unused"},h={DefaultOff:0,DefaultOn:1,Unused:2},f={Empty:"empty",Reply:"reply",ReplyAll:"replyall",Forward:"forward",ForwardAsAttachment:"forward-as-attachment",Draft:"draft",EditAsNew:"editasnew"},m={Normal:0,FileIsTooBig:1,FilePartiallyUploaded:2,FileNoUploaded:3,MissingTempFolder:4,FileOnSaveingError:5,FileType:98,Unknown:99},b={None:0,Sent:1,Draft:2,Spam:3,Trash:4,Archive:5},g={FoldersLashHash:0,MessagesInboxLastHash:1,MailBoxListSize:2,ExpandedFolders:3,FolderListSize:4,MessageListSize:5,LastReplyAction:6,LastSignMe:7,ComposeLastIdentityID:8,MessageHeaderFullInfo:9,MessageAttachmnetControls:10},y={Backspace:8,Tab:9,Enter:13,Esc:27,PageUp:33,PageDown:34,Left:37,Right:39,Up:38,Down:40,End:35,Home:36,Space:32,Insert:45,Delete:46,A:65,S:83},v={SetSeen:0,UnsetSeen:1,SetFlag:2,UnsetFlag:3},S={All:0,None:1,Invert:2,Unseen:3,Seen:4,Flagged:5,Unflagged:6},O={Allowed:0,NotAllowed:1,Denied:2,NotSupported:9},w={Low:5,Normal:3,High:1},T={Html:"Html",Plain:"Plain",HtmlForced:"HtmlForced",PlainForced:"PlainForced"},C={None:0,SSL:1,TLS:2},A={All:-1,Days3:3,Days7:7,Month:30},E={Animate:-2,Idle:-1,TrueResult:1,FalseResult:0},F={NoPreview:0,SidePreview:1,BottomPreview:2},j={From:"From",Recipient:"Recipient",Subject:"Subject",Header:"Header",Size:"Size"},N={Contains:"Contains",NotContains:"NotContains",EqualTo:"EqualTo",NotEqualTo:"NotEqualTo",Regex:"Regex",Over:"Over",Under:"Under"},R={None:"None",MoveTo:"MoveTo",Discard:"Discard",Vacation:"Vacation",Reject:"Reject",Forward:"Forward"},I={All:"All",Any:"Any"},L={UnknownPublicKeys:-4,UnknownPrivateKey:-3,Unverified:-2,Error:-1,None:0,Success:1},_={Unknown:0,FullName:10,FirstName:15,LastName:16,MiddleName:16,Nick:18,NamePrefix:20,NameSuffix:21,Email:30,Phone:31,Web:32,Birthday:40,Facebook:90,Skype:91,GitHub:92,Note:110,Custom:250},P={EventWhichMouseMiddle:3,ifvisibleIdle10s:10,BitLength2048:2048,BitLength1024:1024,Size350px:350,Size50px:50,Size20px:20,Size1px:1,Time30mInMin:30,Time60m:36e5,Time30m:18e5,Time20m:12e5,Time15m:9e5,Time10m:6e5,Time5m:3e5,Time3m:18e4,Time2m:12e4,Time1m:6e4,Time30s:3e4,Time10s:1e4,Time7s:7e3,Time5s:5e3,Time3s:3e3,Time1s:1e3,Time500ms:500,Time350ms:350,Time250ms:250,Time200ms:200,Time100ms:100,Time50ms:50,Time20ms:20,Time10ms:10,Time1ms:1},M={Imap:143,ImapSsl:993,Smtp:25,SmtpSsl:465,SmtpStartTls:587},D={InvalidToken:101,AuthError:102,AccessError:103,ConnectionError:104,CaptchaError:105,SocialFacebookLoginAccessDisable:106,SocialTwitterLoginAccessDisable:107,SocialGoogleLoginAccessDisable:108,DomainNotAllowed:109,AccountNotAllowed:110,AccountTwoFactorAuthRequired:120,AccountTwoFactorAuthError:121,CouldNotSaveNewPassword:130,CurrentPasswordIncorrect:131,NewPasswordShort:132,NewPasswordWeak:133,NewPasswordForbidden:134,ContactsSyncError:140,CantGetMessageList:201,CantGetMessage:202,CantDeleteMessage:203,CantMoveMessage:204,CantCopyMessage:205,CantSaveMessage:301,CantSendMessage:302,InvalidRecipients:303,CantSaveFilters:351,CantGetFilters:352,FiltersAreNotCorrect:355,CantCreateFolder:400,CantRenameFolder:401,CantDeleteFolder:402,CantSubscribeFolder:403,CantUnsubscribeFolder:404,CantDeleteNonEmptyFolder:405,CantSaveSettings:501,CantSavePluginSettings:502,DomainAlreadyExists:601,CantInstallPackage:701,CantDeletePackage:702,InvalidPluginPackage:703,UnsupportedPluginPackage:704,LicensingServerIsUnavailable:710,LicensingExpired:711,LicensingBanned:712,DemoSendMessageError:750,DemoAccountError:751,AccountAlreadyExists:801,AccountDoesNotExist:802,MailServerError:901,ClientViewError:902,InvalidInputArgument:903,AjaxFalse:950,AjaxAbort:951,AjaxParse:952,AjaxTimeout:953,UnknownNotification:999,UnknownError:999}},function(e,t,l){"use strict";var n=l(3),c=l.n(n),o=l(4),u=l.n(o),i=l(7),d=l.n(i),p=c.a.Opentip||{};p.styles=p.styles||{},p.styles.rainloop={extends:"standard",fixed:!0,target:!0,delay:.2,hideDelay:0,hideEffect:"fade",hideEffectDuration:.2,showEffect:"fade",showEffectDuration:.2,showOn:"mouseover click",removeElementsOnHide:!0,background:"#fff",shadow:!1,borderColor:"#999",borderRadius:2,borderWidth:1},p.styles.rainloopTip={extends:"rainloop",delay:.4,group:"rainloopTips"},p.styles.rainloopErrorTip={extends:"rainloop",className:"rainloopErrorTip"};var a=l(96),r=l.n(a),s=l(0),h=c.a.ko,f=d()(c.a);h.bindingHandlers.updateWidth={init:function(e,t){var n=d()(e),o=t(),i=function(){o(n.width()),c.a.setTimeout(function(){o(n.width())},s.Magics.Time500ms)};f.on("resize",i),i(),h.utils.domNodeDisposal.addDisposeCallback(e,function(){f.off("resize",i)})}},h.bindingHandlers.editor={init:function(e,t){var n=null,o=t(),i=l(95).default,a=function(){o&&o.__editor&&o.__editor.setHtmlOrPlain(o())},r=function(){o&&o.__editor&&o(o.__editor.getDataWithHtmlMark())};h.isObservable(o)&&i&&(n=new i(e,r,function(){o.__editor=n,a()},r),o.__fetchEditorValue=r,o.subscribe(a))}},h.bindingHandlers.json={init:function(e,t){d()(e).text(c.a.JSON.stringify(h.unwrap(t())))},update:function(e,t){d()(e).text(c.a.JSON.stringify(h.unwrap(t())))}},h.bindingHandlers.scrollerShadows={init:function(e){var t=d()(e),n=t.find("[data-scroller-shadows-content]")[0]||null,o=u.a.throttle(function(){t.toggleClass("scroller-shadow-top",8<n.scrollTop).toggleClass("scroller-shadow-bottom",n.scrollTop+8<n.scrollHeight-n.clientHeight)},100);n&&(d()(n).on("scroll resize",o),f.on("resize",o),h.utils.domNodeDisposal.addDisposeCallback(n,function(){d()(n).off(),f.off("resize",o)}))}},h.bindingHandlers.pikaday={init:function(e,t,n,o,i){h.bindingHandlers.textInput.init(e,t,n,o,i),r.a&&(e.__pikaday=new r.a({field:e}))}},h.bindingHandlers.visibleAnimated={init:function(e,t){var n=d()(e);n.addClass("rl-animated-inited"),h.unwrap(t())?n.show():n.hide()},update:function(e,t){var n=d()(e);h.unwrap(t())?(n.addClass("rl-animated-hidden").show(),u.a.delay(function(){n.removeClass("rl-animated-hidden")},10)):n.hide().removeClass("rl-animated-hidden")}},h.bindingHandlers.tooltip={init:function(t,e){var n=d()(t),o=e(),i="on"===(n.data("tooltip-mobile")||"off"),a=l(6);if(!a.bMobileDevice||i){var r=!h.isObservable(o)&&u.a.isFunction(o)?o():h.unwrap(o);if(t.__opentip=new p(t,{style:"rainloopTip",element:t,tipJoint:n.data("tooltip-join")||"bottom"}),a.dropdownVisibility.subscribe(function(e){e&&t.__opentip.hide()}),""===r?(t.__opentip.hide(),t.__opentip.deactivate(),t.__opentip.setContent("")):t.__opentip.activate(),"on"===(n.data("tooltip-i18n")||"on")){var s=l(10);t.__opentip.setContent(s.i18n(r)),s.trigger.subscribe(function(){t.__opentip.setContent(s.i18n(r))}),a.dropdownVisibility.subscribe(function(){t&&t.__opentip&&t.__opentip.setContent(s.i18n(r))})}else t.__opentip.setContent(r);f.on("rl.tooltips.diactivate",function(){t.__opentip.hide(),t.__opentip.deactivate()}),f.on("rl.tooltips.activate",function(){t.__opentip.activate()})}},update:function(e,t){var n=d()(e),o=t(),i="on"===(n.data("tooltip-mobile")||"off");if((!l(6).bMobileDevice||i)&&e.__opentip){var a=!h.isObservable(o)&&u.a.isFunction(o)?o():h.unwrap(o);a?(e.__opentip.setContent("on"===(n.data("tooltip-i18n")||"on")?l(10).i18n(a):a),e.__opentip.activate()):(e.__opentip.hide(),e.__opentip.deactivate(),e.__opentip.setContent(""))}}},h.bindingHandlers.tooltipErrorTip={init:function(e){var t,n=d()(e);e.__opentip=new p(e,{style:"rainloopErrorTip",hideOn:"mouseout click",element:e,tipJoint:n.data("tooltip-join")||"top"}),e.__opentip.deactivate(),d()(c.a.document).on("click",function(){e&&e.__opentip&&e.__opentip.hide()}),t=e,h.utils.domNodeDisposal.addDisposeCallback(t,function(){t&&t.__opentip&&t.__opentip.deactivate()})},update:function(e,t){var n=d()(e),o=t(),i=!h.isObservable(o)&&u.a.isFunction(o)?o():h.unwrap(o),a=e.__opentip;a&&(""===i?(a.hide(),a.deactivate(),a.setContent("")):u.a.delay(function(){n.is(":visible")?(a.setContent(i),a.activate(),a.show()):(a.hide(),a.deactivate(),a.setContent(""))},s.Magics.Time100ms))}},h.bindingHandlers.registrateBootstrapDropdown={init:function(e){var t=l(6);t&&t.data.aBootstrapDropdowns&&(t.data.aBootstrapDropdowns.push(d()(e)),d()(e).click(function(){l(2).detectDropdownVisibility()}))}},h.bindingHandlers.openDropdownTrigger={update:function(e,t){if(h.unwrap(t())){var n=d()(e);n.hasClass("open")||n.find(".dropdown-toggle").dropdown("toggle"),n.find(".dropdown-toggle").focus(),l(2).detectDropdownVisibility(),t()(!1)}}},h.bindingHandlers.dropdownCloser={init:function(e){d()(e).closest(".dropdown").on("click",".e-item",function(){d()(e).dropdown("toggle")})}},h.bindingHandlers.popover={init:function(e,t){d()(e).popover(h.unwrap(t())),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).popover("destroy")})}},h.bindingHandlers.csstext={},h.bindingHandlers.csstext.init=h.bindingHandlers.csstext.update=function(e,t){e&&e.styleSheet&&void 0!==e.styleSheet.cssText?e.styleSheet.cssText=h.unwrap(t()):d()(e).text(h.unwrap(t()))},h.bindingHandlers.resizecrop={init:function(e){d()(e).addClass("resizecrop").resizecrop({width:"100",height:"100",wrapperCSS:{"border-radius":"10px"}})},update:function(e,t){t()(),d()(e).resizecrop({width:"100",height:"100"})}},h.bindingHandlers.onKeyDown={init:function(e,t,n,o){d()(e).on("keydown.koOnKeyDown",function(e){return!e||t().call(o,e)}),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).off("keydown.koOnKeyDown")})}},h.bindingHandlers.onEnter={init:function(t,n,e,o){d()(t).on("keypress.koOnEnter",function(e){e&&13===c.a.parseInt(e.keyCode,10)&&(d()(t).trigger("change"),n().call(o))}),h.utils.domNodeDisposal.addDisposeCallback(t,function(){d()(t).off("keypress.koOnEnter")})}},h.bindingHandlers.onSpace={init:function(e,t,n,o){d()(e).on("keyup.koOnSpace",function(e){e&&32===c.a.parseInt(e.keyCode,10)&&t().call(o,e)}),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).off("keyup.koOnSpace")})}},h.bindingHandlers.onTab={init:function(e,t,n,o){d()(e).on("keydown.koOnTab",function(e){return!e||9!==c.a.parseInt(e.keyCode,10)||t().call(o,!!e.shiftKey)}),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).off("keydown.koOnTab")})}},h.bindingHandlers.onEsc={init:function(t,n,e,o){d()(t).on("keyup.koOnEsc",function(e){e&&27===c.a.parseInt(e.keyCode,10)&&(d()(t).trigger("change"),n().call(o))}),h.utils.domNodeDisposal.addDisposeCallback(t,function(){d()(t).off("keyup.koOnEsc")})}},h.bindingHandlers.clickOnTrue={update:function(e,t){h.unwrap(t())&&d()(e).click()}},h.bindingHandlers.modal={init:function(e,t){var n=l(6),o=l(2);d()(e).toggleClass("fade",!n.bMobileDevice).modal({keyboard:!1,show:h.unwrap(t())}).on("shown.koModal",o.windowResizeCallback).find(".close").on("click.koModal",function(){t()(!1)}),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).off("shown.koModal").find(".close").off("click.koModal")})},update:function(e,t){var n=l(6);d()(e).modal(h.unwrap(t())?"show":"hide"),n.$html.hasClass("rl-anim")&&(n.$html.addClass("rl-modal-animation"),u.a.delay(function(){n.$html.removeClass("rl-modal-animation")},s.Magics.Time500ms))}},h.bindingHandlers.moment={init:function(e,t){l(34).momentToNode(d()(e).addClass("moment").data("moment-time",h.unwrap(t())))},update:function(e,t){l(34).momentToNode(d()(e).data("moment-time",h.unwrap(t())))}},h.bindingHandlers.i18nInit={init:function(e){l(10).i18nToNodes(e)}},h.bindingHandlers.translatorInit={init:function(e){l(10).i18nToNodes(e)}},h.bindingHandlers.i18nUpdate={update:function(e,t){h.unwrap(t()),l(10).i18nToNodes(e)}},h.bindingHandlers.link={update:function(e,t){d()(e).attr("href",h.unwrap(t()))}},h.bindingHandlers.title={update:function(e,t){d()(e).attr("title",h.unwrap(t()))}},h.bindingHandlers.textF={init:function(e,t){d()(e).text(h.unwrap(t()))}},h.bindingHandlers.initDom={init:function(e,t){t()(e)}},h.bindingHandlers.initFixedTrigger={init:function(e,t){var n=h.unwrap(t()),o=d()(e),i=n[1]||0,a=d()(n[0]||null);(a=a[0]?a:null)&&f.resize(function(){var e=a?a.offset():null;e&&e.top&&o.css("top",e.top+i)})}},h.bindingHandlers.initResizeTrigger={init:function(e,t){var n=h.unwrap(t());d()(e).css({height:n[1],"min-height":n[1]})},update:function(e,t){var n=l(2),o=l(6),i=h.unwrap(t()),a=n.pInt(i[1]),r=0,s=d()(e).offset().top;0<s&&(s+=n.pInt(i[2]),a<(r=o.$win.height()-s)&&(a=r),d()(e).css({height:a,"min-height":a}))}},h.bindingHandlers.appendDom={update:function(e,t){d()(e).hide().empty().append(h.unwrap(t())).show()}},h.bindingHandlers.draggable={init:function(e,t,n){var o=l(6),r=l(2);if(!o.bMobileDevice){var i=n(),s=i&&i.droppableSelector?i.droppableSelector:"",a={distance:20,handle:".dragHandle",cursorAt:{top:22,left:3},refreshPositions:!0,scroll:!0,drag:null,stop:null,helper:null};s&&(a.drag=function(a){d()(s).each(function(){var e=d()(this),t=e.offset(),n=t.top+e.height();if(c.a.clearInterval(e.data("timerScroll")),e.data("timerScroll",!1),a.pageX>=t.left&&a.pageX<=t.left+e.width()){if(a.pageY>=n-100&&a.pageY<=n){var o=function(){e.scrollTop(e.scrollTop()+3),r.windowResize()};e.data("timerScroll",c.a.setInterval(o,10)),o()}if(a.pageY>=t.top&&a.pageY<=t.top+100){var i=function(){e.scrollTop(e.scrollTop()-3),r.windowResize()};e.data("timerScroll",c.a.setInterval(i,10)),i()}}})},a.stop=function(){d()(s).each(function(){var e=d()(this);c.a.clearInterval(e.data("timerScroll")),e.data("timerScroll",!1)})}),a.helper=function(e){return t()(e&&e.target?h.dataFor(e.target):null)},d()(e).draggable(a).on("mousedown.koDraggable",function(){r.removeInFocus()}),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).off("mousedown.koDraggable").draggable("destroy")})}}},h.bindingHandlers.droppable={init:function(e,t,n){if(!l(6).bMobileDevice){var o=t(),i=n(),a=i&&i.droppableOver?i.droppableOver:null,r=i&&i.droppableOut?i.droppableOut:null,s={tolerance:"pointer",hoverClass:"droppableHover",drop:null,over:null,out:null};o&&(s.drop=function(e,t){o(e,t)},a&&(s.over=function(e,t){a(e,t)}),r&&(s.out=function(e,t){r(e,t)}),d()(e).droppable(s),h.utils.domNodeDisposal.addDisposeCallback(e,function(){d()(e).droppable("destroy")}))}}},h.bindingHandlers.nano={init:function(e){var t=l(6),n=l(5);t.bDisableNanoScroll||n.appSettingsGet("useNativeScrollbars")||d()(e).addClass("nano").nanoScroller({iOSNativeScrolling:!1,preventPageScrolling:!0})}},h.bindingHandlers.saveTrigger={init:function(e){var t=d()(e);t.data("save-trigger-type",t.is("input[type=text],input[type=email],input[type=password],select,textarea")?"input":"custom"),"custom"===t.data("save-trigger-type")?t.append('&nbsp;&nbsp;<i class="icon-spinner animated"></i><i class="icon-remove error"></i><i class="icon-ok success"></i>').addClass("settings-saved-trigger"):t.addClass("settings-saved-trigger-input")},update:function(e,t){var n=h.unwrap(t()),o=d()(e);if("custom"===o.data("save-trigger-type"))switch(n.toString()){case"1":o.find(".animated,.error").hide().removeClass("visible").end().find(".success").show().addClass("visible");break;case"0":o.find(".animated,.success").hide().removeClass("visible").end().find(".error").show().addClass("visible");break;case"-2":o.find(".error,.success").hide().removeClass("visible").end().find(".animated").show().addClass("visible");break;default:o.find(".animated").hide().end().find(".error,.success").removeClass("visible")}else switch(n.toString()){case"1":o.addClass("success").removeClass("error");break;case"0":o.addClass("error").removeClass("success");break;case"-2":break;default:o.removeClass("error success")}}},h.bindingHandlers.emailsTags={init:function(e,t,n){var o=l(2),i=l(45).default,a=d()(e),r=t(),s=n().autoCompleteSource||null,c=[",",";","\n"];a.inputosaurus({parseOnBlur:!0,allowDragAndDrop:!0,focusCallback:function(e){r&&r.focused&&r.focused(!!e)},inputDelimiters:c,autoCompleteSource:s,splitHook:function(e){var t=o.trim(e);return t&&-1<c.indexOf(t.substr(-1))?i.splitEmailLine(e):null},parseHook:function(e){return u.a.map(u.a.flatten(u.a.map(e,function(e){var t=i.parseEmailLine(e);return t.length?t:e})),function(e){return u.a.isObject(e)?[e.toLine(!1),e]:[e,null]})},change:function(e){a.data("EmailsTagsValue",e.target.value),r(e.target.value)}}),r&&r.focused&&r.focused.subscribe&&r.focused.subscribe(function(e){a.inputosaurus(e?"focus":"blur")})},update:function(e,t){var n=d()(e),o=t(),i=h.unwrap(o);n.data("EmailsTagsValue")!==i&&(n.val(i),n.data("EmailsTagsValue",i),n.inputosaurus("refresh"))}},h.bindingHandlers.command={init:function(e,t,n,o,i){var a=d()(e),r=t();if(!r||!r.isCommand)throw new Error("Value should be a command");if(r.enabled||(r.enabled=h.observable(!0)),!r.canExecute){var s=r.__realCanExecute;u.a.isFunction(s)?r.canExecute=h.computed(function(){return r.enabled()&&s.call(o,o)}):r.canExecute=h.computed(function(){return r.enabled()&&!!s})}a.addClass("command"),h.bindingHandlers[a.is("form")?"submit":"click"].init(e,t,n,o,i)},update:function(e,t){var n=d()(e),o=t(),i=o.enabled();n.toggleClass("command-not-enabled",!i),i&&(i=o.canExecute(),n.toggleClass("command-can-not-be-execute",!i)),n.toggleClass("command-disabled disable disabled",!i).toggleClass("no-disabled",!!i),(n.is("input")||n.is("button"))&&n.prop("disabled",!i)}},h.extenders.trimmer=function(t){var n=l(2),e=h.computed({read:t,write:function(e){t(n.trim(e.toString()))}});return e(t()),e},h.extenders.posInterer=function(n,o){var i=l(2),e=h.computed({read:n,write:function(e){var t=i.pInt(e.toString(),o);t<=0&&(t=o),t===n()&&""+t!=""+e&&n(t+1),n(t)}});return e(n()),e},h.extenders.limitedList=function(o,i){var a=l(2),e=h.computed({read:o,write:function(e){var t=h.unwrap(o),n=h.unwrap(i);a.isNonEmptyArray(n)?-1<a.inArray(e,n)?o(e):-1<a.inArray(t,n)?(o(t+" "),o(t)):(o(n[0]+" "),o(n[0])):o("")}}).extend({notify:"always"});return e(o()),e.valueHasMutated||(e.valueHasMutated=function(){o.valueHasMutated()}),e},h.extenders.reversible=function(e){var t=e();return e.commit=function(){t=e()},e.reverse=function(){e(t)},e.commitedValue=function(){return t},e},h.extenders.toggleSubscribe=function(e,t){return e.subscribe(t[1],t[0],"beforeChange"),e.subscribe(t[2],t[0]),e},h.extenders.toggleSubscribeProperty=function(e,t){var n=t[1];return n&&(e.subscribe(function(e){e&&e[n]&&e[n](!1)},t[0],"beforeChange"),e.subscribe(function(e){e&&e[n]&&e[n](!0)},t[0])),e},h.extenders.falseTimeout=function(t,n){return t.iFalseTimeoutTimeout=0,t.subscribe(function(e){e&&(c.a.clearTimeout(t.iFalseTimeoutTimeout),t.iFalseTimeoutTimeout=c.a.setTimeout(function(){t(!1),t.iFalseTimeoutTimeout=0},l(2).pInt(n)))}),t},h.extenders.specialThrottle=function(t,e){return t.iSpecialThrottleTimeoutValue=l(2).pInt(e),0<t.iSpecialThrottleTimeoutValue?(t.iSpecialThrottleTimeout=0,t.valueForRead=h.observable(!!t()).extend({throttle:10}),h.computed({read:t.valueForRead,write:function(e){e?t.valueForRead(e):t.valueForRead()?(c.a.clearTimeout(t.iSpecialThrottleTimeout),t.iSpecialThrottleTimeout=c.a.setTimeout(function(){t.valueForRead(!1),t.iSpecialThrottleTimeout=0},t.iSpecialThrottleTimeoutValue)):t.valueForRead(e)}})):t},h.extenders.idleTrigger=function(e){return e.trigger=h.observable(s.SaveSettingsStep.Idle),e},h.observable.fn.idleTrigger=function(){return this.extend({idleTrigger:!0})},h.observable.fn.validateNone=function(){return this.hasError=h.observable(!1),this},h.observable.fn.validateEmail=function(){var t=this;return this.hasError=h.observable(!1),this.subscribe(function(e){t.hasError(""!==e&&!/^[^@\s]+@[^@\s]+$/.test(e))}),this.valueHasMutated(),this},h.observable.fn.validateSimpleEmail=function(){var t=this;return this.hasError=h.observable(!1),this.subscribe(function(e){t.hasError(""!==e&&!/^.+@.+$/.test(e))}),this.valueHasMutated(),this},h.observable.fn.deleteAccessHelper=function(){return this.extend({falseTimeout:3e3}).extend({toggleSubscribeProperty:[this,"deleteAccess"]}),this},h.observable.fn.validateFunc=function(t){var n=this;return this.hasFuncError=h.observable(!1),u.a.isFunction(t)&&(this.subscribe(function(e){n.hasFuncError(!t(e))}),this.valueHasMutated()),this},t.a=h},function(e,t,y){"use strict";y.r(t);var n=y(3),v=y.n(n),o=y(7),r=y.n(o),i=y(4),l=y.n(i),s=y(1),a=y(97),c=y.n(a),u=y(6),m=y(0),d={eml:"message/rfc822",mime:"message/rfc822",txt:"text/plain",text:"text/plain",def:"text/plain",list:"text/plain",in:"text/plain",ini:"text/plain",log:"text/plain",sql:"text/plain",cfg:"text/plain",conf:"text/plain",asc:"text/plain",rtx:"text/richtext",vcard:"text/vcard",vcf:"text/vcard",htm:"text/html",html:"text/html",csv:"text/csv",ics:"text/calendar",ifb:"text/calendar",xml:"text/xml",json:"application/json",swf:"application/x-shockwave-flash",hlp:"application/winhlp",wgt:"application/widget",chm:"application/vnd.ms-htmlhelp",p10:"application/pkcs10",p7c:"application/pkcs7-mime",p7m:"application/pkcs7-mime",p7s:"application/pkcs7-signature",torrent:"application/x-bittorrent",js:"application/javascript",pl:"text/perl",css:"text/css",asp:"text/asp",php:"application/x-httpd-php",php3:"application/x-httpd-php",php4:"application/x-httpd-php",php5:"application/x-httpd-php",phtml:"application/x-httpd-php",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",gif:"image/gif",bmp:"image/bmp",cgm:"image/cgm",ief:"image/ief",ico:"image/x-icon",tif:"image/tiff",tiff:"image/tiff",svg:"image/svg+xml",svgz:"image/svg+xml",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",webp:"image/webp",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",exe:"application/x-msdownload",dll:"application/x-msdownload",scr:"application/x-msdownload",com:"application/x-msdownload",bat:"application/x-msdownload",msi:"application/x-msdownload",cab:"application/vnd.ms-cab-compressed",gz:"application/x-gzip",tgz:"application/x-gzip",bz:"application/x-bzip",bz2:"application/x-bzip2",deb:"application/x-debian-package",psf:"application/x-font-linux-psf",otf:"application/x-font-otf",pcf:"application/x-font-pcf",snf:"application/x-font-snf",ttf:"application/x-font-ttf",ttc:"application/x-font-ttf",mp3:"audio/mpeg",amr:"audio/amr",aac:"audio/x-aac",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",wav:"audio/x-wav",wma:"audio/x-ms-wma",wax:"audio/x-ms-wax",midi:"audio/midi",mp4a:"audio/mp4",ogg:"audio/ogg",weba:"audio/webm",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",rmp:"audio/x-pn-realaudio-plugin",m3u:"audio/x-mpegurl",flv:"video/x-flv",qt:"video/quicktime",mov:"video/quicktime",wmv:"video/windows-media",avi:"video/x-msvideo",mpg:"video/mpeg",mpeg:"video/mpeg",mpe:"video/mpeg",m1v:"video/mpeg",m2v:"video/mpeg","3gp":"video/3gpp","3g2":"video/3gpp2",h261:"video/h261",h263:"video/h263",h264:"video/h264",jpgv:"video/jpgv",mp4:"video/mp4",mp4v:"video/mp4",mpg4:"video/mp4",ogv:"video/ogg",webm:"video/webm",m4v:"video/x-m4v",asf:"video/x-ms-asf",asx:"video/x-ms-asf",wm:"video/x-ms-wm",wmx:"video/x-ms-wmx",wvx:"video/x-ms-wvx",movie:"video/x-sgi-movie",pdf:"application/pdf",psd:"image/vnd.adobe.photoshop",ai:"application/postscript",eps:"application/postscript",ps:"application/postscript",doc:"application/msword",dot:"application/msword",rtf:"application/rtf",xls:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",odt:"application/vnd.oasis.opendocument.text",ods:"application/vnd.oasis.opendocument.spreadsheet"},p=y(59);y.d(t,"trim",function(){return h}),y.d(t,"inArray",function(){return b}),y.d(t,"isArray",function(){return g}),y.d(t,"isObject",function(){return f}),y.d(t,"isFunc",function(){return S}),y.d(t,"isUnd",function(){return O}),y.d(t,"isNull",function(){return w}),y.d(t,"has",function(){return T}),y.d(t,"bind",function(){return C}),y.d(t,"noop",function(){return A}),y.d(t,"noopTrue",function(){return E}),y.d(t,"noopFalse",function(){return F}),y.d(t,"silentTryCatch",function(){return j}),y.d(t,"isNormal",function(){return N}),y.d(t,"isPosNumeric",function(){return R}),y.d(t,"pInt",function(){return I}),y.d(t,"pString",function(){return L}),y.d(t,"pBool",function(){return _}),y.d(t,"boolToAjax",function(){return P}),y.d(t,"isNonEmptyArray",function(){return M}),y.d(t,"encodeURIComponent",function(){return D}),y.d(t,"decodeURIComponent",function(){return k}),y.d(t,"decodeURI",function(){return x}),y.d(t,"encodeURI",function(){return U}),y.d(t,"simpleQueryParser",function(){return H}),y.d(t,"fakeMd5",function(){return B}),y.d(t,"encodeHtml",function(){return G}),y.d(t,"splitPlainText",function(){return K}),y.d(t,"timeOutAction",function(){return q}),y.d(t,"timeOutActionSecond",function(){return W}),y.d(t,"inFocus",function(){return Y}),y.d(t,"removeInFocus",function(){return $}),y.d(t,"removeSelection",function(){return J}),y.d(t,"replySubjectAdd",function(){return X}),y.d(t,"roundNumber",function(){return Z}),y.d(t,"friendlySize",function(){return Q}),y.d(t,"log",function(){return ee}),y.d(t,"delegateRun",function(){return te}),y.d(t,"killCtrlACtrlS",function(){return ne}),y.d(t,"createCommandLegacy",function(){return oe}),y.d(t,"convertThemeName",function(){return ie}),y.d(t,"quoteName",function(){return ae}),y.d(t,"microtime",function(){return re}),y.d(t,"timestamp",function(){return se}),y.d(t,"convertLangName",function(){return ce}),y.d(t,"draggablePlace",function(){return le}),y.d(t,"defautOptionsAfterRender",function(){return ue}),y.d(t,"clearBqSwitcher",function(){return de}),y.d(t,"previewMessage",function(){return pe}),y.d(t,"settingsSaveHelperFunction",function(){return he}),y.d(t,"settingsSaveHelperSimpleFunction",function(){return fe}),y.d(t,"settingsSaveHelperSubscribeFunction",function(){return me}),y.d(t,"findEmailAndLinks",function(){return be}),y.d(t,"htmlToPlain",function(){return ge}),y.d(t,"plainToHtml",function(){return ye}),y.d(t,"folderListOptionsBuilder",function(){return ve}),y.d(t,"selectElement",function(){return Se}),y.d(t,"detectDropdownVisibility",function(){return Oe}),y.d(t,"triggerAutocompleteInputChange",function(){return we}),y.d(t,"getConfigurationFromScriptTag",function(){return Ce}),y.d(t,"disposeOne",function(){return Ae}),y.d(t,"disposeObject",function(){return Ee}),y.d(t,"delegateRunOnDestroy",function(){return Fe}),y.d(t,"appendStyles",function(){return je}),y.d(t,"changeTheme",function(){return Ie}),y.d(t,"computedPagenatorHelper",function(){return Le}),y.d(t,"getFileExtension",function(){return _e}),y.d(t,"mimeContentType",function(){return Pe}),y.d(t,"isTransparent",function(){return Me}),y.d(t,"getRealHeight",function(){return De}),y.d(t,"resizeAndCrop",function(){return ke}),y.d(t,"mailToHelper",function(){return xe}),y.d(t,"domReady",function(){return Ue}),y.d(t,"windowResize",function(){return He}),y.d(t,"windowResizeCallback",function(){return Be}),y.d(t,"jassl",function(){return p.a});var h=r.a.trim,b=r.a.inArray,g=l.a.isArray,f=l.a.isObject,S=l.a.isFunction,O=l.a.isUndefined,w=l.a.isNull,T=l.a.has,C=l.a.bind,A=function(){},E=function(){return!0},F=function(){return!1};function j(e){try{e()}catch(e){}}function N(e){return!O(e)&&!w(e)}function R(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return!!N(e)&&(t?/^[0-9]*$/.test(e.toString()):/^[1-9]+[0-9]*$/.test(e.toString()))}function I(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=N(e)&&""!==e?v.a.parseInt(e,10):t;return v.a.isNaN(n)?t:n}function L(e){return N(e)?""+e:""}function _(e){return!!e}function P(e){return e?"1":"0"}function M(e){return g(e)&&0<e.length}function D(e){return v.a.encodeURIComponent(e)}function k(e){return v.a.decodeURIComponent(e)}function x(e){return v.a.decodeURI(e)}function U(e){return v.a.encodeURI(e)}function H(e){var t,n=0,o=null,i=e.split("&"),a={};for(t=i.length;n<t;n++)a[k((o=i[n].split("="))[0])]=k(o[1]);return a}function B(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:32,t="0123456789abcdefghijklmnopqrstuvwxyz",n=t.length;e=I(e);for(var o="";o.length<e;)o+=t.substr(v.a.Math.round(v.a.Math.random()*n),1);return o}function G(e){return N(e)?l.a.escape(e.toString()):""}function K(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,n="",o="",i=e,a=0,r=0;i.length>t;)a=(o=i.substring(0,t)).lastIndexOf(" "),-1!==(r=o.lastIndexOf("\n"))&&(a=r),-1===a&&(a=t),n+=o.substring(0,a)+"\n",i=i.substring(a+1);return n+i}var V,z,q=(z={},function(e,t,n){z[e]=O(z[e])?0:z[e],v.a.clearTimeout(z[e]),z[e]=v.a.setTimeout(t,n)}),W=(V={},function(e,t,n){V[e]||(V[e]=v.a.setTimeout(function(){t(),V[e]=0},n))});function Y(){try{if(v.a.document.activeElement)return O(v.a.document.activeElement.__inFocusCache)&&(v.a.document.activeElement.__inFocusCache=r()(v.a.document.activeElement).is("input,textarea,iframe,.cke_editable")),!!v.a.document.activeElement.__inFocusCache}catch(e){}return!1}function $(e){if(v.a.document&&v.a.document.activeElement&&v.a.document.activeElement.blur)try{var t=r()(v.a.document.activeElement);t&&t.is("input,textarea")?v.a.document.activeElement.blur():e&&v.a.document.activeElement.blur()}catch(e){}}function J(){try{if(v.a&&v.a.getSelection){var e=v.a.getSelection();e&&e.removeAllRanges&&e.removeAllRanges()}else v.a.document&&v.a.document.selection&&v.a.document.selection.empty&&v.a.document.selection.empty()}catch(e){}}function X(e,t){e=h(e.toUpperCase()),t=h(t.replace(/[\s]+/g," "));var n=!1,o="RE"===e,i="FWD"===e,a=[],r=!i;return""!==t&&l.a.each(t.split(":"),function(e){var t=h(e);n||!/^(RE|FWD)$/i.test(t)&&!/^(RE|FWD)[\[\(][\d]+[\]\)]$/i.test(t)?(a.push(e),n=!0):(o||(o=!!/^RE/i.test(t)),i||(i=!!/^FWD/i.test(t)))}),r?o=!1:i=!1,h((r?"Re: ":"Fwd: ")+(o?"Re: ":"")+(i?"Fwd: ":"")+h(a.join(":")))}function Z(e,t){return v.a.Math.round(e*v.a.Math.pow(10,t))/v.a.Math.pow(10,t)}function Q(e){switch(e=I(e),!0){case 1073741824<=e:return Z(e/1073741824,1)+"GB";case 1048576<=e:return Z(e/1048576,1)+"MB";case 1024<=e:return Z(e/1024,0)+"KB"}return e+"B"}function ee(e){v.a.console&&v.a.console.log&&v.a.console.log(e)}function te(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;e&&e[t]&&(o=I(o),n=g(n)?n:[],o<=0?e[t].apply(e,n):l.a.delay(function(){e[t].apply(e,n)},o))}function ne(e){if((e=e||v.a.event)&&e.ctrlKey&&!e.shiftKey&&!e.altKey){var t=e.keyCode||e.which;if(t===m.EventKeyCode.S)return void e.preventDefault();if(t===m.EventKeyCode.A){var n=e.target||e.srcElement;if(n&&("true"==""+n.contentEditable||n.tagName&&n.tagName.match(/INPUT|TEXTAREA/i)))return;v.a.getSelection?v.a.getSelection().removeAllRanges():v.a.document.selection&&v.a.document.selection.clear&&v.a.document.selection.clear(),e.preventDefault()}}}function oe(o,i){var e=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=null;return(a=i?function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a&&a.canExecute&&a.canExecute()&&i.apply(o,t),!1}:A).enabled=s.a.observable(!0),a.isCommand=!0,S(e)?a.canExecute=s.a.computed(function(){return a&&a.enabled()&&e.call(o)}):a.canExecute=s.a.computed(function(){return a&&a.enabled()&&!!e}),a}var ie=l.a.memoize(function(e){return"@custom"===e.substr(-7)&&(e=h(e.substring(0,e.length-7))),h(e.replace(/[^a-zA-Z0-9]+/g," ").replace(/([A-Z])/g," $1").replace(/[\s]+/g," "))});function ae(e){return e.replace(/["]/g,'\\"')}function re(){return(new v.a.Date).getTime()}function se(){return v.a.Math.round(re()/1e3)}function ce(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return y(10).i18n("LANGS_NAMES"+(!0===t?"_EN":"")+"/LANG_"+e.toUpperCase().replace(/[^a-zA-Z0-9]+/g,"_"),null,e)}function le(){return r()('<div class="draggablePlace"><span class="text"></span>&nbsp;<i class="icon-copy icon-white visible-on-ctrl"></i><i class="icon-mail icon-white hidden-on-ctrl"></i></div>').appendTo("#rl-hidden")}function ue(e,t){t&&!O(t.disabled)&&e&&r()(e).toggleClass("disabled",t.disabled).prop("disabled",t.disabled)}function de(e){e.find("blockquote.rl-bq-switcher").removeClass("rl-bq-switcher hidden-bq"),e.find(".rlBlockquoteSwitcher").off(".rlBlockquoteSwitcher").remove(),e.find("[data-html-editor-font-wrapper]").removeAttr("data-html-editor-font-wrapper")}function pe(e,t,n,o){var i=e.title,a=e.subject,r=e.date,s=e.fromCreds,c=e.toCreds,l=e.toLabel,u=e.ccClass,d=e.ccCreds,p=e.ccLabel,h=v.a.open(""),f=h.document,m=t.clone(),b=n?"html":"plain";de(m);var g=m?m.html():"";f.write(y(122).replace("{{title}}",G(i)).replace("{{subject}}",G(a)).replace("{{date}}",G(r)).replace("{{fromCreds}}",G(s)).replace("{{toCreds}}",G(c)).replace("{{toLabel}}",G(l)).replace("{{ccClass}}",G(u)).replace("{{ccCreds}}",G(d)).replace("{{ccLabel}}",G(p)).replace("{{bodyClass}}",b).replace("{{html}}",g)),f.close(),o&&v.a.setTimeout(function(){return h.print()},100)}function he(a,r){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e3;return c=I(c),function(e,t,n,o,i){r.call(s,t&&t.Result?m.SaveSettingsStep.TrueResult:m.SaveSettingsStep.FalseResult),a&&a.call(s,e,t,n,o,i),l.a.delay(function(){r.call(s,m.SaveSettingsStep.Idle)},c)}}function fe(e,t){return he(null,e,t,1e3)}function me(n,o,i,a){return function(e){if(n){switch(i){case"bool":case"boolean":e=e?"1":"0";break;case"int":case"integer":case"number":e=I(e);break;case"trim":e=h(e);break;default:e=L(e)}var t={};t[o]=e,n.saveAdminConfig?n.saveAdminConfig(a||null,t):n.saveSettings&&n.saveSettings(a||null,t)}}}function be(e){return c.a?c.a.link(e,{newWindow:!0,stripPrefix:!1,urls:!0,email:!0,mention:!1,phone:!1,hashtag:!1,replaceFn:function(e){return!(e&&"url"===e.getType()&&e.matchedText&&0!==e.matchedText.indexOf("http"))}}):e}function ge(e){var t,n=0,o=0,i=0,a=0,r=0,s="";for(s=e.replace(/<p[^>]*><\/p>/gi,"").replace(/<pre[^>]*>([\s\S\r\n\t]*)<\/pre>/gim,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t&&1<t.length?t[1].toString().replace(/[\n]/gm,"<br />").replace(/[\r]/gm,""):""}).replace(/[\s]+/gm," ").replace(/((?:href|data)\s?=\s?)("[^"]+?"|'[^']+?')/gim,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t&&1<t.length?""+t[1]+l.a.escape(t[2]):""}).replace(/<br[^>]*>/gim,"\n").replace(/<\/h[\d]>/gi,"\n").replace(/<\/p>/gi,"\n\n").replace(/<ul[^>]*>/gim,"\n").replace(/<\/ul>/gi,"\n").replace(/<li[^>]*>/gim," * ").replace(/<\/li>/gi,"\n").replace(/<\/td>/gi,"\n").replace(/<\/tr>/gi,"\n").replace(/<hr[^>]*>/gim,"\n_______________________________\n\n").replace(/<div[^>]*>([\s\S\r\n]*)<\/div>/gim,function e(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];if(n&&1<n.length){var i=h(n[1]);return 0<i.length&&(i=i.replace(/<div[^>]*>([\s\S\r\n]*)<\/div>/gim,e),i="\n"+h(i)+"\n"),i}return""}).replace(/<blockquote[^>]*>/gim,"\n__bq__start__\n").replace(/<\/blockquote>/gim,"\n__bq__end__\n").replace(/<a [^>]*>([\s\S\r\n]*?)<\/a>/gim,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t&&1<t.length?h(t[1]):""}).replace(/<\/div>/gi,"\n").replace(/&nbsp;/gi," ").replace(/&quot;/gi,'"').replace(/<[^>]*>/gm,""),s=K(s=(s=u.$div.html(s).text()).replace(/\n[ \t]+/gm,"\n").replace(/[\n]{3,}/gm,"\n\n").replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&")),n=0,o=800;0<o&&(o-=1,-1<(i=s.indexOf("__bq__start__",n)));)a=s.indexOf("__bq__start__",i+5),r=s.indexOf("__bq__end__",i+5),(-1===a||r<a)&&i<r?(s=s.substring(0,i)+(t=s.substring(i+13,r),(t="> "+h(t).replace(/\n/gm,"\n> ")).replace(/(^|\n)([> ]+)/gm,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t&&2<t.length?t[1]+h(t[2].replace(/[\s]/g,""))+" ":""}))+s.substring(r+11),n=0):n=-1<a&&a<r?a-1:0;return s.replace(/__bq__start__/gm,"").replace(/__bq__end__/gm,"")}function ye(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=!1,o=!0,i=!0,a=[],r="",s=0,c=(e=(e=e.toString().replace(/\r/g,"")).replace(/^>[> ]>+/gm,function(e){var t=e[0];return t?t.replace(/[ ]+/g,""):t})).split("\n");do{for(o=!1,a=[],s=0;s<c.length;s++)(i=">"===(r=c[s]).substr(0,1))&&!n?(n=o=!0,a.push("~~~blockquote~~~"),a.push(r.substr(1))):!i&&n?(""!==r&&(n=!1,a.push("~~~/blockquote~~~")),a.push(r)):i&&n?a.push(r.substr(1)):a.push(r);n&&(n=!1,a.push("~~~/blockquote~~~")),c=a}while(o);return e=(e=c.join("\n")).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/~~~blockquote~~~[\s]*/g,"<blockquote>").replace(/[\s]*~~~\/blockquote~~~/g,"</blockquote>").replace(/\n/g,"<br />"),t?be(e):e}function ve(e,t,n,o,i,a,r,s,c,l){var u=null,d=!1,p=0,h=0,f=[];for(l=!O(l)&&!!l,c=N(c)?c:0<e.length,i=N(i)?i:0,a=N(a)?a:null,r=N(r)?r:null,s=N(s)?s:null,g(n)||(n=[]),g(o)||(o=[]),p=0,h=o.length;p<h;p++)f.push({id:o[p][0],name:o[p][1],system:!1,seporator:!1,disabled:!1});for(d=!0,p=0,h=e.length;p<h;p++)u=e[p],r&&!r(u)||(d&&0<f.length&&f.push({id:"---",name:"---",system:!1,seporator:!0,disabled:!0}),d=!1,f.push({id:u.fullNameRaw,name:s?s(u):u.name(),system:!0,seporator:!1,disabled:!u.selectable||-1<b(u.fullNameRaw,n)||!!a&&a(u)}));for(d=!0,p=0,h=t.length;p<h;p++)!(u=t[p]).subScribed()&&u.existen&&!l||!u.selectable&&!u.hasSubScribedSubfolders()||r&&!r(u)||m.FolderType.User!==u.type()&&c&&!u.hasSubScribedSubfolders()||(d&&0<f.length&&f.push({id:"---",name:"---",system:!1,seporator:!0,disabled:!0}),d=!1,f.push({id:u.fullNameRaw,name:new v.a.Array(u.deep+1-i).join("   ")+(s?s(u):u.name()),system:!1,seporator:!1,disabled:!u.selectable||-1<b(u.fullNameRaw,n)||!!a&&a(u)})),u.subScribed()&&0<u.subFolders().length&&(f=f.concat(ve([],u.subFolders(),n,[],i,a,r,s,c,l)));return f}function Se(e){var t=null,n=null;v.a.getSelection?((t=v.a.getSelection()).removeAllRanges(),(n=v.a.document.createRange()).selectNodeContents(e),t.addRange(n)):v.a.document.selection&&((n=v.a.document.body.createTextRange()).moveToElementText(e),n.select())}v.a.rainloop_Utils_htmlToPlain=ge,v.a.rainloop_Utils_plainToHtml=ye;var Oe=l.a.debounce(function(){Object(u.dropdownVisibility)(!!l.a.find(u.data.aBootstrapDropdowns,function(e){return e.hasClass("open")}))},50);function we(){var e=function(){r()(".checkAutocomplete").trigger("change")};0<arguments.length&&void 0!==arguments[0]&&arguments[0]?l.a.delay(e,100):e()}var Te={};function Ce(e){Te[e]||(Te[e]=r()('script[type="application/json"][data-configuration="'+e+'"]'));try{return JSON.parse(Te[e].text())}catch(e){}return{}}function Ae(e,t){var n=t||e;n&&"function"==typeof n.dispose&&n.dispose()}function Ee(e){e&&(g(e.disposables)&&l.a.each(e.disposables,Ae),s.a.utils.objectForEach(e,Ae))}function Fe(e){e&&(g(e)?l.a.each(e,function(e){Fe(e)}):e&&e.onDestroy&&e.onDestroy())}function je(e,t){return!(!e||!e[0]||(e[0].styleSheet&&!O(e[0].styleSheet.cssText)?e[0].styleSheet.cssText=t:e.text(t),0))}var Ne=0,Re=null;function Ie(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:A,n=r()("#app-theme-link"),o=function(){Ne=v.a.setTimeout(function(){return t(m.SaveSettingsStep.Idle)},1e3),Re=null},i=r()("#app-theme-style"),a=n.attr("href");a||(a=i.attr("data-href")),a&&("Json/"!==(a=(a=(a=a.toString().replace(/\/-\/[^\/]+\/\-\//,"/-/"+e+"/-/")).replace(/\/Css\/[^\/]+\/User\//,"/Css/0/User/")).replace(/\/Hash\/[^\/]+\//,"/Hash/-/")).substring(a.length-5,a.length)&&(a+="Json/"),v.a.clearTimeout(Ne),t(m.SaveSettingsStep.Animate),Re&&Re.abort&&Re.abort(),Re=r.a.ajax({url:a,dataType:"json"}).then(function(e){e&&g(e)&&2===e.length&&(!n||!n[0]||i&&i[0]||(i=r()('<style id="app-theme-style"></style>'),n.after(i),n.remove()),i&&i[0]&&je(i,e[1])&&i.attr("data-href",a).attr("data-theme",e[0]),t(m.SaveSettingsStep.TrueResult))}).then(o,o))}function Le(s,c){return function(){var i=s(),e=c(),a=[],t=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o={current:e===i,name:""===n?e.toString():n.toString(),custom:""!==n,title:""===n?"":e.toString(),value:e.toString()};t?a.push(o):a.unshift(o)},n=0,o=0,r=2;if(1<e||0<e&&e<i){for(e<i?(t(e),o=n=e):((i<=3||e-2<=i)&&(r+=2),t(i),o=n=i);0<r;)if(o+=1,0<(n-=1)&&(t(n,!1),r-=1),o<=e)t(o,!0),r-=1;else if(n<=0)break;3===n?t(2,!1):3<n&&t(Math.round((n-1)/2),!1,"..."),e-2===o?t(e-1,!0):o<e-2&&t(Math.round((e+o)/2),!0,"..."),1<n&&t(1,!1),o<e&&t(e,!0)}return a}}function _e(e){var t=(e=h(e).toLowerCase()).split(".").pop();return t===e?"":t}function Pe(e){var t,n="application/octet-stream";return"winmail.dat"===(e=h(e).toLowerCase())?"application/ms-tnef":((t=_e(e))&&0<t.length&&!O(d[t])&&(n=d[t]),n)}function Me(e){return"rgba(0, 0, 0, 0)"===e||"transparent"===e}function De(e){e.clone().show().appendTo(u.$hcont);var t=u.$hcont.height();return u.$hcont.empty(),t}function ke(e,o,i){var t=new v.a.Image;t.onload=function(){var e,t=v.a.document.createElement("canvas"),n=t.getContext("2d");t.width=o,t.height=o,e=this.width>this.height?[this.width-this.height,0]:[0,this.height-this.width],n.fillStyle="#fff",n.fillRect(0,0,o,o),n.drawImage(this,e[0]/2,e[1]/2,this.width-e[0],this.height-e[1],0,0,o,o),i(t.toDataURL("image/jpeg"))},t.src=e}function xe(e,t){if(e&&"mailto:"===e.toString().substr(0,7).toLowerCase()){if(!t)return!0;var n,o=[],i=null,a=null,r=(e=e.toString().substr(7)).replace(/\?.+$/,""),s=e.replace(/^[^\?]*\?/,""),c=y(45).default;return n=H(s),O(n.to)?o=c.parseEmailLine(r):(o=c.parseEmailLine(k(r+","+n.to)),o=l.a.values(o.reduce(function(e,t){return t&&(e[t.email]&&e[t.email].name||(e[t.email]=t)),e},{}))),O(n.cc)||(i=c.parseEmailLine(k(n.cc))),O(n.bcc)||(a=c.parseEmailLine(k(n.bcc))),y(9).showScreenPopup(t,[m.ComposeType.Empty,null,o,i,a,O(n.subject)?null:L(k(n.subject)),O(n.body)?null:ye(L(k(n.body)))]),!0}return!1}function Ue(e){r()(function(){return e()})}var He=l.a.debounce(function(e){O(e)||w(e)?u.$win.resize():v.a.setTimeout(function(){u.$win.resize()},e)},50);function Be(){He()}var Ge=v.a.String.substr;"b"!=="ab".substr(-1)&&(Ge=function(e,t,n){return t=t<0?e.length+t:t,e.substr(t,n)},v.a.String.substr=Ge)},function(e,t){e.exports=window},function(e,t){e.exports=window._},function(e,t,n){"use strict";n.r(t),n.d(t,"settingsGet",function(){return c}),n.d(t,"settingsSet",function(){return l}),n.d(t,"appSettingsGet",function(){return u}),n.d(t,"capa",function(){return d});var o=n(3),i=n.n(o),a=n(2),r=i.a.__rlah_data()||null,s=(r=Object(a.isNormal)(r)?r:{}).System||null;function c(e){return Object(a.isUnd)(r[e])?null:r[e]}function l(e,t){r[e]=t}function u(e){return Object(a.isUnd)(s[e])?null:s[e]}function d(e){var t=c("Capa");return Object(a.isArray)(t)&&Object(a.isNormal)(e)&&-1<Object(a.inArray)(e,t)}s=Object(a.isNormal)(s)?s:{}},function(e,t,n){"use strict";n.r(t),n.d(t,"$win",function(){return h}),n.d(t,"$doc",function(){return f}),n.d(t,"$html",function(){return m}),n.d(t,"$body",function(){return b}),n.d(t,"$div",function(){return g}),n.d(t,"$hcont",function(){return y}),n.d(t,"startMicrotime",function(){return v}),n.d(t,"community",function(){return S}),n.d(t,"dropdownVisibility",function(){return O}),n.d(t,"useKeyboardShortcuts",function(){return w}),n.d(t,"sUserAgent",function(){return T}),n.d(t,"bIE",function(){return C}),n.d(t,"bChrome",function(){return A}),n.d(t,"bSafari",function(){return E}),n.d(t,"bMobileDevice",function(){return F}),n.d(t,"bDisableNanoScroll",function(){return j}),n.d(t,"bAnimationSupported",function(){return N}),n.d(t,"bXMLHttpRequestSupported",function(){return R}),n.d(t,"bIsHttps",function(){return I}),n.d(t,"htmlEditorDefaultConfig",function(){return L}),n.d(t,"htmlEditorLangsMap",function(){return _}),n.d(t,"bAllowPdfPreview",function(){return P}),n.d(t,"VIEW_MODELS",function(){return M}),n.d(t,"moveAction",function(){return D}),n.d(t,"leftPanelDisabled",function(){return k}),n.d(t,"leftPanelType",function(){return x}),n.d(t,"leftPanelWidth",function(){return U}),n.d(t,"popupVisibilityNames",function(){return H}),n.d(t,"popupVisibility",function(){return B}),n.d(t,"keyScopeReal",function(){return G}),n.d(t,"keyScopeFake",function(){return K}),n.d(t,"keyScope",function(){return V}),n.d(t,"data",function(){return z});var o=n(3),i=n.n(o),a=n(4),r=n.n(a),s=n(7),c=n.n(s),l=n(19),u=n.n(l),d=n(1),p=n(0),h=c()(i.a);h.__sizes=[0,0];var f=c()(i.a.document),m=c()("html"),b=c()("body"),g=c()("<div></div>"),y=c()("<div></div>");y.attr("area","hidden").css({position:"absolute",left:-5e3}).appendTo(b);var v=(new i.a.Date).getTime(),S=!0,O=d.a.observable(!1).extend({rateLimit:0}),w=d.a.observable(!0),T="navigator"in i.a&&"userAgent"in i.a.navigator&&i.a.navigator.userAgent.toLowerCase()||"",C=-1<T.indexOf("msie"),A=-1<T.indexOf("chrome"),E=!A&&-1<T.indexOf("safari"),F=/android/i.test(T)||/iphone/i.test(T)||/ipod/i.test(T)||/ipad/i.test(T)||/blackberry/i.test(T),j=F,N=!F&&m.hasClass("csstransitions")&&m.hasClass("cssanimations"),R=!!i.a.XMLHttpRequest,I=!(!i.a.document||!i.a.document.location)&&"https:"===i.a.document.location.protocol,L={title:!1,stylesSet:!1,customConfig:"",contentsCss:"",toolbarGroups:[{name:"spec"},{name:"styles"},{name:"basicstyles",groups:["basicstyles","cleanup","bidi"]},{name:"colors"},F?{}:{name:"paragraph",groups:["list","indent","blocks","align"]},{name:"links"},{name:"insert"},{name:"document",groups:["mode","document","doctools"]},{name:"others"}],removePlugins:"liststyle",removeButtons:"Format,Undo,Redo,Cut,Copy,Paste,Anchor,Strike,Subscript,Superscript,Image,SelectAll,Source",removeDialogTabs:"link:advanced;link:target;image:advanced;images:advanced",extraPlugins:"plain,signature",allowedContent:!0,extraAllowedContent:!0,fillEmptyBlocks:!1,ignoreEmptyParagraph:!0,disableNativeSpellChecker:!1,colorButton_enableAutomatic:!1,colorButton_enableMore:!0,font_defaultLabel:"Arial",fontSize_defaultLabel:"13",fontSize_sizes:"10/10px;12/12px;13/13px;14/14px;16/16px;18/18px;20/20px;24/24px;28/28px;36/36px;48/48px"},_={ar_sa:"ar-sa",bg_bg:"bg",cs_CZ:"cs",de_de:"de",el_gr:"el",es_es:"es",et_ee:"et",fr_fr:"fr",hu_hu:"hu",is_is:"is",it_it:"it",ja_jp:"ja",ko_kr:"ko",lt_lt:"lt",lv_lv:"lv",fa_ir:"fa",nb_no:"nb",nl_nl:"nl",pl_pl:"pl",pt_br:"pt-br",pt_pt:"pt",ro_ro:"ro",ru_ru:"ru",sk_sk:"sk",sl_si:"sl",sv_se:"sv",tr_tr:"tr",uk_ua:"uk",zh_cn:"zh-cn",zh_tw:"zh"},P=!F;P&&i.a.navigator&&i.a.navigator.mimeTypes&&((P=!!r.a.find(i.a.navigator.mimeTypes,function(e){return e&&"application/pdf"===e.type}))||(P=void 0!==i.a.navigator.mimeTypes["application/pdf"]));var M={settings:[],"settings-removed":[],"settings-disabled":[]},D=d.a.observable(!1),k=d.a.observable(!1),x=d.a.observable(""),U=d.a.observable(0);k.subscribe(function(e){e&&D()&&D(!1)}),D.subscribe(function(e){e&&k()&&k(!1)});var H=d.a.observableArray([]),B=d.a.computed(function(){return 0<H().length});B.subscribe(function(e){m.toggleClass("rl-modal",e)});var G=d.a.observable(p.KeyState.All),K=d.a.observable(p.KeyState.All),V=d.a.computed({read:function(){return K()},write:function(e){p.KeyState.Menu!==e&&(p.KeyState.Compose===e?u.a.filter=function(){return w()}:u.a.filter=function(e){if(w()){var t=e.target||e.srcElement,n=t?t.tagName.toUpperCase():"";return!("INPUT"===n||"SELECT"===n||"TEXTAREA"===n||t&&"DIV"===n&&("editorHtmlArea"===t.className||"true"==""+t.contentEditable))}return!1},K(e),O()&&(e=p.KeyState.Menu)),G(e)}});G.subscribe(function(e){u.a.setScope(e)}),O.subscribe(function(e){e?V(p.KeyState.Menu):p.KeyState.Menu===u.a.getScope()&&V(K())});var z={__APP__:null,iAjaxErrorCount:0,iTokenErrorCount:0,aBootstrapDropdowns:[],iMessageBodyCacheCount:0,bUnload:!1}},function(e,t){e.exports=window.jQuery},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";n.r(t),n.d(t,"ViewType",function(){return v}),n.d(t,"hideLoading",function(){return S}),n.d(t,"createCommand",function(){return O}),n.d(t,"addSettingsViewModel",function(){return w}),n.d(t,"removeSettingsViewModel",function(){return T}),n.d(t,"disableSettingsViewModel",function(){return C}),n.d(t,"routeOff",function(){return A}),n.d(t,"routeOn",function(){return E}),n.d(t,"screen",function(){return F}),n.d(t,"getScreenPopup",function(){return j}),n.d(t,"hideScreenPopup",function(){return N}),n.d(t,"vmRunHook",function(){return R}),n.d(t,"buildViewModel",function(){return I}),n.d(t,"showScreenPopup",function(){return L}),n.d(t,"warmUpScreenPopup",function(){return _}),n.d(t,"isPopupVisible",function(){return P}),n.d(t,"screenOnRoute",function(){return M}),n.d(t,"startScreens",function(){return D}),n.d(t,"setHash",function(){return k}),n.d(t,"commandDecorator",function(){return H}),n.d(t,"command",function(){return H}),n.d(t,"viewDecorator",function(){return x}),n.d(t,"view",function(){return x}),n.d(t,"viewModel",function(){return x}),n.d(t,"popupDecorator",function(){return U}),n.d(t,"popup",function(){return U}),n.d(t,"settingsMenuKeysHendler",function(){return B});var o=n(4),r=n.n(o),i=n(7),s=n.n(i),c=n(1),a=n(35),l=n.n(a),u=n(75),d=n.n(u),p=n(0),h=n(29),f=n(6),m=n(2),b=null,g="",y={},v={Popup:"Popups",Left:"Left",Right:"Right",Center:"Center"};function S(){s()("#rl-content").addClass("rl-content-show"),s()("#rl-loading").hide().remove()}function O(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return Object(m.createCommandLegacy)(null,e,t)}function w(e,t,n,o){var i=4<arguments.length&&void 0!==arguments[4]&&arguments[4];e.__rlSettingsData={Label:n,Template:t,Route:o,IsDefault:!!i},f.VIEW_MODELS.settings.push(e)}function T(e){f.VIEW_MODELS["settings-removed"].push(e)}function C(e){f.VIEW_MODELS["settings-disabled"].push(e)}function A(){l.a.changed.active=!1}function E(){l.a.changed.active=!0}function F(e){return""===e||Object(m.isUnd)(y[e])?null:y[e]}function j(e){var t=null;return e&&((t=e).default&&(t=e.default)),t}function N(e){var t=j(e);t&&t.__vm&&t.__dom&&t.__vm.modalVisibility(!1)}function R(t,n){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;r.a.each(n.__names,function(e){Object(h.f)(t,[e,n.__vm,o])})}function I(t,e){if(t&&!t.__builded){var n=null,o=new t(e),i=t.__type||"",a=i?s()("#rl-content #rl-"+i.toLowerCase()):null;t.__builded=!0,(t.__vm=o).onShowTrigger=c.a.observable(!1),o.onHideTrigger=c.a.observable(!1),o.viewModelName=t.__name,o.viewModelNames=t.__names,o.viewModelTemplateID=t.__templateID,o.viewModelPosition=t.__type,a&&1===a.length?((n=s()("<div></div>").addClass("rl-view-model").addClass("RL-"+o.viewModelTemplateID).hide()).appendTo(a),o.viewModelDom=n,t.__dom=n,v.Popup===i&&(o.cancelCommand=o.closeCommand=O(function(){N(t)}),o.modalVisibility.subscribe(function(e){e?(o.viewModelDom.show(),o.storeAndSetKeyScope(),f.popupVisibilityNames.push(o.viewModelName),o.viewModelDom.css("z-index",3e3+Object(f.popupVisibilityNames)().length+10),o.onShowTrigger&&o.onShowTrigger(!o.onShowTrigger()),Object(m.delegateRun)(o,"onShowWithDelay",[],500)):(Object(m.delegateRun)(o,"onHide"),Object(m.delegateRun)(o,"onHideWithDelay",[],500),o.onHideTrigger&&o.onHideTrigger(!o.onHideTrigger()),o.restoreKeyScope(),R("view-model-on-hide",t),f.popupVisibilityNames.remove(o.viewModelName),o.viewModelDom.css("z-index",2e3),r.a.delay(function(){return o.viewModelDom.hide()},300))})),R("view-model-pre-build",t,n),c.a.applyBindingAccessorsToNode(n[0],{translatorInit:!0,template:function(){return{name:o.viewModelTemplateID}}},o),Object(m.delegateRun)(o,"onBuild",[n]),o&&v.Popup===i&&o.registerPopupKeyDown(),R("view-model-post-build",t,n)):Object(m.log)("Cannot find view model position: "+i)}return t?t.__vm:null}function L(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=j(e);n&&(I(n),n.__vm&&n.__dom&&(Object(m.delegateRun)(n.__vm,"onBeforeShow",t||[]),n.__vm.modalVisibility(!0),Object(m.delegateRun)(n.__vm,"onShow",t||[]),R("view-model-on-show",n,t||[])))}function _(e){var t=j(e);t&&(I(t),t.__vm&&t.__dom&&Object(m.delegateRun)(t.__vm,"onWarmUp"))}function P(e){var t=j(e);return!(!t||!t.__vm)&&t.__vm.modalVisibility()}function M(e,t){var n=null,o=!1,i=null;""===Object(m.pString)(e)&&(e=g),""!==e&&((n=F(e))||(n=F(g))&&(t=e+"/"+t,e=g),n&&n.__started&&(o=b&&n===b,n.__builded||(n.__builded=!0,Object(m.isNonEmptyArray)(n.viewModels())&&r.a.each(n.viewModels(),function(e){I(e,n)}),Object(m.delegateRun)(n,"onBuild")),r.a.defer(function(){b&&!o&&(Object(m.delegateRun)(b,"onHide"),Object(m.delegateRun)(b,"onHideWithDelay",[],500),b.onHideTrigger&&b.onHideTrigger(!b.onHideTrigger()),Object(m.isNonEmptyArray)(b.viewModels())&&r.a.each(b.viewModels(),function(e){e.__vm&&e.__dom&&v.Popup!==e.__vm.viewModelPosition&&(e.__dom.hide(),e.__vm.viewModelVisibility(!1),Object(m.delegateRun)(e.__vm,"onHide"),Object(m.delegateRun)(e.__vm,"onHideWithDelay",[],500),e.__vm.onHideTrigger&&e.__vm.onHideTrigger(!e.__vm.onHideTrigger()))})),(b=n)&&!o&&(Object(m.delegateRun)(b,"onShow"),b.onShowTrigger&&b.onShowTrigger(!b.onShowTrigger()),Object(h.f)("screen-on-show",[b.screenName(),b]),Object(m.isNonEmptyArray)(b.viewModels())&&r.a.each(b.viewModels(),function(e){e.__vm&&e.__dom&&v.Popup!==e.__vm.viewModelPosition&&(Object(m.delegateRun)(e.__vm,"onBeforeShow"),e.__dom.show(),e.__vm.viewModelVisibility(!0),Object(m.delegateRun)(e.__vm,"onShow"),e.__vm.onShowTrigger&&e.__vm.onShowTrigger(!e.__vm.onShowTrigger()),Object(m.delegateRun)(e.__vm,"onShowWithDelay",[],200),R("view-model-on-show",e))})),(i=n&&n.__cross?n.__cross():null)&&i.parse(t)})))}function D(e){r.a.each(e,function(e){if(e){var t=new e,n=t?t.screenName():"";t&&""!==n&&(""===g&&(g=n),y[n]=t)}}),r.a.each(y,function(e){e&&!e.__started&&e.__start&&(e.__started=!0,e.__start(),Object(h.f)("screen-pre-start",[e.screenName(),e]),Object(m.delegateRun)(e,"onStart"),Object(h.f)("screen-post-start",[e.screenName(),e]))});var t=d.a.create();t.addRoute(/^([a-zA-Z0-9\-]*)\/?(.*)$/,M),l.a.initialized.add(t.parse,t),l.a.changed.add(t.parse,t),l.a.init(),r.a.delay(function(){return f.$html.removeClass("rl-started-trigger").addClass("rl-started")},100),r.a.delay(function(){return f.$html.addClass("rl-started-delay")},200)}function k(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e="/"===(e="#"===e.substr(0,1)?e.substr(1):e).substr(0,1)?e.substr(1):e;var o=n?"replaceHash":"setHash";t?(l.a.changed.active=!1,l.a[o](e),l.a.changed.active=!0):(l.a.changed.active=!0,l.a[o](e),l.a.setHash(e))}function x(e){var t=e.name,n=e.type,o=e.templateID;return function(e){e&&(t&&(Object(m.isArray)(t)?e.__names=t:e.__names=[t],e.__name=e.__names[0]),n&&(e.__type=n),o&&(e.__templateID=o))}}function U(e){var t=e.name,n=e.templateID;return x({name:t,type:v.Popup,templateID:n})}function H(){var a=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return function(e,t,n){if(!t||!t.match(/Command$/))throw new Error('name "'+t+'" should end with Command suffix');var o=n.value||n.initializer(),i=Object(m.isFunc)(a)?a:function(){return!!a};return n.value=function(){if(i.call(this,this)){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.apply(this,t)}return!1},n.value.__realCanExecute=i,n.value.isCommand=!0,n}}function B(a){return r.a.throttle(function(e,t){var n=t&&"up"===t.shortcut;if(e&&a.length){var o=a.index(a.filter(".selected"));n&&0<o?o-=1:!n&&o<a.length-1&&(o+=1);var i=a.eq(o).attr("href");i&&k(i,!1,!0)}},p.Magics.Time200ms)}},function(e,t,n){"use strict";n.r(t),n.d(t,"trigger",function(){return y}),n.d(t,"i18n",function(){return v}),n.d(t,"i18nToNodes",function(){return O}),n.d(t,"initNotificationLanguage",function(){return T}),n.d(t,"initOnStartOrLangChange",function(){return C}),n.d(t,"getNotification",function(){return A}),n.d(t,"getNotificationFromResponse",function(){return E}),n.d(t,"getUploadErrorDescByCode",function(){return F}),n.d(t,"reload",function(){return j});var o=n(3),a=n.n(o),i=n(4),r=n.n(i),s=n(7),c=n.n(s),l=n(1),u=n(0),d=n(2),p=n(6),h=n(34),f=n(16),m=a.a.rainloopI18N||{},b={},g=[[u.Notification.InvalidToken,"NOTIFICATIONS/INVALID_TOKEN"],[u.Notification.InvalidToken,"NOTIFICATIONS/INVALID_TOKEN"],[u.Notification.AuthError,"NOTIFICATIONS/AUTH_ERROR"],[u.Notification.AccessError,"NOTIFICATIONS/ACCESS_ERROR"],[u.Notification.ConnectionError,"NOTIFICATIONS/CONNECTION_ERROR"],[u.Notification.CaptchaError,"NOTIFICATIONS/CAPTCHA_ERROR"],[u.Notification.SocialFacebookLoginAccessDisable,"NOTIFICATIONS/SOCIAL_FACEBOOK_LOGIN_ACCESS_DISABLE"],[u.Notification.SocialTwitterLoginAccessDisable,"NOTIFICATIONS/SOCIAL_TWITTER_LOGIN_ACCESS_DISABLE"],[u.Notification.SocialGoogleLoginAccessDisable,"NOTIFICATIONS/SOCIAL_GOOGLE_LOGIN_ACCESS_DISABLE"],[u.Notification.DomainNotAllowed,"NOTIFICATIONS/DOMAIN_NOT_ALLOWED"],[u.Notification.AccountNotAllowed,"NOTIFICATIONS/ACCOUNT_NOT_ALLOWED"],[u.Notification.AccountTwoFactorAuthRequired,"NOTIFICATIONS/ACCOUNT_TWO_FACTOR_AUTH_REQUIRED"],[u.Notification.AccountTwoFactorAuthError,"NOTIFICATIONS/ACCOUNT_TWO_FACTOR_AUTH_ERROR"],[u.Notification.CouldNotSaveNewPassword,"NOTIFICATIONS/COULD_NOT_SAVE_NEW_PASSWORD"],[u.Notification.CurrentPasswordIncorrect,"NOTIFICATIONS/CURRENT_PASSWORD_INCORRECT"],[u.Notification.NewPasswordShort,"NOTIFICATIONS/NEW_PASSWORD_SHORT"],[u.Notification.NewPasswordWeak,"NOTIFICATIONS/NEW_PASSWORD_WEAK"],[u.Notification.NewPasswordForbidden,"NOTIFICATIONS/NEW_PASSWORD_FORBIDDENT"],[u.Notification.ContactsSyncError,"NOTIFICATIONS/CONTACTS_SYNC_ERROR"],[u.Notification.CantGetMessageList,"NOTIFICATIONS/CANT_GET_MESSAGE_LIST"],[u.Notification.CantGetMessage,"NOTIFICATIONS/CANT_GET_MESSAGE"],[u.Notification.CantDeleteMessage,"NOTIFICATIONS/CANT_DELETE_MESSAGE"],[u.Notification.CantMoveMessage,"NOTIFICATIONS/CANT_MOVE_MESSAGE"],[u.Notification.CantCopyMessage,"NOTIFICATIONS/CANT_MOVE_MESSAGE"],[u.Notification.CantSaveMessage,"NOTIFICATIONS/CANT_SAVE_MESSAGE"],[u.Notification.CantSendMessage,"NOTIFICATIONS/CANT_SEND_MESSAGE"],[u.Notification.InvalidRecipients,"NOTIFICATIONS/INVALID_RECIPIENTS"],[u.Notification.CantSaveFilters,"NOTIFICATIONS/CANT_SAVE_FILTERS"],[u.Notification.CantGetFilters,"NOTIFICATIONS/CANT_GET_FILTERS"],[u.Notification.FiltersAreNotCorrect,"NOTIFICATIONS/FILTERS_ARE_NOT_CORRECT"],[u.Notification.CantCreateFolder,"NOTIFICATIONS/CANT_CREATE_FOLDER"],[u.Notification.CantRenameFolder,"NOTIFICATIONS/CANT_RENAME_FOLDER"],[u.Notification.CantDeleteFolder,"NOTIFICATIONS/CANT_DELETE_FOLDER"],[u.Notification.CantDeleteNonEmptyFolder,"NOTIFICATIONS/CANT_DELETE_NON_EMPTY_FOLDER"],[u.Notification.CantSubscribeFolder,"NOTIFICATIONS/CANT_SUBSCRIBE_FOLDER"],[u.Notification.CantUnsubscribeFolder,"NOTIFICATIONS/CANT_UNSUBSCRIBE_FOLDER"],[u.Notification.CantSaveSettings,"NOTIFICATIONS/CANT_SAVE_SETTINGS"],[u.Notification.CantSavePluginSettings,"NOTIFICATIONS/CANT_SAVE_PLUGIN_SETTINGS"],[u.Notification.DomainAlreadyExists,"NOTIFICATIONS/DOMAIN_ALREADY_EXISTS"],[u.Notification.CantInstallPackage,"NOTIFICATIONS/CANT_INSTALL_PACKAGE"],[u.Notification.CantDeletePackage,"NOTIFICATIONS/CANT_DELETE_PACKAGE"],[u.Notification.InvalidPluginPackage,"NOTIFICATIONS/INVALID_PLUGIN_PACKAGE"],[u.Notification.UnsupportedPluginPackage,"NOTIFICATIONS/UNSUPPORTED_PLUGIN_PACKAGE"],[u.Notification.LicensingServerIsUnavailable,"NOTIFICATIONS/LICENSING_SERVER_IS_UNAVAILABLE"],[u.Notification.LicensingExpired,"NOTIFICATIONS/LICENSING_EXPIRED"],[u.Notification.LicensingBanned,"NOTIFICATIONS/LICENSING_BANNED"],[u.Notification.DemoSendMessageError,"NOTIFICATIONS/DEMO_SEND_MESSAGE_ERROR"],[u.Notification.DemoAccountError,"NOTIFICATIONS/DEMO_ACCOUNT_ERROR"],[u.Notification.AccountAlreadyExists,"NOTIFICATIONS/ACCOUNT_ALREADY_EXISTS"],[u.Notification.AccountDoesNotExist,"NOTIFICATIONS/ACCOUNT_DOES_NOT_EXIST"],[u.Notification.MailServerError,"NOTIFICATIONS/MAIL_SERVER_ERROR"],[u.Notification.InvalidInputArgument,"NOTIFICATIONS/INVALID_INPUT_ARGUMENT"],[u.Notification.UnknownNotification,"NOTIFICATIONS/UNKNOWN_ERROR"],[u.Notification.UnknownError,"NOTIFICATIONS/UNKNOWN_ERROR"]],y=l.a.observable(!1);function v(e,t,n){var o="",i=m[e];if(Object(d.isUnd)(i)&&(i=Object(d.isUnd)(n)?e:n),!Object(d.isUnd)(t)&&!Object(d.isNull)(t))for(o in t)Object(d.has)(t,o)&&(i=i.replace("%"+o+"%",t[o]));return i}var S=function(e){var t=c()(e),n=t.data("i18n");if(n)if("["===n.substr(0,1))switch(n.substr(0,6)){case"[html]":t.html(v(n.substr(6)));break;case"[place":t.attr("placeholder",v(n.substr(13)));break;case"[title":t.attr("title",v(n.substr(7)))}else t.text(v(n))};function O(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];r.a.defer(function(){c()("[data-i18n]",e).each(function(e,t){S(t)}),t&&p.bAnimationSupported&&c()(".i18n-animation[data-i18n]",e).letterfx({fx:"fall fade",backwards:!1,timing:50,fx_duration:"50ms",letter_end:"restore",element_end:"restore"})})}var w=function(){a.a.rainloopI18N&&(m=a.a.rainloopI18N||{},O(a.a.document,!0),Object(h.reload)(),y(!y())),a.a.rainloopI18N=null};function T(){g.forEach(function(e){b[e[0]]=v(e[1])})}function C(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;e&&e(),t?y.subscribe(function(){e&&e(),t&&t()}):e&&y.subscribe(e)}function A(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return e=a.a.parseInt(e,10)||0,u.Notification.ClientViewError===e&&t?t:(n=n&&a.a.parseInt(n,10)||0,Object(d.isUnd)(b[e])?n&&Object(d.isUnd)(b[n])?b[n]:"":b[e])}function E(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:u.Notification.UnknownNotification;return e&&e.ErrorCode?A(Object(d.pInt)(e.ErrorCode),e.ErrorMessage||""):A(t)}function F(e){var t="";switch(a.a.parseInt(e,10)||0){case u.UploadErrorCode.FileIsTooBig:t=v("UPLOAD/ERROR_FILE_IS_TOO_BIG");break;case u.UploadErrorCode.FilePartiallyUploaded:t=v("UPLOAD/ERROR_FILE_PARTIALLY_UPLOADED");break;case u.UploadErrorCode.FileNoUploaded:t=v("UPLOAD/ERROR_NO_FILE_UPLOADED");break;case u.UploadErrorCode.MissingTempFolder:t=v("UPLOAD/ERROR_MISSING_TEMP_FOLDER");break;case u.UploadErrorCode.FileOnSaveingError:t=v("UPLOAD/ERROR_ON_SAVING_FILE");break;case u.UploadErrorCode.FileType:t=v("UPLOAD/ERROR_FILE_TYPE");break;default:t=v("UPLOAD/ERROR_UNKNOWN")}return t}function j(n,o){var i=Object(d.microtime)();return p.$html.addClass("rl-changing-language"),new a.a.Promise(function(t,e){c.a.ajax({url:Object(f.n)(o,n),dataType:"script",cache:!0}).then(function(){r.a.delay(function(){w();var e=-1<Object(d.inArray)((o||"").toLowerCase(),["ar","ar_sa","he","he_he","ur","ur_ir"]);p.$html.removeClass("rl-changing-language").removeClass("rl-rtl rl-ltr").addClass(e?"rl-rtl":"rl-ltr"),t()},500<Object(d.microtime)()-i?1:500)},function(){p.$html.removeClass("rl-changing-language"),a.a.rainloopI18N=null,e()})})}p.$html.addClass("rl-"+(p.$html.attr("dir")||"ltr"))},function(e,t,n){"use strict";t.__esModule=!0;var o,i=(o=n(106))&&o.__esModule?o:{default:o};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";t.__esModule=!0;var o=r(n(149)),i=r(n(153)),a=r(n(106));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,a.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(1),r=n(4),c=n.n(r),s=n(5),l=n(0),u=n(23),d=n(2),p=n(15),h=n(34),f=function(){function e(){i()(this,e),this.displaySpecSetting=a.a.observable(!0),this.sentFolder=a.a.observable(""),this.draftFolder=a.a.observable(""),this.spamFolder=a.a.observable(""),this.trashFolder=a.a.observable(""),this.archiveFolder=a.a.observable(""),this.namespace="",this.folderList=a.a.observableArray([]),this.folderList.optimized=a.a.observable(!1),this.folderList.error=a.a.observable(""),this.foldersLoading=a.a.observable(!1),this.foldersCreating=a.a.observable(!1),this.foldersDeleting=a.a.observable(!1),this.foldersRenaming=a.a.observable(!1),this.foldersInboxUnreadCount=a.a.observable(0),this.currentFolder=a.a.observable(null).extend({toggleSubscribeProperty:[this,"selected"]}),this.sieveAllowFileintoInbox=!!Object(s.settingsGet)("SieveAllowFileintoInbox"),this.computers(),this.subscribers()}return e.prototype.computers=function(){var s=this;this.draftFolderNotEnabled=a.a.computed(function(){return""===s.draftFolder()||u.r===s.draftFolder()}),this.foldersListWithSingleInboxRootFolder=a.a.computed(function(){return!c.a.find(s.folderList(),function(e){return e&&!e.isSystemFolder()&&e.visible()})}),this.currentFolderFullNameRaw=a.a.computed(function(){return s.currentFolder()?s.currentFolder().fullNameRaw:""}),this.currentFolderFullName=a.a.computed(function(){return s.currentFolder()?s.currentFolder().fullName:""}),this.currentFolderFullNameHash=a.a.computed(function(){return s.currentFolder()?s.currentFolder().fullNameHash:""}),this.foldersChanging=a.a.computed(function(){var e=s.foldersLoading(),t=s.foldersCreating(),n=s.foldersDeleting(),o=s.foldersRenaming();return e||t||n||o}),this.folderListSystemNames=a.a.computed(function(){var e=[Object(p.h)()],t=s.folderList(),n=s.sentFolder(),o=s.draftFolder(),i=s.spamFolder(),a=s.trashFolder(),r=s.archiveFolder();return Object(d.isArray)(t)&&0<t.length&&(""!==n&&u.r!==n&&e.push(n),""!==o&&u.r!==o&&e.push(o),""!==i&&u.r!==i&&e.push(i),""!==a&&u.r!==a&&e.push(a),""!==r&&u.r!==r&&e.push(r)),e}),this.folderListSystem=a.a.computed(function(){return c.a.compact(c.a.map(s.folderListSystemNames(),function(e){return Object(p.e)(e)}))}),this.folderMenuForMove=a.a.computed(function(){return Object(d.folderListOptionsBuilder)(s.folderListSystem(),s.folderList(),[s.currentFolderFullNameRaw()],null,null,null,null,function(e){return e?e.localName():""})}),this.folderMenuForFilters=a.a.computed(function(){return Object(d.folderListOptionsBuilder)(s.folderListSystem(),s.folderList(),[s.sieveAllowFileintoInbox?"":"INBOX"],[["",""]],null,null,null,function(e){return e?e.localName():""})})},e.prototype.subscribers=function(){var e=function(t){return function(){var e=Object(p.e)(t());e&&e.type(l.FolderType.User)}},t=function(n){return function(e){var t=Object(p.e)(e);t&&t.type(n)}};this.sentFolder.subscribe(e(this.sentFolder),this,"beforeChange"),this.draftFolder.subscribe(e(this.draftFolder),this,"beforeChange"),this.spamFolder.subscribe(e(this.spamFolder),this,"beforeChange"),this.trashFolder.subscribe(e(this.trashFolder),this,"beforeChange"),this.archiveFolder.subscribe(e(this.archiveFolder),this,"beforeChange"),this.sentFolder.subscribe(t(l.FolderType.SentItems),this),this.draftFolder.subscribe(t(l.FolderType.Draft),this),this.spamFolder.subscribe(t(l.FolderType.Spam),this),this.trashFolder.subscribe(t(l.FolderType.Trash),this),this.archiveFolder.subscribe(t(l.FolderType.Archive),this)},e.prototype.getNextFolderNames=function(){var n=[],o=Object(h.momentNowUnix)(),i=o-300,a=[],r=Object(p.h)();return function t(e){c.a.each(e,function(e){e&&r!==e.fullNameRaw&&e.selectable&&e.existen&&i>e.interval&&(e.isSystemFolder()||e.subScribed()&&e.checkable())&&a.push([e.interval,e.fullNameRaw]),e&&0<e.subFolders().length&&t(e.subFolders())})}(this.folderList()),a.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}),c.a.find(a,function(e){var t=Object(p.e)(e[1]);return t&&(t.interval=o,n.push(e[1])),5<=n.length}),c.a.uniq(n)},e}();t.a=new f},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(3),l=n.n(a),r=n(4),m=n.n(r),s=n(1),c=n(7),b=n.n(c),g=n(0),y=n(2),v=n(15),u=n(23),S=n(6),f=n(16),d=n(10),p=n(34),h=n(45);function O(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=0,i=0,a=[];if(Object(y.isNonEmptyArray)(e))for(i=e.length;o<i;o++)a.push(e[o].toLine(t,n));return a.join(", ")}function w(e){var t=0,n=0,o=[];if(Object(y.isNonEmptyArray)(e))for(n=e.length;t<n;t++)e[t]&&e[t].email&&""!==e[t].name&&o.push(e[t].email);return o.join(", ")}function T(e){var t=0,n=0,o=null,i=[];if(Object(y.isNonEmptyArray)(e))for(t=0,n=e.length;t<n;t++)(o=h.EmailModel.newInstanceFromJson(e[t]))&&i.push(o);return i}function C(e,t,n){if(e&&0<e.length)for(var o=0,i=e.length;o<i;o++)Object(y.isUnd)(t[e[o].email])&&(t[e[o].email]=!0,n.push(e[o]))}var A=n(11),E=n.n(A),F=n(12),j=n.n(F),N=n(54),R=n.n(N),I=n(185),L=n.n(I),_=n(186),P=n.n(_),M=n(13),D=n(30),k=n(80),x=function(t){function n(){i()(this,n);var e=E()(this,t.call(this,"MessageModel"));return e.folderFullNameRaw="",e.uid="",e.hash="",e.requestHash="",e.subject=s.a.observable(""),e.subjectPrefix=s.a.observable(""),e.subjectSuffix=s.a.observable(""),e.size=s.a.observable(0),e.dateTimeStampInUTC=s.a.observable(0),e.priority=s.a.observable(g.MessagePriority.Normal),e.proxy=!1,e.fromEmailString=s.a.observable(""),e.fromClearEmailString=s.a.observable(""),e.toEmailsString=s.a.observable(""),e.toClearEmailsString=s.a.observable(""),e.senderEmailsString=s.a.observable(""),e.senderClearEmailsString=s.a.observable(""),e.emails=[],e.from=[],e.to=[],e.cc=[],e.bcc=[],e.replyTo=[],e.deliveredTo=[],e.unsubsribeLinks=[],e.newForAnimation=s.a.observable(!1),e.deleted=s.a.observable(!1),e.deletedMark=s.a.observable(!1),e.unseen=s.a.observable(!1),e.flagged=s.a.observable(!1),e.answered=s.a.observable(!1),e.forwarded=s.a.observable(!1),e.isReadReceipt=s.a.observable(!1),e.focused=s.a.observable(!1),e.selected=s.a.observable(!1),e.checked=s.a.observable(!1),e.hasAttachments=s.a.observable(!1),e.attachmentsSpecData=s.a.observableArray([]),e.attachmentIconClass=s.a.computed(function(){return Object(k.b)(e.hasAttachments()?e.attachmentsSpecData():[])}),e.body=null,e.isHtml=s.a.observable(!1),e.hasImages=s.a.observable(!1),e.attachments=s.a.observableArray([]),e.isPgpSigned=s.a.observable(!1),e.isPgpEncrypted=s.a.observable(!1),e.pgpSignedVerifyStatus=s.a.observable(g.SignedVerifyStatus.None),e.pgpSignedVerifyUser=s.a.observable(""),e.priority=s.a.observable(g.MessagePriority.Normal),e.readReceipt=s.a.observable(""),e.aDraftInfo=[],e.sMessageId="",e.sInReplyTo="",e.sReferences="",e.hasUnseenSubMessage=s.a.observable(!1),e.hasFlaggedSubMessage=s.a.observable(!1),e.threads=s.a.observableArray([]),e.threadsLen=s.a.computed(function(){return e.threads().length}),e.isImportant=s.a.computed(function(){return g.MessagePriority.High===e.priority()}),e.regDisposables([e.attachmentIconClass,e.threadsLen,e.isImportant]),e}return j()(n,t),n.newInstanceFromJson=function(e){var t=new n;return t.initByJson(e)?t:null},n.prototype.clear=function(){this.folderFullNameRaw="",this.uid="",this.hash="",this.requestHash="",this.subject(""),this.subjectPrefix(""),this.subjectSuffix(""),this.size(0),this.dateTimeStampInUTC(0),this.priority(g.MessagePriority.Normal),this.proxy=!1,this.fromEmailString(""),this.fromClearEmailString(""),this.toEmailsString(""),this.toClearEmailsString(""),this.senderEmailsString(""),this.senderClearEmailsString(""),this.emails=[],this.from=[],this.to=[],this.cc=[],this.bcc=[],this.replyTo=[],this.deliveredTo=[],this.unsubsribeLinks=[],this.newForAnimation(!1),this.deleted(!1),this.deletedMark(!1),this.unseen(!1),this.flagged(!1),this.answered(!1),this.forwarded(!1),this.isReadReceipt(!1),this.selected(!1),this.checked(!1),this.hasAttachments(!1),this.attachmentsSpecData([]),this.body=null,this.isHtml(!1),this.hasImages(!1),this.attachments([]),this.isPgpSigned(!1),this.isPgpEncrypted(!1),this.pgpSignedVerifyStatus(g.SignedVerifyStatus.None),this.pgpSignedVerifyUser(""),this.priority(g.MessagePriority.Normal),this.readReceipt(""),this.aDraftInfo=[],this.sMessageId="",this.sInReplyTo="",this.sReferences="",this.threads([]),this.hasUnseenSubMessage(!1),this.hasFlaggedSubMessage(!1)},n.prototype.getEmails=function(e){var n=this;return m.a.compact(m.a.uniq(m.a.map(m.a.reduce(e,function(e,t){return e.concat(n[t])},[]),function(e){return e?e.email:""})))},n.prototype.getRecipientsEmails=function(){return this.getEmails(["to","cc"])},n.prototype.friendlySize=function(){return Object(y.friendlySize)(this.size())},n.prototype.computeSenderEmail=function(){var e=M.a.sentFolder(),t=M.a.draftFolder();this.senderEmailsString(this.folderFullNameRaw===e||this.folderFullNameRaw===t?this.toEmailsString():this.fromEmailString()),this.senderClearEmailsString(this.folderFullNameRaw===e||this.folderFullNameRaw===t?this.toClearEmailsString():this.fromClearEmailString())},n.prototype.initByJson=function(e){var t=!1,n=g.MessagePriority.Normal;return e&&"Object/Message"===e["@Object"]&&(n=Object(y.pInt)(e.Priority),this.priority(-1<Object(y.inArray)(n,[g.MessagePriority.High,g.MessagePriority.Low])?n:g.MessagePriority.Normal),this.folderFullNameRaw=e.Folder,this.uid=e.Uid,this.hash=e.Hash,this.requestHash=e.RequestHash,this.proxy=!!e.ExternalProxy,this.size(Object(y.pInt)(e.Size)),this.from=T(e.From),this.to=T(e.To),this.cc=T(e.Cc),this.bcc=T(e.Bcc),this.replyTo=T(e.ReplyTo),this.deliveredTo=T(e.DeliveredTo),this.unsubsribeLinks=Object(y.isNonEmptyArray)(e.UnsubsribeLinks)?e.UnsubsribeLinks:[],this.subject(e.Subject),Object(y.isArray)(e.SubjectParts)?(this.subjectPrefix(e.SubjectParts[0]),this.subjectSuffix(e.SubjectParts[1])):(this.subjectPrefix(""),this.subjectSuffix(this.subject())),this.dateTimeStampInUTC(Object(y.pInt)(e.DateTimeStampInUTC)),this.hasAttachments(!!e.HasAttachments),this.attachmentsSpecData(Object(y.isArray)(e.AttachmentsSpecData)?e.AttachmentsSpecData:[]),this.fromEmailString(O(this.from,!0)),this.fromClearEmailString(w(this.from)),this.toEmailsString(O(this.to,!0)),this.toClearEmailsString(w(this.to)),this.threads(Object(y.isArray)(e.Threads)?e.Threads:[]),this.initFlagsByJson(e),this.computeSenderEmail(),t=!0),t},n.prototype.initUpdateByMessageJson=function(e){var t=!1,n=g.MessagePriority.Normal;return e&&"Object/Message"===e["@Object"]&&(n=Object(y.pInt)(e.Priority),this.priority(-1<Object(y.inArray)(n,[g.MessagePriority.High,g.MessagePriority.Low])?n:g.MessagePriority.Normal),this.aDraftInfo=e.DraftInfo,this.sMessageId=e.MessageId,this.sInReplyTo=e.InReplyTo,this.sReferences=e.References,this.proxy=!!e.ExternalProxy,D.a.capaOpenPGP()&&(this.isPgpSigned(!!e.PgpSigned),this.isPgpEncrypted(!!e.PgpEncrypted)),this.hasAttachments(!!e.HasAttachments),this.attachmentsSpecData(Object(y.isArray)(e.AttachmentsSpecData)?e.AttachmentsSpecData:[]),this.foundedCIDs=Object(y.isArray)(e.FoundedCIDs)?e.FoundedCIDs:[],this.attachments(this.initAttachmentsFromJson(e.Attachments)),this.readReceipt(e.ReadReceipt||""),this.computeSenderEmail(),t=!0),t},n.prototype.initAttachmentsFromJson=function(e){var t=0,n=0,o=null,i=[];if(e&&"Collection/AttachmentCollection"===e["@Object"]&&Object(y.isNonEmptyArray)(e["@Collection"]))for(t=0,n=e["@Collection"].length;t<n;t++)(o=k.a.newInstanceFromJson(e["@Collection"][t]))&&(""!==o.cidWithOutTags&&0<this.foundedCIDs.length&&0<=Object(y.inArray)(o.cidWithOutTags,this.foundedCIDs)&&(o.isLinked=!0),i.push(o));return i},n.prototype.hasUnsubsribeLinks=function(){return this.unsubsribeLinks&&0<this.unsubsribeLinks.length},n.prototype.getFirstUnsubsribeLink=function(){return this.unsubsribeLinks&&0<this.unsubsribeLinks.length&&this.unsubsribeLinks[0]||""},n.prototype.initFlagsByJson=function(e){var t=!1;return e&&"Object/Message"===e["@Object"]&&(this.unseen(!e.IsSeen),this.flagged(!!e.IsFlagged),this.answered(!!e.IsAnswered),this.forwarded(!!e.IsForwarded),this.isReadReceipt(!!e.IsReadReceipt),this.deletedMark(!!e.IsDeleted),t=!0),t},n.prototype.fromToLine=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return O(this.from,e,t)},n.prototype.fromDkimData=function(){var e=["none",""];return Object(y.isNonEmptyArray)(this.from)&&1===this.from.length&&this.from[0]&&this.from[0].dkimStatus&&(e=[this.from[0].dkimStatus,this.from[0].dkimValue||""]),e},n.prototype.toToLine=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return O(this.to,e,t)},n.prototype.ccToLine=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return O(this.cc,e,t)},n.prototype.bccToLine=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return O(this.bcc,e,t)},n.prototype.replyToToLine=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return O(this.replyTo,e,t)},n.prototype.lineAsCss=function(){return L()({deleted:this.deleted(),"deleted-mark":this.deletedMark(),selected:this.selected(),checked:this.checked(),flagged:this.flagged(),unseen:this.unseen(),answered:this.answered(),forwarded:this.forwarded(),focused:this.focused(),important:this.isImportant(),withAttachments:this.hasAttachments(),new:this.newForAnimation(),emptySubject:""===this.subject(),hasUnseenSubMessage:this.hasUnseenSubMessage(),hasFlaggedSubMessage:this.hasFlaggedSubMessage()})},n.prototype.hasVisibleAttachments=function(){return!!m.a.find(this.attachments(),function(e){return!e.isLinked})},n.prototype.findAttachmentByCid=function(t){var e=null,n=this.attachments();return Object(y.isNonEmptyArray)(n)&&(t=t.replace(/^<+/,"").replace(/>+$/,""),e=m.a.find(n,function(e){return t===e.cidWithOutTags})),e||null},n.prototype.findAttachmentByContentLocation=function(t){var e=null,n=this.attachments();return Object(y.isNonEmptyArray)(n)&&(e=m.a.find(n,function(e){return t===e.contentLocation})),e||null},n.prototype.messageId=function(){return this.sMessageId},n.prototype.inReplyTo=function(){return this.sInReplyTo},n.prototype.references=function(){return this.sReferences},n.prototype.fromAsSingleEmail=function(){return Object(y.isArray)(this.from)&&this.from[0]?this.from[0].email:""},n.prototype.viewLink=function(){return Object(f.q)(this.requestHash)},n.prototype.downloadLink=function(){return Object(f.p)(this.requestHash)},n.prototype.replyEmails=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=[],o=Object(y.isUnd)(e)?{}:e;return C(this.replyTo,o,n),0===n.length&&C(this.from,o,n),0!==n.length||t?n:this.replyEmails({},!0)},n.prototype.replyAllEmails=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=[],o=[],i=Object(y.isUnd)(e)?{}:e;return C(this.replyTo,i,n),0===n.length&&C(this.from,i,n),C(this.to,i,n),C(this.cc,i,o),0!==n.length||t?[n,o]:[this.replyAllEmails({},!0)[0],o]},n.prototype.textBodyToString=function(){return this.body?this.body.html():""},n.prototype.attachmentsToStringLine=function(){var e=m.a.map(this.attachments(),function(e){return e.fileName+" ("+e.friendlySize+")"});return e&&0<e.length?e.join(", "):""},n.prototype.viewPopupMessage=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.showLazyExternalImagesInBody();var t=this.dateTimeStampInUTC()||0,n=this.ccToLine(!1),o=0<t?R.a.unix(t):null;Object(y.previewMessage)({title:this.subject(),subject:this.subject(),date:o?o.format("LLL"):"",fromCreds:this.fromToLine(!1),toLabel:Object(d.i18n)("MESSAGE/LABEL_TO"),toCreds:this.toToLine(!1),ccClass:n?"":"rl-preview-hide",ccLabel:Object(d.i18n)("MESSAGE/LABEL_CC"),ccCreds:n},this.body,this.isHtml(),e)},n.prototype.printMessage=function(){this.viewPopupMessage(!0)},n.prototype.generateUid=function(){return this.folderFullNameRaw+"/"+this.uid},n.prototype.populateByMessageListItem=function(e){return e&&(this.folderFullNameRaw=e.folderFullNameRaw,this.uid=e.uid,this.hash=e.hash,this.requestHash=e.requestHash,this.subject(e.subject())),this.subjectPrefix(this.subjectPrefix()),this.subjectSuffix(this.subjectSuffix()),e&&(this.size(e.size()),this.dateTimeStampInUTC(e.dateTimeStampInUTC()),this.priority(e.priority()),this.proxy=e.proxy,this.fromEmailString(e.fromEmailString()),this.fromClearEmailString(e.fromClearEmailString()),this.toEmailsString(e.toEmailsString()),this.toClearEmailsString(e.toClearEmailsString()),this.emails=e.emails,this.from=e.from,this.to=e.to,this.cc=e.cc,this.bcc=e.bcc,this.replyTo=e.replyTo,this.deliveredTo=e.deliveredTo,this.unsubsribeLinks=e.unsubsribeLinks,this.unseen(e.unseen()),this.flagged(e.flagged()),this.answered(e.answered()),this.forwarded(e.forwarded()),this.isReadReceipt(e.isReadReceipt()),this.deletedMark(e.deletedMark()),this.priority(e.priority()),this.selected(e.selected()),this.checked(e.checked()),this.hasAttachments(e.hasAttachments()),this.attachmentsSpecData(e.attachmentsSpecData())),this.body=null,this.aDraftInfo=[],this.sMessageId="",this.sInReplyTo="",this.sReferences="",e&&this.threads(e.threads()),this.computeSenderEmail(),this},n.prototype.showLazyExternalImagesInBody=function(){this.body&&b()(".lazy.lazy-inited[data-original]",this.body).each(function(){b()(this).attr("src",b()(this).attr("data-original")).removeAttr("data-original").removeAttr("data-loaded")})},n.prototype.lozad=function(){P()("img.lazy:not(.lazy-inited)",{threshold:.4,load:function(e){e.src=u.e,b()(e).addClass("lazy-inited").attr("src",e.dataset.original).removeAttr("data-loaded").removeAttr("data-original").css({opacity:.3}).animate({opacity:1},500)}}).observe()},n.prototype.showExternalImages=function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.body&&this.body.data("rl-has-images")){this.hasImages(!1),this.body.data("rl-has-images",!1);var n=this.proxy?"data-x-additional-src":"data-x-src";b()("["+n+"]",this.body).each(function(){var e=b()(this);t&&e.is("img")?e.addClass("lazy").attr("data-original",e.attr(n)).removeAttr("data-loaded"):e.attr("src",e.attr(n)).removeAttr("data-loaded")}),n=this.proxy?"data-x-additional-style-url":"data-x-style-url",b()("["+n+"]",this.body).each(function(){var e=b()(this),t=Object(y.trim)(e.attr("style"));t=""===t?"":";"===t.substr(-1)?t+" ":t+"; ",e.attr("style",t+e.attr(n))}),t&&(this.lozad(),S.$win.resize()),Object(y.windowResize)(500)}},n.prototype.showInternalImages=function(){var e=this,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.body&&!this.body.data("rl-init-internal-images")){this.body.data("rl-init-internal-images",!0);var i=this;b()("[data-x-src-cid]",this.body).each(function(){var e=b()(this),t=i.findAttachmentByCid(e.attr("data-x-src-cid"));t&&t.download&&(n&&e.is("img")?e.addClass("lazy").attr("data-original",t.linkPreview()):e.attr("src",t.linkPreview()))}),b()("[data-x-src-location]",this.body).each(function(){var e=b()(this),t=i.findAttachmentByContentLocation(e.attr("data-x-src-location"));t||(t=i.findAttachmentByCid(e.attr("data-x-src-location"))),t&&t.download&&(n&&e.is("img")?e.addClass("lazy").attr("data-original",t.linkPreview()):e.attr("src",t.linkPreview()))}),b()("[data-x-style-cid]",this.body).each(function(){var e="",t="",n=b()(this),o=i.findAttachmentByCid(n.attr("data-x-style-cid"));o&&o.linkPreview&&""!==(t=n.attr("data-x-style-cid-name"))&&(e=""===(e=Object(y.trim)(n.attr("style")))?"":";"===e.substr(-1)?e+" ":e+"; ",n.attr("style",e+t+": url('"+o.linkPreview()+"')"))}),n&&m.a.delay(function(){return e.lozad()},300),Object(y.windowResize)(500)}},n.prototype.storeDataInDom=function(){this.body&&(this.body.data("rl-is-html",!!this.isHtml()),this.body.data("rl-has-images",!!this.hasImages()))},n.prototype.fetchDataFromDom=function(){this.body&&(this.isHtml(!!this.body.data("rl-is-html")),this.hasImages(!!this.body.data("rl-has-images")))},n.prototype.replacePlaneTextBody=function(e){this.body&&this.body.html(e).addClass("b-text-part plain")},n.prototype.flagHash=function(){return[this.deleted(),this.deletedMark(),this.unseen(),this.flagged(),this.answered(),this.forwarded(),this.isReadReceipt()].join(",")},n}(n(36).a),U=n(9),H=n(26),B=n(31),G=n(28),K=n(62),V=n(20),z=n(17),q=function(){function e(){i()(this,e),this.staticMessage=new x,this.messageList=s.a.observableArray([]).extend({rateLimit:0}),this.messageListCount=s.a.observable(0),this.messageListSearch=s.a.observable(""),this.messageListThreadUid=s.a.observable(""),this.messageListPage=s.a.observable(1),this.messageListPageBeforeThread=s.a.observable(1),this.messageListError=s.a.observable(""),this.messageListEndFolder=s.a.observable(""),this.messageListEndSearch=s.a.observable(""),this.messageListEndThreadUid=s.a.observable(""),this.messageListEndPage=s.a.observable(1),this.messageListLoading=s.a.observable(!1),this.messageListIsNotCompleted=s.a.observable(!1),this.messageListCompleteLoadingThrottle=s.a.observable(!1).extend({throttle:200}),this.messageListCompleteLoadingThrottleForAnimation=s.a.observable(!1).extend({specialThrottle:700}),this.messageListDisableAutoSelect=s.a.observable(!1).extend({falseTimeout:500}),this.selectorMessageSelected=s.a.observable(null),this.selectorMessageFocused=s.a.observable(null),this.message=s.a.observable(null),this.message.viewTrigger=s.a.observable(!1),this.messageError=s.a.observable(""),this.messageCurrentLoading=s.a.observable(!1),this.messageLoadingThrottle=s.a.observable(!1).extend({throttle:g.Magics.Time50ms}),this.messageFullScreenMode=s.a.observable(!1),this.messagesBodiesDom=s.a.observable(null),this.messageActiveDom=s.a.observable(null),this.computers(),this.subscribers(),this.onMessageResponse=m.a.bind(this.onMessageResponse,this),this.purgeMessageBodyCacheThrottle=m.a.throttle(this.purgeMessageBodyCache,g.Magics.Time30s)}return e.prototype.computers=function(){var o=this;this.messageLoading=s.a.computed(function(){return o.messageCurrentLoading()}),this.messageListEndHash=s.a.computed(function(){return o.messageListEndFolder()+"|"+o.messageListEndSearch()+"|"+o.messageListEndThreadUid()+"|"+o.messageListEndPage()}),this.messageListPageCount=s.a.computed(function(){var e=l.a.Math.ceil(o.messageListCount()/G.a.messagesPerPage());return e<=0?1:e}),this.mainMessageListSearch=s.a.computed({read:this.messageListSearch,write:function(e){Object(U.setHash)(Object(f.o)(M.a.currentFolderFullNameHash(),1,Object(y.trim)(e.toString()),o.messageListThreadUid()))}}),this.messageListCompleteLoading=s.a.computed(function(){var e=o.messageListLoading(),t=o.messageListIsNotCompleted();return e||t}),this.isMessageSelected=s.a.computed(function(){return null!==o.message()}),this.messageListChecked=s.a.computed(function(){return m.a.filter(o.messageList(),function(e){return e.checked()})}).extend({rateLimit:0}),this.hasCheckedMessages=s.a.computed(function(){return 0<o.messageListChecked().length}).extend({rateLimit:0}),this.messageListCheckedOrSelected=s.a.computed(function(){var e=o.messageListChecked(),t=o.selectorMessageSelected(),n=o.selectorMessageFocused();return e.length?m.a.union(e,t?[t]:[]):t?[t]:n?[n]:[]}),this.messageListCheckedOrSelectedUidsWithSubMails=s.a.computed(function(){var t=[];return m.a.each(o.messageListCheckedOrSelected(),function(e){e&&(t.push(e.uid),1<e.threadsLen()&&(t=m.a.union(t,e.threads())))}),t})},e.prototype.subscribers=function(){var n=this;this.messageListCompleteLoading.subscribe(function(e){e=!!e,n.messageListCompleteLoadingThrottle(e),n.messageListCompleteLoadingThrottleForAnimation(e)}),this.messageList.subscribe(m.a.debounce(function(e){m.a.each(e,function(e){e&&e.newForAnimation()&&e.newForAnimation(!1)})},g.Magics.Time500ms)),this.message.subscribe(function(e){e?g.Layout.NoPreview===G.a.layout()&&H.a.focusedState(g.Focused.MessageView):(H.a.focusedState(g.Focused.MessageList),n.messageFullScreenMode(!1),n.hideMessageBodies())}),this.messageLoading.subscribe(function(e){n.messageLoadingThrottle(e)}),this.messagesBodiesDom.subscribe(function(e){!e||e instanceof b.a||n.messagesBodiesDom(b()(e))}),this.messageListEndFolder.subscribe(function(e){var t=n.message();t&&e&&e!==t.folderFullNameRaw&&n.message(null)})},e.prototype.purgeMessageBodyCache=function(){var t=0,n=S.data.iMessageBodyCacheCount-u.k;if(0<n){var e=this.messagesBodiesDom();e&&(e.find(".rl-cache-class").each(function(){var e=b()(this);n>e.data("rl-cache-count")&&(e.addClass("rl-cache-purge"),t+=1)}),0<t&&m.a.delay(function(){return e.find(".rl-cache-purge").remove()},g.Magics.Time350ms))}},e.prototype.initUidNextAndNewMessages=function(t,e,n){if(Object(v.h)()===t&&Object(y.isNormal)(e)&&""!==e){if(Object(y.isArray)(n)&&0<n.length){m.a.each(n,function(e){Object(v.a)(t,e.Uid)}),K.a.playSoundNotification();var o=n.length;3<o?K.a.displayDesktopNotification(Object(f.r)(),B.a.email(),Object(d.i18n)("MESSAGE_LIST/NEW_MESSAGE_NOTIFICATION",{COUNT:o}),{Folder:"",Uid:""}):m.a.each(n,function(e){K.a.displayDesktopNotification(Object(f.r)(),O(T(e.From),!1),e.Subject,{Folder:e.Folder,Uid:e.Uid})})}Object(v.s)(t,e)}},e.prototype.hideMessageBodies=function(){var e=this.messagesBodiesDom();e&&e.find(".b-text-part").hide()},e.prototype.removeMessagesFromList=function(e,t){var n=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];t=m.a.map(t,function(e){return Object(y.pInt)(e)});var a=0,r=this.messageList(),s=this.message(),c=M.a.trashFolder(),l=M.a.spamFolder(),u=Object(v.e)(e),d=""===o?null:Object(v.e)(o||""),p=M.a.currentFolderFullNameRaw()===e?m.a.filter(r,function(e){return e&&-1<Object(y.inArray)(Object(y.pInt)(e.uid),t)}):[];if(m.a.each(p,function(e){e&&e.unseen()&&(a+=1)}),u&&!i&&(u.messageCountAll(0<=u.messageCountAll()-t.length?u.messageCountAll()-t.length:0),0<a&&u.messageCountUnread(0<=u.messageCountUnread()-a?u.messageCountUnread()-a:0)),d&&(c!==d.fullNameRaw&&l!==d.fullNameRaw||(a=0),d.messageCountAll(d.messageCountAll()+t.length),0<a&&d.messageCountUnread(d.messageCountUnread()+a),d.actionBlink(!0)),0<p.length&&(i?m.a.each(p,function(e){e.checked(!1)}):(this.messageListIsNotCompleted(!0),m.a.each(p,function(e){s&&s.hash===e.hash&&(s=null,n.message(null)),e.deleted(!0)}),m.a.delay(function(){m.a.each(p,function(e){n.messageList.remove(e)})},g.Magics.Time350ms))),""!==e&&Object(v.q)(e,""),""!==o&&Object(v.q)(o,""),""!==this.messageListThreadUid()&&(r=this.messageList())&&0<r.length&&m.a.find(r,function(e){return!(!e||!e.deleted()||e.uid!==n.messageListThreadUid())})){var h=m.a.find(r,function(e){return e&&!e.deleted()});h&&this.messageListThreadUid()!==Object(y.pString)(h.uid)?(this.messageListThreadUid(Object(y.pString)(h.uid)),Object(U.setHash)(Object(f.o)(M.a.currentFolderFullNameHash(),this.messageListPage(),this.messageListSearch(),this.messageListThreadUid()),!0,!0)):h||(1<this.messageListPage()?(this.messageListPage(this.messageListPage()-1),Object(U.setHash)(Object(f.o)(M.a.currentFolderFullNameHash(),this.messageListPage(),this.messageListSearch(),this.messageListThreadUid()),!0,!0)):(this.messageListThreadUid(""),Object(U.setHash)(Object(f.o)(M.a.currentFolderFullNameHash(),this.messageListPageBeforeThread(),this.messageListSearch()),!0,!0)))}},e.prototype.initBlockquoteSwitcher=function(e){if(e){var t=b()("blockquote:not(.rl-bq-switcher)",e).filter(function(){return 0===b()(this).parent().closest("blockquote",e).length});t&&0<t.length&&t.each(function(){var e=b()(this),t=e.height();0===t&&(t=Object(y.getRealHeight)(e)),""!==Object(y.trim)(e.text())&&(0===t||100<t)&&(e.addClass("rl-bq-switcher hidden-bq"),b()('<span class="rlBlockquoteSwitcher"><i class="icon-ellipsis" /></span>').insertBefore(e).on("click.rlBlockquoteSwitcher",function(){e.toggleClass("hidden-bq"),Object(y.windowResize)()}).after("<br />").before("<br />"))})}},e.prototype.initOpenPgpControls=function(e,t){e&&e.find&&e.find(".b-plain-openpgp:not(.inited)").each(function(){D.a.initMessageBodyControls(b()(this),t)})},e.prototype.setMessage=function(e,t){var n=!1,o=null,i="",a="",r="",s=!1,c=this.messagesBodiesDom(),l=this.selectorMessageSelected(),u=this.message();if(e&&u&&e.Result&&"Object/Message"===e.Result["@Object"]&&u.folderFullNameRaw===e.Result.Folder){var d=u.threads();if(u.uid!==e.Result.Uid&&1<d.length&&-1<Object(y.inArray)(e.Result.Uid,d)&&(u=x.newInstanceFromJson(e.Result))&&(u.threads(d),Object(v.n)(u),this.message(this.staticMessage.populateByMessageListItem(u)),u=this.message(),n=!0),u&&u.uid===e.Result.Uid){if(this.messageError(""),u.initUpdateByMessageJson(e.Result),Object(v.b)(u.folderFullNameRaw,u.uid),t||u.initFlagsByJson(e.Result),c=c&&c[0]?c:null){i="rl-mgs-"+u.hash.replace(/[^a-zA-Z0-9]/g,"");var p=c.find("#"+i);if(p&&p[0])u.body=p,u.body&&(S.data.iMessageBodyCacheCount+=1,u.body.data("rl-cache-count",S.data.iMessageBodyCacheCount),u.fetchDataFromDom());else{var h=!1;if(Object(y.isNormal)(e.Result.Html)&&""!==e.Result.Html)h=!0,r=e.Result.Html.toString();else if(Object(y.isNormal)(e.Result.Plain)&&""!==e.Result.Plain)if(h=!1,r=Object(y.plainToHtml)(e.Result.Plain.toString(),!1),(u.isPgpSigned()||u.isPgpEncrypted())&&D.a.capaOpenPGP()){a=Object(y.pString)(e.Result.Plain);var f=/---BEGIN PGP MESSAGE---/.test(a);f||(s=/-----BEGIN PGP SIGNED MESSAGE-----/.test(a)&&/-----BEGIN PGP SIGNATURE-----/.test(a)),S.$div.empty(),r=s&&u.isPgpSigned()?S.$div.append(b()('<pre class="b-plain-openpgp signed"></pre>').text(a)).html():f&&u.isPgpEncrypted()?S.$div.append(b()('<pre class="b-plain-openpgp encrypted"></pre>').text(a)).html():"<pre>"+r+"</pre>",S.$div.empty(),u.isPgpSigned(s),u.isPgpEncrypted(f)}else r="<pre>"+r+"</pre>";else h=!1,r="<pre>"+r+"</pre>";S.data.iMessageBodyCacheCount+=1,(o=b()('<div id="'+i+'" ></div>').hide().addClass("rl-cache-class")).data("rl-cache-count",S.data.iMessageBodyCacheCount),o.html(Object(y.findEmailAndLinks)(r)).addClass("b-text-part "+(h?"html":"plain")),u.isHtml(!!h),u.hasImages(!!e.Result.HasExternals),u.body=o,u.body&&c.append(u.body),u.storeDataInDom(),e.Result.HasInternals&&u.showInternalImages(!0),u.hasImages()&&G.a.showImages()&&u.showExternalImages(!0),this.purgeMessageBodyCacheThrottle()}this.messageActiveDom(u.body),this.hideMessageBodies(),o&&(this.initOpenPgpControls(o,u),this.initBlockquoteSwitcher(o)),u.body.show()}Object(v.n)(u),(u.unseen()||u.hasUnseenSubMessage())&&Object(V.a)().messageListAction(u.folderFullNameRaw,g.MessageSetAction.SetSeen,[u]),n&&(u=this.message(),l&&u&&(u.folderFullNameRaw!==l.folderFullNameRaw||u.uid!==l.uid)?(this.selectorMessageSelected(null),1===this.messageList().length&&this.selectorMessageFocused(null)):!l&&u&&(l=m.a.find(this.messageList(),function(e){return e&&e.folderFullNameRaw===u.folderFullNameRaw&&e.uid===u.uid}))&&(this.selectorMessageSelected(l),this.selectorMessageFocused(l))),Object(y.windowResize)()}}},e.prototype.selectMessage=function(e){e?(this.message(this.staticMessage.populateByMessageListItem(e)),this.populateMessageBody(this.message())):this.message(null)},e.prototype.selectMessageByFolderAndUid=function(e,t){e&&t?(this.message(this.staticMessage.populateByMessageListItem(null)),this.message().folderFullNameRaw=e,this.message().uid=t,this.populateMessageBody(this.message())):this.message(null)},e.prototype.populateMessageBody=function(e){e&&z.a.message(this.onMessageResponse,e.folderFullNameRaw,e.uid)&&this.messageCurrentLoading(!0)},e.prototype.onMessageResponse=function(e,t,n){this.hideMessageBodies(),this.messageCurrentLoading(!1),g.StorageResultType.Success===e&&t&&t.Result?this.setMessage(t,n):g.StorageResultType.Unload===e?(this.message(null),this.messageError("")):g.StorageResultType.Abort!==e&&(this.message(null),this.messageError(t&&t.ErrorCode?Object(d.getNotification)(t.ErrorCode):Object(d.getNotification)(g.Notification.UnknownError)))},e.prototype.calculateMessageListHash=function(e){return m.a.map(e,function(e){return e.hash+"_"+e.threadsLen()+"_"+e.flagHash()}).join("|")},e.prototype.setMessageList=function(e,n){if(e&&e.Result&&"Collection/MessageCollection"===e.Result["@Object"]&&e.Result["@Collection"]&&Object(y.isArray)(e.Result["@Collection"])){var o=0,t=!1,i=[],a=Object(p.momentNowUnix)(),r=Object(y.pInt)(e.Result.MessageResultCount),s=Object(y.pInt)(e.Result.Offset),c=Object(v.e)(Object(y.isNormal)(e.Result.Folder)?e.Result.Folder:"");c&&!n&&(c.interval=a,Object(v.q)(e.Result.Folder,e.Result.FolderHash),Object(y.isNormal)(e.Result.MessageCount)&&c.messageCountAll(e.Result.MessageCount),Object(y.isNormal)(e.Result.MessageUnseenCount)&&(Object(y.pInt)(c.messageCountUnread())!==Object(y.pInt)(e.Result.MessageUnseenCount)&&(t=!0),c.messageCountUnread(e.Result.MessageUnseenCount)),this.initUidNextAndNewMessages(c.fullNameRaw,e.Result.UidNext,e.Result.NewMessages)),t&&c&&Object(v.c)(c.fullNameRaw),m.a.each(e.Result["@Collection"],function(e){if(e&&"Object/Message"===e["@Object"]){var t=x.newInstanceFromJson(e);t&&(Object(v.l)(t.folderFullNameRaw,t.uid)&&o<=5&&(o+=1,t.newForAnimation(!0)),t.deleted(!1),n?Object(v.n)(t):Object(v.u)(t),i.push(t))}}),this.messageListCount(r),this.messageListSearch(Object(y.isNormal)(e.Result.Search)?e.Result.Search:""),this.messageListPage(l.a.Math.ceil(s/G.a.messagesPerPage()+1)),this.messageListThreadUid(Object(y.isNormal)(e.Result.ThreadUid)?Object(y.pString)(e.Result.ThreadUid):""),this.messageListEndFolder(Object(y.isNormal)(e.Result.Folder)?e.Result.Folder:""),this.messageListEndSearch(this.messageListSearch()),this.messageListEndThreadUid(this.messageListThreadUid()),this.messageListEndPage(this.messageListPage()),this.messageListDisableAutoSelect(!0),this.messageList(i),this.messageListIsNotCompleted(!1),Object(v.d)(),c&&(n||t||G.a.useThreads())&&Object(V.a)().folderInformation(c.fullNameRaw,i)}else this.messageListCount(0),this.messageList([]),this.messageListError(Object(d.getNotification)(e&&e.ErrorCode?e.ErrorCode:g.Notification.CantGetMessageList))},e}();t.a=new q},function(e,t,n){"use strict";n.d(t,"k",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"m",function(){return S}),n.d(t,"a",function(){return O}),n.d(t,"l",function(){return w}),n.d(t,"d",function(){return T}),n.d(t,"h",function(){return C}),n.d(t,"f",function(){return A}),n.d(t,"p",function(){return E}),n.d(t,"g",function(){return F}),n.d(t,"q",function(){return j}),n.d(t,"i",function(){return N}),n.d(t,"s",function(){return R}),n.d(t,"e",function(){return I}),n.d(t,"r",function(){return L}),n.d(t,"o",function(){return _}),n.d(t,"j",function(){return P}),n.d(t,"t",function(){return M}),n.d(t,"c",function(){return D}),n.d(t,"n",function(){return k}),n.d(t,"u",function(){return x}),n.d(t,"v",function(){return U}),n.d(t,"w",function(){return H});var o=n(4),a=n.n(o),r=n(0),s=n(2),i=n(16),c={},l={},u={},d={},p={},h={},f="",m={},b=n(5).capa(r.Capa.Gravatar);function g(e,t){e=Object(s.trim)(e),t(b&&""!==e?i.h(e):"",e)}function y(e,t){return e+"#"+t}function v(e,t){m[y(e,t)]=!0}function S(e,t){return!0===m[y(e,t)]}function O(e,t){h[y(e,t)]=!0}function w(e,t){return!!h[y(e,t)]&&!(h[y(e,t)]=null)}function T(){h={}}function C(){return""===f?"INBOX":f}function A(e){return""!==e&&l[e]?l[e]:""}function E(e,t){"INBOX"!==(l[e]=t)&&""!==f||(f=t)}function F(e){return""!==e&&u[e]?u[e]:""}function j(e,t){""!==e&&(u[e]=t)}function N(e){return""!==e&&d[e]?d[e]:""}function R(e,t){d[e]=t}function I(e){return""!==e&&c[e]?c[e]:null}function L(e,t){c[e]=t}function _(e){L(e,null)}function P(e,t){return p[e]&&p[e][t]?p[e][t]:null}function M(e,t,n){p[e]||(p[e]={}),p[e][t]=n}function D(e){p[e]={}}function k(n){if(n){var o=n.uid,e=P(n.folderFullNameRaw,o);if(e&&0<e.length&&(n.flagged(!!e[1]),n.isSimpleMessage||(n.unseen(!!e[0]),n.answered(!!e[2]),n.forwarded(!!e[3]),n.isReadReceipt(!!e[4]),n.deletedMark(!!e[5]))),0<n.threads().length){var t=a.a.find(n.threads(),function(e){if(o!==e){var t=P(n.folderFullNameRaw,e);return t&&0<t.length&&!!t[0]}return!1}),i=a.a.find(n.threads(),function(e){if(o!==e){var t=P(n.folderFullNameRaw,e);return t&&0<t.length&&!!t[1]}return!1});n.hasUnseenSubMessage(t&&0<Object(s.pInt)(t)),n.hasFlaggedSubMessage(i&&0<Object(s.pInt)(i))}}}function x(e){e&&M(e.folderFullNameRaw,e.uid,[e.unseen(),e.flagged(),e.answered(),e.forwarded(),e.isReadReceipt(),e.deletedMark()])}function U(e,t,n){Object(s.isArray)(n)&&0<n.length&&M(e,t,n)}function H(e,t,n){var o=0,i=P(e,t);if(Object(s.isArray)(i)&&0<i.length){switch(i[0]&&(o=1),n){case r.MessageSetAction.SetSeen:i[0]=!1;break;case r.MessageSetAction.UnsetSeen:i[0]=!0;break;case r.MessageSetAction.SetFlag:i[1]=!0;break;case r.MessageSetAction.UnsetFlag:i[1]=!1}M(e,t,i)}return o}},function(e,t,n){"use strict";n.d(t,"v",function(){return y}),n.d(t,"E",function(){return v}),n.d(t,"w",function(){return S}),n.d(t,"x",function(){return O}),n.d(t,"y",function(){return w}),n.d(t,"c",function(){return C}),n.d(t,"e",function(){return A}),n.d(t,"g",function(){return E}),n.d(t,"f",function(){return F}),n.d(t,"d",function(){return j}),n.d(t,"G",function(){return R}),n.d(t,"I",function(){return I}),n.d(t,"H",function(){return L}),n.d(t,"b",function(){return _}),n.d(t,"i",function(){return P}),n.d(t,"a",function(){return M}),n.d(t,"q",function(){return D}),n.d(t,"p",function(){return k}),n.d(t,"h",function(){return x}),n.d(t,"J",function(){return U}),n.d(t,"u",function(){return H}),n.d(t,"n",function(){return B}),n.d(t,"l",function(){return G}),n.d(t,"k",function(){return K}),n.d(t,"B",function(){return V}),n.d(t,"C",function(){return z}),n.d(t,"A",function(){return q}),n.d(t,"j",function(){return Y}),n.d(t,"D",function(){return $}),n.d(t,"r",function(){return J}),n.d(t,"s",function(){return X}),n.d(t,"t",function(){return Z}),n.d(t,"F",function(){return Q}),n.d(t,"m",function(){return ee}),n.d(t,"z",function(){return te}),n.d(t,"o",function(){return ne});var o=n(3),r=n.n(o),s=n(2),i=n(5),a="./",c="#/",l="./?",u="&q[]=",d=i.appSettingsGet("version"),p=i.appSettingsGet("webPath")||"",h=i.appSettingsGet("webVersionPath")||"rainloop/v/"+d+"/",f=h+"static/",m=!!i.appSettingsGet("adminHostUse"),b=i.appSettingsGet("adminPath")||"admin",g=i.settingsGet("AuthAccountHash")||"0";function y(){g=i.settingsGet("AuthAccountHash")||"0"}function v(){return u}function S(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return c+Object(s.pString)(e)}function O(){return m?a:l+b}function w(){return a}function T(e,t,n){return n=Object(s.isUnd)(n)?g:n,l+"/Raw/"+u+"/"+n+"/"+e+"/"+u+"/"+t}function C(e,t){return T("Download",e,t)}function A(e,t){return T("View",e,t)}function E(e,t){return T("ViewThumbnail",e,t)}function F(e,t){return T("ViewAsPlain",e,t)}function j(e,t){return T("FramedView",e,t)}function N(e){return l+"/"+e+"/"+u+"/"+g+"/"}function R(){return N("Upload")}function I(){return N("UploadContacts")}function L(){return N("UploadBackground")}function _(){return N("Append")}function P(e){return N("Change")+Object(s.encodeURIComponent)(e)+"/"}function M(e){return N("Ajax")+e}function D(e){return l+"/Raw/"+u+"/"+g+"/ViewAsPlain/"+u+"/"+e}function k(e){return l+"/Raw/"+u+"/"+g+"/Download/"+u+"/"+e}function x(e){return l+"/Raw/0/Avatar/"+Object(s.encodeURIComponent)(e)+"/"}function U(e){return l+"/Raw/"+u+"/"+g+"/UserBackground/"+u+"/"+e}function H(){return l+"/Info"}function B(e,t){return l+"/Lang/0/"+(t?"Admin":"App")+"/"+r.a.encodeURI(e)+"/"+d+"/"}function G(){return l+"/Raw/"+u+"/"+g+"/ContactsVcf/"}function K(){return l+"/Raw/"+u+"/"+g+"/ContactsCsv/"}function V(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return l+"SocialGoogle"+(""!==g?"/"+u+"/"+g+"/":"")+(e?"&xauth=1":"")}function z(){return l+"SocialTwitter"+(""!==g?"/"+u+"/"+g+"/":"")}function q(){return l+"SocialFacebook"+(""!==g?"/"+u+"/"+g+"/":"")}function W(e){return f+e}function Y(){return W("css/images/empty-contact.png")}function $(e){return W("sounds/"+e)}function J(){return W("css/images/icom-message-notification.png")}function X(){return W("js/min/openpgp.min.js")}function Z(){return W("js/min/openpgp.worker.min.js")}function Q(e){var t=h;return"@custom"===e.substr(-7)&&(e=Object(s.trim)(e.substring(0,e.length-7)),t=p),t+"themes/"+r.a.encodeURI(e)+"/images/preview.png"}function ee(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"INBOX";return c+"mailbox/"+e}function te(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return c+"settings"+(e?"/"+e:"")}function ne(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";t=Object(s.isNormal)(t)?Object(s.pInt)(t):1,n=Object(s.pString)(n);var i=c+"mailbox/";if(""!==e){var a=Object(s.pInt)(o);i+=r.a.encodeURI(e)+(0<a?"~"+a:"")}return 1<t&&(i=i.replace(/[\/]+$/,""),i+="/p"+t),""!==n&&(i=i.replace(/[\/]+$/,""),i+="/"+r.a.encodeURI(n)),i}},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(4),u=n.n(l),d=n(2),v=n(23),p=n(15),h=n(16),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m={urlsafe_encode:function(e){return m.encode(e).replace(/[+]/g,"-").replace(/[\/]/g,"_").replace(/[=]/g,"")},encode:function(e){var t="",n=void 0,o=void 0,i=void 0,a=void 0,r=void 0,s=void 0,c=void 0,l=0;for(e=m._utf8_encode(e);l<e.length;)a=(n=e.charCodeAt(l++))>>2,r=(3&n)<<4|(o=e.charCodeAt(l++))>>4,s=(15&o)<<2|(i=e.charCodeAt(l++))>>6,c=63&i,isNaN(o)?s=c=64:isNaN(i)&&(c=64),t=t+f.charAt(a)+f.charAt(r)+f.charAt(s)+f.charAt(c);return t},decode:function(e){var t="",n=void 0,o=void 0,i=void 0,a=void 0,r=void 0,s=void 0,c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)n=f.indexOf(e.charAt(c++))<<2|(a=f.indexOf(e.charAt(c++)))>>4,o=(15&a)<<4|(r=f.indexOf(e.charAt(c++)))>>2,i=(3&r)<<6|(s=f.indexOf(e.charAt(c++))),t+=String.fromCharCode(n),64!==r&&(t+=String.fromCharCode(o)),64!==s&&(t+=String.fromCharCode(i));return m._utf8_decode(t)},_utf8_encode:function(e){for(var t="",n=0,o=(e=e.replace(/\r\n/g,"\n")).length,i=0;n<o;n++)(i=e.charCodeAt(n))<128?t+=String.fromCharCode(i):(127<i&&i<2048?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(63&i|128));return t},_utf8_decode:function(e){for(var t="",n=0,o=0,i=0,a=0;n<e.length;)(o=e.charCodeAt(n))<128?(t+=String.fromCharCode(o),n++):191<o&&o<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&i),n+=2):(i=e.charCodeAt(n+1),a=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&i)<<6|63&a),n+=3);return t}},b=(m.decode,m.encode,m.urlsafe_encode),g=n(5),y=n(26),S=n(28),O=n(20),w=function(t){function n(){i()(this,n);var e=r()(this,t.call(this));return e.oRequests={},e}return c()(n,t),n.prototype.folders=function(e){this.defaultRequest(e,"Folders",{SentFolder:g.settingsGet("SentFolder"),DraftFolder:g.settingsGet("DraftFolder"),SpamFolder:g.settingsGet("SpamFolder"),TrashFolder:g.settingsGet("TrashFolder"),ArchiveFolder:g.settingsGet("ArchiveFolder")},null,"",["Folders"])},n.prototype.login=function(e,t,n,o,i,a,r,s){this.defaultRequest(e,"Login",{Email:t,Login:n,Password:o,Language:a||"",AdditionalCode:r||"",AdditionalCodeSignMe:s?"1":"0",SignMe:i?"1":"0"})},n.prototype.getTwoFactor=function(e){this.defaultRequest(e,"GetTwoFactorInfo")},n.prototype.createTwoFactor=function(e){this.defaultRequest(e,"CreateTwoFactorSecret")},n.prototype.clearTwoFactor=function(e){this.defaultRequest(e,"ClearTwoFactorInfo")},n.prototype.showTwoFactorSecret=function(e){this.defaultRequest(e,"ShowTwoFactorSecret")},n.prototype.testTwoFactor=function(e,t){this.defaultRequest(e,"TestTwoFactorInfo",{Code:t})},n.prototype.enableTwoFactor=function(e,t){this.defaultRequest(e,"EnableTwoFactor",{Enable:t?"1":"0"})},n.prototype.clearTwoFactorInfo=function(e){this.defaultRequest(e,"ClearTwoFactorInfo")},n.prototype.contactsSync=function(e){this.defaultRequest(e,"ContactsSync",null,v.d)},n.prototype.saveContactsSyncData=function(e,t,n,o,i){this.defaultRequest(e,"SaveContactsSyncData",{Enable:t?"1":"0",Url:n,User:o,Password:i})},n.prototype.accountSetup=function(e,t,n){var o=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];this.defaultRequest(e,"AccountSetup",{Email:t,Password:n,New:o?"1":"0"})},n.prototype.accountDelete=function(e,t){this.defaultRequest(e,"AccountDelete",{EmailToDelete:t})},n.prototype.accountsAndIdentitiesSortOrder=function(e,t,n){this.defaultRequest(e,"AccountsAndIdentitiesSortOrder",{Accounts:t,Identities:n})},n.prototype.identityUpdate=function(e,t,n,o,i,a,r,s){this.defaultRequest(e,"IdentityUpdate",{Id:t,Email:n,Name:o,ReplyTo:i,Bcc:a,Signature:r,SignatureInsertBefore:s?"1":"0"})},n.prototype.identityDelete=function(e,t){this.defaultRequest(e,"IdentityDelete",{IdToDelete:t})},n.prototype.accountsAndIdentities=function(e){this.defaultRequest(e,"AccountsAndIdentities")},n.prototype.accountsCounts=function(e){this.defaultRequest(e,"AccountsCounts")},n.prototype.filtersSave=function(e,t,n,o){this.defaultRequest(e,"FiltersSave",{Raw:n,RawIsActive:Object(d.boolToAjax)(o),Filters:u.a.map(t,function(e){return e.toJson()})})},n.prototype.filtersGet=function(e){this.defaultRequest(e,"Filters",{})},n.prototype.templates=function(e){this.defaultRequest(e,"Templates",{})},n.prototype.templateGetById=function(e,t){this.defaultRequest(e,"TemplateGetByID",{ID:t})},n.prototype.templateDelete=function(e,t){this.defaultRequest(e,"TemplateDelete",{IdToDelete:t})},n.prototype.templateSetup=function(e,t,n,o){this.defaultRequest(e,"TemplateSetup",{ID:t,Name:n,Body:o})},n.prototype.messageList=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:20,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"",a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"",r=6<arguments.length&&void 0!==arguments[6]&&arguments[6];t=Object(d.pString)(t);var s=Object(p.g)(t),c=y.a.threadsAllowed()&&S.a.useThreads(),l=Object(p.h)()===t?Object(p.i)(t):"";return""===s||""!==i&&-1!==i.indexOf("is:")?this.defaultRequest(e,"MessageList",{Folder:t,Offset:n,Limit:o,Search:i,UidNext:l,UseThreads:c?"1":"0",ThreadUid:c?a:""},""===i?v.g:v.m,"",r?[]:["MessageList"]):this.defaultRequest(e,"MessageList",{},""===i?v.g:v.m,"MessageList/"+Object(h.E)()+"/"+b([t,n,o,i,y.a.projectHash(),s,l,c?"1":"0",c?a:""].join(String.fromCharCode(0))),r?[]:["MessageList"])},n.prototype.messageUploadAttachments=function(e,t){this.defaultRequest(e,"MessageUploadAttachments",{Attachments:t},999e3)},n.prototype.message=function(e,t,n){return t=Object(d.pString)(t),n=Object(d.pInt)(n),!!(Object(p.e)(t)&&0<n)&&(this.defaultRequest(e,"Message",{},null,"Message/"+Object(h.E)()+"/"+b([t,n,y.a.projectHash(),y.a.threadsAllowed()&&S.a.useThreads()?"1":"0"].join(String.fromCharCode(0))),["Message"]),!0)},n.prototype.composeUploadExternals=function(e,t){this.defaultRequest(e,"ComposeUploadExternals",{Externals:t},999e3)},n.prototype.composeUploadDrive=function(e,t,n){this.defaultRequest(e,"ComposeUploadDrive",{AccessToken:n,Url:t},999e3)},n.prototype.folderInformation=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],o=!0,i=[];Object(d.isArray)(n)&&0<n.length&&(o=!1,u.a.each(n,function(t){Object(p.j)(t.folderFullNameRaw,t.uid)||i.push(t.uid),0<t.threads().length&&u.a.each(t.threads(),function(e){Object(p.j)(t.folderFullNameRaw,e)||i.push(e)})}),0<i.length&&(o=!0)),o?this.defaultRequest(e,"FolderInformation",{Folder:t,FlagsUids:Object(d.isArray)(i)?i.join(","):"",UidNext:Object(p.h)()===t?Object(p.i)(t):""}):S.a.useThreads()&&Object(O.a)().reloadFlagsCurrentMessageListAndMessageFromCache()},n.prototype.folderInformationMultiply=function(e,t){this.defaultRequest(e,"FolderInformationMultiply",{Folders:t})},n.prototype.logout=function(e){this.defaultRequest(e,"Logout")},n.prototype.messageSetFlagged=function(e,t,n,o){this.defaultRequest(e,"MessageSetFlagged",{Folder:t,Uids:n.join(","),SetAction:o?"1":"0"})},n.prototype.messageSetSeen=function(e,t,n,o){this.defaultRequest(e,"MessageSetSeen",{Folder:t,Uids:n.join(","),SetAction:o?"1":"0"})},n.prototype.messageSetSeenToAll=function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;this.defaultRequest(e,"MessageSetSeenToAll",{Folder:t,SetAction:n?"1":"0",ThreadUids:o?o.join(","):""})},n.prototype.saveMessage=function(e,t,n,o,i,a,r,s,c,l,u,d,p,h,f,m,b){this.defaultRequest(e,"SaveMessage",{IdentityID:t,MessageFolder:n,MessageUid:o,DraftFolder:i,To:a,Cc:r,Bcc:s,ReplyTo:c,Subject:l,TextIsHtml:u?"1":"0",Text:d,DraftInfo:h,InReplyTo:f,References:m,MarkAsImportant:b?"1":"0",Attachments:p},v.l)},n.prototype.sendReadReceiptMessage=function(e,t,n,o,i,a){this.defaultRequest(e,"SendReadReceiptMessage",{MessageFolder:t,MessageUid:n,ReadReceipt:o,Subject:i,Text:a})},n.prototype.sendMessage=function(e,t,n,o,i,a,r,s,c,l,u,d,p,h,f,m,b,g,y){this.defaultRequest(e,"SendMessage",{IdentityID:t,MessageFolder:n,MessageUid:o,SentFolder:i,To:a,Cc:r,Bcc:s,ReplyTo:c,Subject:l,TextIsHtml:u?"1":"0",Text:d,DraftInfo:h,InReplyTo:f,References:m,Dsn:b?"1":"0",ReadReceiptRequest:g?"1":"0",MarkAsImportant:y?"1":"0",Attachments:p},v.n)},n.prototype.saveSystemFolders=function(e,t){this.defaultRequest(e,"SystemFoldersUpdate",t)},n.prototype.saveSettings=function(e,t){this.defaultRequest(e,"SettingsUpdate",t)},n.prototype.saveSettingsHelper=function(n,o,i){var a=this;return function(e){var t;a.saveSettings(i||null,((t={})[n]=o?o(e):e,t))}},n.prototype.changePassword=function(e,t,n){this.defaultRequest(e,"ChangePassword",{PrevPassword:t,NewPassword:n})},n.prototype.folderClear=function(e,t){this.defaultRequest(e,"FolderClear",{Folder:t})},n.prototype.folderSetSubscribe=function(e,t,n){this.defaultRequest(e,"FolderSubscribe",{Folder:t,Subscribe:n?"1":"0"})},n.prototype.folderSetCheckable=function(e,t,n){this.defaultRequest(e,"FolderCheckable",{Folder:t,Checkable:n?"1":"0"})},n.prototype.messagesMove=function(e,t,n,o,i,a){this.defaultRequest(e,"MessageMove",{FromFolder:t,ToFolder:n,Uids:o.join(","),MarkAsRead:a?"1":"0",Learning:i||""},null,"",["MessageList"])},n.prototype.messagesCopy=function(e,t,n,o){this.defaultRequest(e,"MessageCopy",{FromFolder:t,ToFolder:n,Uids:o.join(",")})},n.prototype.messagesDelete=function(e,t,n){this.defaultRequest(e,"MessageDelete",{Folder:t,Uids:n.join(",")},null,"",["MessageList"])},n.prototype.appDelayStart=function(e){this.defaultRequest(e,"AppDelayStart")},n.prototype.quota=function(e){this.defaultRequest(e,"Quota")},n.prototype.contacts=function(e,t,n,o){this.defaultRequest(e,"Contacts",{Offset:t,Limit:n,Search:o},null,"",["Contacts"])},n.prototype.contactSave=function(e,t,n,o){this.defaultRequest(e,"ContactSave",{RequestUid:t,Uid:Object(d.trim)(n),Properties:o})},n.prototype.contactsDelete=function(e,t){this.defaultRequest(e,"ContactsDelete",{Uids:t.join(",")})},n.prototype.suggestions=function(e,t,n){this.defaultRequest(e,"Suggestions",{Query:t,Page:n},null,"",["Suggestions"])},n.prototype.clearUserBackground=function(e){this.defaultRequest(e,"ClearUserBackground")},n.prototype.facebookUser=function(e){this.defaultRequest(e,"SocialFacebookUserInformation")},n.prototype.facebookDisconnect=function(e){this.defaultRequest(e,"SocialFacebookDisconnect")},n.prototype.twitterUser=function(e){this.defaultRequest(e,"SocialTwitterUserInformation")},n.prototype.twitterDisconnect=function(e){this.defaultRequest(e,"SocialTwitterDisconnect")},n.prototype.googleUser=function(e){this.defaultRequest(e,"SocialGoogleUserInformation")},n.prototype.googleDisconnect=function(e){this.defaultRequest(e,"SocialGoogleDisconnect")},n.prototype.socialUsers=function(e){this.defaultRequest(e,"SocialUsers")},n}(n(115).a);t.a=new w},function(e,t,n){e.exports={default:n(102),__esModule:!0}},function(e,t){e.exports=window.key},function(e,t,n){"use strict";function o(){return n(172).default}n.d(t,"a",function(){return o})},,function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l});var o=n(4),i=n.n(o),a=n(2),r=n(29),s={};function c(e,t,n){Object(a.isObject)(e)?(n=t||null,t=null,i.a.each(e,function(e,t){c(t,e,n)})):(Object(a.isUnd)(s[e])&&(s[e]=[]),s[e].push([t,n]))}function l(e,t){r.f("rl-pub",[e,t]),Object(a.isUnd)(s[e])||i.a.each(s[e],function(e){e[0]&&e[0].apply(e[1]||null,t||[])})}},function(e,t,n){"use strict";n.d(t,"i",function(){return o}),n.d(t,"j",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"g",function(){return r}),n.d(t,"m",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"l",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"r",function(){return d}),n.d(t,"b",function(){return p}),n.d(t,"h",function(){return h}),n.d(t,"p",function(){return f}),n.d(t,"o",function(){return m}),n.d(t,"k",function(){return b}),n.d(t,"a",function(){return g}),n.d(t,"q",function(){return y}),n.d(t,"f",function(){return v}),n.d(t,"e",function(){return S});var o=20,i=[10,20,30,50,100],a=50,r=3e4,s=3e5,c=3e5,l=2e5,u=2e5,d="__UNUSE__",p="rlcsc",h=143,f=25,m=4190,b=15,g=7,y=10,v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAuCAYAAABXuSs3AAAHHklEQVRoQ7VZW08bVxCeXRuwIbTGXIwNtBBaqjwgVUiR8lDlbza9qe1DpVZ9aNQ/0KpPeaJK07SpcuEeCEmUAObm21bfrL9lONjexSYrWfbunj37zXdmvpkz9oIgCKTD0Wg0xPd94TDP83Q0zvWa50vzklSrdanVanqf4/D84GBGr+F+Op3S8fqoJxLOdnZgTvsO/nYhenHA+UC7CWF1uXwkb9++ldPTUwVerVbVqFQqpR8YPjQ0JCMjI5LNDijoRgP3PQVu5+5Eor2XGLg7IV4GkIdHJ/LmzRs5ODiIwNbrdR0O0GCcq4Xz4eFhmZyclP7+tDQaIik/BG5XKQn4SwG3zJTLZXn9+rUclI8UHD5YVoDDN8bSzXhONwL48fFxGR4eilzFZT1uFRIB5yT8BqCdnR3Z3d0VP9Un6XRawYJpggVrZBv38ME4XKtUKnLt2jUplUoy1PR/l3U7T6sVSAQcgMAkj8PDQ9ne3pajoyMRL7zeKsYZWHgWYDGmv78/mmdwcFA+mJlSgziHDWrERrsjEXDXegTi1tZW+DLxI2bxIrqFNYTXyDyCFweMAHCwb8e4RnTNuOsqe3t7sra21pTD0Kct666E8XlcZyzw9/RUUXK5nK5oUinUQI6TQ3cynO/v78vq6qrKXCNwlTiJJpyNGc3nZHp6uqV2dwrQWOCtZBDAV1ZWwsQk7f0wiQn5kffbAu/0/KWBYzIC1+XukfGx0RGZmppKlC2tIV0Bh4aDcZW7HhkfH8urLLZL7T2pihvlkMNnz56FiadHxicL41IsFpN41bkxsYxbRdFo9jwB8KdPn14J8KnSpBQKhQs63nPmbCVRcBUAR2Lq1VVmpksyMTFxAXjcEsQybiegESionjx5osCZOeNe1O4+EhCAX7bQSgQcxRHTMgAgcz5+/Dis/hL4uHU3/B4YGNASGHIKxuEql0k+l05AeIAF1vPnz5VxFFmdDlaJrMtZITJeSsXCOTlMunKxjLtMYOKNjQ158eJFuAuKkUOb5sEwgff19SkJUBVkThZUbnXZrtCKBQ6gbnWIkjZpyne3ejAWoGnA7Icz6irvBLgbOMicCM6TkxPx/LAkbXfgWcsazuE2kFRsKD5Z+CiqDumKncpZvieWcS6dDVD8xiYCNflpJdwcdwJOf9airLmVQ7DPzMxIYWLsXGXoVqLt5k0M3K3JUVPDZdbWNzsCp48TPFdvdnZWUz32nDha7bJ63kgAJPzSdRks9/Kf9xMJAQ1gq2NpaUmy2Yz4zar4nQC3xb99AQwCcGzLAAwuhG8YiWvcOKts+r4GOe5nMhm5efOm9lUA3E3vSZJRrKvE0fnPv//Jy5cvo5cTHIPQbSjhOoqq69evS19f6lxDKK4+sVhigZPtKJqbrQeqxd5+WR4+fKgqgT0k2XX3nhiPgETWXFhYkFzuPZ2yVq1GTSOXpE47/VjgNnD4m4GG7/LhsTx69EiwD4Vr2MwIIxgbAH18fKx1yfz8vEogNvGtWnCuhLZa9UTAreVWFsHy/b/+Vrbdl7E5REMQD2jDoUbByty+/ZnU64GkU2HzyJLhktU1cLv8nARgkYS2d3ajAgwG8qU2oLmDZ92CMaOjo7K4uCiZgbDWaRWgnZhPxLhrMUCvr69riwKZk1LHF7XqrWAO9hJxH6ozNzcnCx/PqztZg9mf6SQMscCtm2C5ke4BGMlHWTUp36036AJajDVrFMzBrhhWslQsSrFYiOqVpMriNYIgqFRq2j3FAb/zffT6zuxFXxsNzs3NTXn16lW4gYiW96w1FyedF+83xG/2FNGCRpU4NjamMsn+OZ9xE5RXqdaDdPpib6RWCzuwKF9RxqI2AVNQBwQYJoK0wdBejnqtEikP3pfP51XjUTESl12FqJEKxsEorARYDD44ONTeID7YpsEnrRvQfWAI2e8WfDaTUSIwJ0iBCmFOtOUAHvVMPp/TPwvYFVYFIuP8l+DBgwdaa2Miqwa0GgYwfeMltovbDfh6c1vIgMYcliSsKv4IWFr6VDHxvldvBAH+1sA+cnl5WYOPmmr9ir+1l9I0Cgz0yjhXjfJJ0JROnmezWbl165ayr/5fqwcBNr7IfhjMqKcvESSM4eRcCasQ3bDNObmKPLdGUGpZsN24cUNLBm9zazu4d++e6qpNBFaTuUS26U5dpuR1CxyA7J9ddrMRqlz4pwLLYawymPd++/2PADt2ugcGwq9gCCdhQ96C6xWwa6j1ceuq+I0EhW0i8MAIVJfeL3d/DVD8EKi12P6/2S2jV/EccVB54O/ejz/9HGCpoBBMta5rXMXLu53D1XAwjhXwvvv+h4BAXVe4bOu3O3ChxF08LiZFG3fel199G9CH3fLyqv24NcB44MRhpdK788U3CpyKwsCw590xmfSpzsBt0Fqc3ud3vtZigxWcVZCklVpSiN0w3q5E/h9TGMIUuA3+EQAAAABJRU5ErkJggg==",S="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var o=n(8),i=n.n(o),a=n(1),r=n(2),s=n(0),c=n(6),l=function(){function e(){i()(this,e),this.bDisabeCloseOnEsc=!1,this.sDefaultKeyScope=s.KeyState.None,this.sCurrentKeyScope=s.KeyState.None,this.viewModelVisibility=a.a.observable(!1),this.modalVisibility=a.a.observable(!1).extend({rateLimit:0}),this.viewModelName="",this.viewModelNames=[],this.viewModelDom=null}return e.prototype.storeAndSetKeyScope=function(){this.sCurrentKeyScope=Object(c.keyScope)(),Object(c.keyScope)(this.sDefaultKeyScope)},e.prototype.restoreKeyScope=function(){Object(c.keyScope)(this.sCurrentKeyScope)},e.prototype.registerPopupKeyDown=function(){var t=this;c.$win.on("keydown",function(e){if(e&&t.modalVisibility&&t.modalVisibility()){if(!t.bDisabeCloseOnEsc&&s.EventKeyCode.Esc===e.keyCode)return Object(r.delegateRun)(t,"cancelCommand"),!1;if(s.EventKeyCode.Backspace===e.keyCode&&!Object(r.inFocus)())return!1}return!0})},e.prototype.cancelCommand=function(){},e.prototype.closeCommand=function(){},e}()},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(3),r=n.n(a),s=n(1),c=n(7),l=n.n(c),u=n(5),d=function(){function t(){var e=this;i()(this,t),this.google={},this.twitter={},this.facebook={},this.dropbox={},this.google.enabled=s.a.observable(!1),this.google.clientID=s.a.observable(""),this.google.clientSecret=s.a.observable(""),this.google.apiKey=s.a.observable(""),this.google.loading=s.a.observable(!1),this.google.userName=s.a.observable(""),this.google.loggined=s.a.computed(function(){return""!==e.google.userName()}),this.google.capa={},this.google.capa.auth=s.a.observable(!1),this.google.capa.authFast=s.a.observable(!1),this.google.capa.drive=s.a.observable(!1),this.google.capa.preview=s.a.observable(!1),this.google.require={},this.google.require.clientSettings=s.a.computed(function(){return e.google.enabled()&&(e.google.capa.auth()||e.google.capa.drive())}),this.google.require.apiKeySettings=s.a.computed(function(){return e.google.enabled()&&e.google.capa.drive()}),this.facebook.enabled=s.a.observable(!1),this.facebook.appID=s.a.observable(""),this.facebook.appSecret=s.a.observable(""),this.facebook.loading=s.a.observable(!1),this.facebook.userName=s.a.observable(""),this.facebook.supported=s.a.observable(!1),this.facebook.loggined=s.a.computed(function(){return""!==e.facebook.userName()}),this.twitter.enabled=s.a.observable(!1),this.twitter.consumerKey=s.a.observable(""),this.twitter.consumerSecret=s.a.observable(""),this.twitter.loading=s.a.observable(!1),this.twitter.userName=s.a.observable(""),this.twitter.loggined=s.a.computed(function(){return""!==e.twitter.userName()}),this.dropbox.enabled=s.a.observable(!1),this.dropbox.apiKey=s.a.observable("")}return t.prototype.populate=function(){this.google.enabled(!!u.settingsGet("AllowGoogleSocial")),this.google.clientID(u.settingsGet("GoogleClientID")),this.google.clientSecret(u.settingsGet("GoogleClientSecret")),this.google.apiKey(u.settingsGet("GoogleApiKey")),this.google.capa.auth(!!u.settingsGet("AllowGoogleSocialAuth")),this.google.capa.authFast(!!u.settingsGet("AllowGoogleSocialAuthFast")),this.google.capa.drive(!!u.settingsGet("AllowGoogleSocialDrive")),this.google.capa.preview(!!u.settingsGet("AllowGoogleSocialPreview")),this.facebook.enabled(!!u.settingsGet("AllowFacebookSocial")),this.facebook.appID(u.settingsGet("FacebookAppID")),this.facebook.appSecret(u.settingsGet("FacebookAppSecret")),this.facebook.supported(!!u.settingsGet("SupportedFacebookSocial")),this.twitter.enabled=s.a.observable(!!u.settingsGet("AllowTwitterSocial")),this.twitter.consumerKey=s.a.observable(u.settingsGet("TwitterConsumerKey")),this.twitter.consumerSecret=s.a.observable(u.settingsGet("TwitterConsumerSecret")),this.dropbox.enabled(!!u.settingsGet("AllowDropboxSocial")),this.dropbox.apiKey(u.settingsGet("DropboxApiKey"))},t.prototype.appendDropbox=function(){if(!r.a.Dropbox&&this.dropbox.enabled()&&this.dropbox.apiKey()&&!r.a.document.getElementById("dropboxjs")){var e=r.a.document.createElement("script");e.type="text/javascript",e.src="https://www.dropbox.com/static/api/2/dropins.js",l()(e).attr("id","dropboxjs").attr("data-app-key",this.dropbox.apiKey()),r.a.document.body.appendChild(e)}},t}();t.a=new d},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(1),u=n(0),d=n(6),p=n(2),h=n(5),f=function(n){function o(){i()(this,o);var e=r()(this,n.call(this));e.currentAudio=l.a.observable(""),e.focusedState=l.a.observable(u.Focused.None);var t=h.appSettingsGet("mobile");return e.focusedState.subscribe(function(e){switch(e){case u.Focused.MessageList:Object(d.keyScope)(u.KeyState.MessageList),t&&Object(d.leftPanelDisabled)(!0);break;case u.Focused.MessageView:Object(d.keyScope)(u.KeyState.MessageView),t&&Object(d.leftPanelDisabled)(!0);break;case u.Focused.FolderList:Object(d.keyScope)(u.KeyState.FolderList),t&&Object(d.leftPanelDisabled)(!1)}}),e.projectHash=l.a.observable(""),e.threadsAllowed=l.a.observable(!1),e.composeInEdit=l.a.observable(!1),e.contactsAutosave=l.a.observable(!1),e.useLocalProxyForExternalImages=l.a.observable(!1),e.contactsIsAllowed=l.a.observable(!1),e.attachmentsActions=l.a.observableArray([]),e.devEmail="",e.devPassword="",e}return c()(o,n),o.prototype.populate=function(){n.prototype.populate.call(this),this.projectHash(h.settingsGet("ProjectHash")),this.contactsAutosave(!!h.settingsGet("ContactsAutosave")),this.useLocalProxyForExternalImages(!!h.settingsGet("UseLocalProxyForExternalImages")),this.contactsIsAllowed(!!h.settingsGet("ContactsIsAllowed"));var e=h.appSettingsGet("attachmentsActions");this.attachmentsActions(Object(p.isNonEmptyArray)(e)?e:[]),this.devEmail=h.settingsGet("DevEmail"),this.devPassword=h.settingsGet("DevPassword")},o}(n(114).a);t.a=new f},function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return d});var o=n(8),i=n.n(o),a=n(7),r=n.n(a),s=n(1),c=n(2),l=n(10),u=function(){function e(){i()(this,e),this.disposable=[]}return e.prototype.dispose=function(){this.disposable.forEach(function(e){e&&e.dispose&&e.dispose()})},e}(),d=function(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return{template:e?{element:e}:"<b></b>",viewModel:{createViewModel:function(e,t){return(e=e||{}).element=null,t&&t.element&&(e.component=t,e.element=r()(t.element),Object(l.i18nToNodes)(e.element),!Object(c.isUnd)(e.inline)&&s.a.unwrap(e.inline)&&e.element.css("display","inline-block")),new n(e)}}}}},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(3),r=n.n(a),s=n(1),c=n(23),l=n(0),u=n(6),d=n(2),p=n(22),h=n(5),f=function(){function e(){i()(this,e),this.iAutoLogoutTimer=0,this.layout=s.a.observable(l.Layout.SidePreview).extend({limitedList:[l.Layout.SidePreview,l.Layout.BottomPreview,l.Layout.NoPreview]}),this.editorDefaultType=s.a.observable(l.EditorDefaultType.Html).extend({limitedList:[l.EditorDefaultType.Html,l.EditorDefaultType.Plain,l.EditorDefaultType.HtmlForced,l.EditorDefaultType.PlainForced]}),this.messagesPerPage=s.a.observable(c.i).extend({limitedList:c.j}),this.showImages=s.a.observable(!1),this.useCheckboxesInList=s.a.observable(!0),this.allowDraftAutosave=s.a.observable(!0),this.useThreads=s.a.observable(!1),this.replySameFolder=s.a.observable(!1),this.autoLogout=s.a.observable(l.Magics.Time30mInMin),this.computers(),this.subscribers()}return e.prototype.computers=function(){var e=this;this.usePreviewPane=s.a.computed(function(){return l.Layout.NoPreview!==e.layout()})},e.prototype.subscribers=function(){this.layout.subscribe(function(e){u.$html.toggleClass("rl-no-preview-pane",l.Layout.NoPreview===e),u.$html.toggleClass("rl-side-preview-pane",l.Layout.SidePreview===e),u.$html.toggleClass("rl-bottom-preview-pane",l.Layout.BottomPreview===e),p.a("layout",[e])})},e.prototype.populate=function(){var e=this;this.layout(Object(d.pInt)(h.settingsGet("Layout"))),this.editorDefaultType(h.settingsGet("EditorDefaultType")),this.autoLogout(Object(d.pInt)(h.settingsGet("AutoLogout"))),this.messagesPerPage(h.settingsGet("MPP")),this.showImages(!!h.settingsGet("ShowImages")),this.useCheckboxesInList(!!h.settingsGet("UseCheckboxesInList")),this.allowDraftAutosave(!!h.settingsGet("AllowDraftAutosave")),this.useThreads(!!h.settingsGet("UseThreads")),this.replySameFolder(!!h.settingsGet("ReplySameFolder")),p.b("rl.auto-logout-refresh",function(){r.a.clearTimeout(e.iAutoLogoutTimer),0<e.autoLogout()&&!h.settingsGet("AccountSignMe")&&(e.iAutoLogoutTimer=r.a.setTimeout(function(){p.a("rl.auto-logout")},e.autoLogout()*l.Magics.Time1m))}),p.a("rl.auto-logout-refresh")},e}();t.a=new f},function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"f",function(){return p}),n.d(t,"d",function(){return h}),n.d(t,"e",function(){return f}),n.d(t,"b",function(){return m}),n.d(t,"c",function(){return b}),n.d(t,"g",function(){return g}),n.d(t,"h",function(){return y});var o=n(4),i=n.n(o),a=n(2),r=n(6),s=n(5),c={},l=[],u=[];function d(e,t){Object(a.isFunc)(t)&&(Object(a.isArray)(c[e])||(c[e]=[]),c[e].push(t))}function p(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];Object(a.isArray)(c[e])&&i.a.each(c[e],function(e){e.apply(void 0,t)})}function h(e){return s.settingsGet(e)}function f(e,t,n,o){r.data.__APP__&&r.data.__APP__.remote().defaultRequest(e,"Plugin"+t,n,o)}function m(e,t,n,o){l.push([e,t,n,o])}function b(e,t,n,o){u.push([e,t,n,o])}function g(e){var t=n(9);i.a.each(e?u:l,function(e){t.addSettingsViewModel(e[0],e[1],e[2],e[3])})}function y(e,t){var n=s.settingsGet("Plugins");return(n=n&&!Object(a.isUnd)(n[e])?n[e]:null)?Object(a.isUnd)(n[t])?null:n[t]:null}},function(e,t,o){"use strict";var n=o(8),i=o.n(n),a=o(1),r=o(4),l=o.n(r),s=o(7),u=o.n(s),d=o(10),p=o(2),c=o(31),h=o(9),f=function(){function s(){i()(this,s),this.capaOpenPGP=a.a.observable(!1),this.openpgp=null,this.openpgpkeys=a.a.observableArray([]),this.openpgpKeyring=null,this.openpgpkeysPublic=this.openpgpkeys.filter(function(e){return!(!e||e.isPrivate)}),this.openpgpkeysPrivate=this.openpgpkeys.filter(function(e){return!(!e||!e.isPrivate)})}return s.prototype.isSupported=function(){return!!this.openpgp},s.prototype.findKeyByHex=function(e,t){return l.a.find(e,function(e){return t&&e&&(t===e.id||-1<e.ids.indexOf(t))})},s.prototype.findPublicKeyByHex=function(e){return this.findKeyByHex(this.openpgpkeysPublic(),e)},s.prototype.findPrivateKeyByHex=function(e){return this.findKeyByHex(this.openpgpkeysPrivate(),e)},s.prototype.findPublicKeysByEmail=function(n){return l.a.compact(l.a.flatten(l.a.map(this.openpgpkeysPublic(),function(e){var t=e&&-1<e.emails.indexOf(n)?e:null;return t?t.getNativeKeys():[null]}),!0))},s.prototype.findPublicKeysBySigningKeyIds=function(e){var n=this;return l.a.compact(l.a.flatten(l.a.map(e,function(e){var t=e&&e.toHex?n.findPublicKeyByHex(e.toHex()):null;return t?t.getNativeKeys():[null]}),!0))},s.prototype.findPrivateKeysByEncryptionKeyIds=function(e,t,n){var o=this,i=Object(p.isArray)(e)?l.a.compact(l.a.flatten(l.a.map(e,function(e){var t=e&&e.toHex?o.findPrivateKeyByHex(e.toHex()):null;return t?n?[t]:t.getNativeKeys():[null]}),!0)):[];return 0===i.length&&Object(p.isNonEmptyArray)(t)&&(i=l.a.uniq(l.a.compact(l.a.flatten(l.a.map(t,function(e){var t=e?o.findAllPrivateKeysByEmailNotNative(e):null;return t?n?t:l.a.flatten(l.a.map(t,function(e){return e.getNativeKeys()}),!0):[null]}),!0)),function(e){return e.id})),i},s.prototype.findPublicKeyByEmailNotNative=function(t){return l.a.find(this.openpgpkeysPublic(),function(e){return e&&-1<e.emails.indexOf(t)})||null},s.prototype.findPrivateKeyByEmailNotNative=function(t){return l.a.find(this.openpgpkeysPrivate(),function(e){return e&&-1<e.emails.indexOf(t)})||null},s.prototype.findAllPublicKeysByEmailNotNative=function(t){return l.a.filter(this.openpgpkeysPublic(),function(e){return e&&-1<e.emails.indexOf(t)})||null},s.prototype.findAllPrivateKeysByEmailNotNative=function(t){return l.a.filter(this.openpgpkeysPrivate(),function(e){return e&&-1<e.emails.indexOf(t)})||null},s.prototype.findPrivateKeyByEmail=function(t,e){var n=null,o=l.a.find(this.openpgpkeysPrivate(),function(e){return e&&-1<e.emails.indexOf(t)});if(o)try{(n=o.getNativeKeys()[0]||null)&&n.decrypt(Object(p.pString)(e))}catch(t){n=null}return n},s.prototype.findSelfPrivateKey=function(e){return this.findPrivateKeyByEmail(c.a.email(),e)},s.prototype.decryptMessage=function(t,e,i){var a=this;if(t&&t.getEncryptionKeyIds){var n=this.findPrivateKeysByEncryptionKeyIds(t.getEncryptionKeyIds(),e,!0);if(n&&0<n.length)return Object(h.showScreenPopup)(o(206),[function(e){e?t.decrypt(e).then(function(n){var o=null;n&&(o=a.findPrivateKeyByHex(e.primaryKey.keyid.toHex()))?a.verifyMessage(n,function(e,t){i(o,n,e||null,t||null)}):i(o,n)},function(){i(null,null)}):i(null,null)},n]),!1}return i(null,null),!1},s.prototype.verifyMessage=function(e,t){if(e&&e.getSigningKeyIds){var n=e.getSigningKeyIds();if(n&&0<n.length){var o=this.findPublicKeysBySigningKeyIds(n);if(o&&0<o.length)try{var i=e.verify(o),a=l.a.find(l.a.isArray(i)?i:[],function(e){return e&&e.valid&&e.keyid});if(a&&a.keyid&&a.keyid&&a.keyid.toHex)return t(this.findPublicKeyByHex(a.keyid.toHex())),!0}catch(e){Object(p.log)(e)}return t(null,n),!1}}return t(null),!1},s.prototype.controlsHelper=function(e,t,n,o,i){n?(e.removeClass("error").addClass("success").attr("title",o),t.removeClass("error").addClass("success").attr("title",o)):(e.removeClass("success").addClass("error").attr("title",o),t.removeClass("success").addClass("error").attr("title",o)),Object(p.isUnd)(i)||e.text(Object(p.trim)(i))},s.domControlEncryptedClickHelper=function(s,c,t,n){return function(){var e=null,r=u()(this);if(r.hasClass("success"))return!1;try{e=s.openpgp.message.readArmored(t)}catch(e){Object(p.log)(e)}return e&&e.getText&&e.verify&&e.decrypt?s.decryptMessage(e,n,function(e,t,n,o){if(t)if(n)s.controlsHelper(c,r,!0,Object(d.i18n)("PGP_NOTIFICATIONS/GOOD_SIGNATURE",{USER:n.user+" ("+n.id+")"}),t.getText());else if(e){var i=Object(p.isNonEmptyArray)(o)?o:null,a=i?l.a.compact(l.a.map(i,function(e){return e&&e.toHex?e.toHex():null})).join(", "):"";s.controlsHelper(c,r,!1,Object(d.i18n)("PGP_NOTIFICATIONS/UNVERIFIRED_SIGNATURE")+(a?" ("+a+")":""),t.getText())}else s.controlsHelper(c,r,!1,Object(d.i18n)("PGP_NOTIFICATIONS/DECRYPTION_ERROR"));else s.controlsHelper(c,r,!1,Object(d.i18n)("PGP_NOTIFICATIONS/DECRYPTION_ERROR"))}):s.controlsHelper(c,r,!1,Object(d.i18n)("PGP_NOTIFICATIONS/DECRYPTION_ERROR")),!1}},s.domControlSignedClickHelper=function(r,s,e){return function(){var i=null,a=u()(this);if(a.hasClass("success")||a.hasClass("error"))return!1;try{i=r.openpgp.cleartext.readArmored(e)}catch(e){Object(p.log)(e)}return i&&i.getText&&i.verify?r.verifyMessage(i,function(e,t){if(e)r.controlsHelper(s,a,!0,Object(d.i18n)("PGP_NOTIFICATIONS/GOOD_SIGNATURE",{USER:e.user+" ("+e.id+")"}),i.getText());else{var n=Object(p.isNonEmptyArray)(t)?t:null,o=n?l.a.compact(l.a.map(n,function(e){return e&&e.toHex?e.toHex():null})).join(", "):"";r.controlsHelper(s,a,!1,Object(d.i18n)("PGP_NOTIFICATIONS/UNVERIFIRED_SIGNATURE")+(o?" ("+o+")":""))}}):r.controlsHelper(s,a,!1,Object(d.i18n)("PGP_NOTIFICATIONS/DECRYPTION_ERROR")),!1}},s.prototype.initMessageBodyControls=function(e,t){if(e&&!e.hasClass("inited")){e.addClass("inited");var n=e.hasClass("encrypted"),o=e.hasClass("signed"),i=t?t.getEmails(["from","to","cc"]):[],a=null;if(n||o){var r=e.text();e.data("openpgp-original",r),n?a=u()('<div class="b-openpgp-control"><i class="icon-lock"></i></div>').attr("title",Object(d.i18n)("MESSAGE/PGP_ENCRYPTED_MESSAGE_DESC")).on("click",s.domControlEncryptedClickHelper(this,e,r,i)):o&&(a=u()('<div class="b-openpgp-control"><i class="icon-lock"></i></div>').attr("title",Object(d.i18n)("MESSAGE/PGP_SIGNED_MESSAGE_DESC")).on("click",s.domControlSignedClickHelper(this,e,r))),a&&e.before(a).before("<div></div>")}}},s}();t.a=new f},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(1),r=n(4),s=n.n(r),c=n(0),l=n(5),u=function(){function e(){i()(this,e),this.email=a.a.observable(""),this.parentEmail=a.a.observable(""),this.signature=a.a.observable(""),this.accounts=a.a.observableArray([]),this.accounts.loading=a.a.observable(!1).extend({throttle:c.Magics.Time100ms}),this.computers()}return e.prototype.computers=function(){var e=this;this.accountsEmails=a.a.computed(function(){return s.a.compact(s.a.map(e.accounts(),function(e){return e?e.email:null}))}),this.accountsUnreadCount=a.a.computed(function(){return 0})},e.prototype.populate=function(){this.email(l.settingsGet("Email")),this.parentEmail(l.settingsGet("ParentEmail"))},e.prototype.isRootAccount=function(){return""===this.parentEmail()},e}();t.a=new u},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(1),r=n(2),s=n(5),c=function(){function e(){i()(this,e),this.languages=a.a.observableArray([]),this.languagesAdmin=a.a.observableArray([]),this.language=a.a.observable("").extend({limitedList:this.languages}).extend({reversible:!0}),this.languageAdmin=a.a.observable("").extend({limitedList:this.languagesAdmin}).extend({reversible:!0}),this.userLanguage=a.a.observable(""),this.userLanguageAdmin=a.a.observable("")}return e.prototype.populate=function(){var e=s.appSettingsGet("languages"),t=s.appSettingsGet("languagesAdmin");this.languages(Object(r.isArray)(e)?e:[]),this.languagesAdmin(Object(r.isArray)(t)?t:[]),this.language(s.settingsGet("Language")),this.languageAdmin(s.settingsGet("LanguageAdmin")),this.userLanguage(s.settingsGet("UserLanguage")),this.userLanguageAdmin(s.settingsGet("UserLanguageAdmin"))},e}();t.a=new c},function(e,t,n){"use strict";var o=n(4),i=n.n(o),a=n(8),r=n.n(a),s=n(3),c=n.n(s),l=n(121),u=n.n(l),d=n(2),p=n(23),h=function(){function e(){r()(this,e)}return e.prototype.set=function(e,t){var n=!1,o=null;try{o=u.a.getJSON(p.b)}catch(e){}(o||(o={}))[e]=t;try{u.a.set(p.b,o,{expires:30}),n=!0}catch(e){}return n},e.prototype.get=function(e){var t=null;try{var n=u.a.getJSON(p.b);t=n&&!Object(d.isUnd)(n[e])?n[e]:null}catch(e){}return t},e.supported=function(){return!(!c.a.navigator||!c.a.navigator.cookieEnabled)},e}(),f=n(68),m=function(){function e(){r()(this,e),this.s=null,this.s=c.a.localStorage||null}return e.prototype.set=function(e,t){if(!this.s)return!1;var n=null;try{var o=this.s.getItem(p.b)||null;n=null===o?null:c.a.JSON.parse(o)}catch(e){}(n||(n={}))[e]=t;try{return this.s.setItem(p.b,c.a.JSON.stringify(n)),!0}catch(e){}return!1},e.prototype.get=function(e){if(!this.s)return null;try{var t=this.s.getItem(p.b)||null,n=null===t?null:c.a.JSON.parse(t);return n&&!Object(d.isUnd)(n[e])?n[e]:null}catch(e){}return null},e.supported=function(){return Object(f.d)("localStorage")},e}();n.d(t,"b",function(){return y}),n.d(t,"a",function(){return v});var b=i.a.find([m,h],function(e){return e&&e.supported()}),g=b?new b:null;function y(e,t){return!!g&&g.set("p"+e,t)}function v(e){return g?g.get("p"+e):null}},function(e,t,n){"use strict";n.r(t),n.d(t,"momentNow",function(){return b}),n.d(t,"momentNowUnix",function(){return g}),n.d(t,"searchSubtractFormatDateHelper",function(){return y}),n.d(t,"format",function(){return v}),n.d(t,"momentToNode",function(){return S}),n.d(t,"reload",function(){return O});var o=n(3),i=n.n(o),a=n(4),r=n.n(a),s=n(7),c=n.n(s),l=n(54),u=n.n(l),d=n(10),p=null,h=0,f=r.a.debounce(function(){p=u()()},500,!0),m=r.a.debounce(function(){h=u()().unix()},500,!0);function b(){return f(),p||u()()}function g(){return m(),h||0}function y(e){return b().clone().subtract(e,"days").format("YYYY.MM.DD")}function v(e,t){var n=null,o="",i=g();if((n=0<(e=i<(e=0<e?e:0===e?i:0)?i:e)?u.a.unix(e):null)&&1970===n.year()&&(n=null),n)switch(t){case"FROMNOW":o=n.fromNow();break;case"SHORT":o=function(e){var t=b();if(e&&t)switch(!0){case t.diff(e,"hours")<=4:return e.fromNow();case t.format("L")===e.format("L"):return Object(d.i18n)("MESSAGE_LIST/TODAY_AT",{TIME:e.format("LT")});case t.clone().subtract(1,"days").format("L")===e.format("L"):return Object(d.i18n)("MESSAGE_LIST/YESTERDAY_AT",{TIME:e.format("LT")});case t.year()===e.year():return e.format("D MMM.")}return e?e.format("LL"):""}(n);break;case"FULL":o=n.format("LLL");break;default:o=n.format(t)}return o}function S(e){var t,n="",o=c()(e);(t=o.data("moment-time"))&&((n=o.data("moment-format"))&&o.text(v(t,n)),(n=o.data("moment-format-title"))&&o.attr("title",v(t,n)))}function O(){r.a.defer(function(){c()(".moment",i.a.document).each(function(e,t){S(t)})})}},function(e,t){e.exports=window.hasher},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(8),i=n.n(o),a=n(2),r=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";i()(this,t),this.sModelName="",this.disposables=[],this.sModelName=e||""}return t.prototype.regDisposables=function(e){var t=this;Object(a.isArray)(e)?e.forEach(function(e){t.disposables.push(e)}):e&&this.disposables.push(e)},t.prototype.onDestroy=function(){Object(a.disposeObject)(this)},t}()},,function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},,function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(1),r=n(2),s=n(5),c=function(){function e(){i()(this,e),this.themes=a.a.observableArray([]),this.themeBackgroundName=a.a.observable(""),this.themeBackgroundHash=a.a.observable(""),this.theme=a.a.observable("").extend({limitedList:this.themes})}return e.prototype.populate=function(){var e=s.appSettingsGet("themes");this.themes(Object(r.isArray)(e)?e:[]),this.theme(s.settingsGet("Theme")),this.themeBackgroundName(s.settingsGet("UserBackgroundName")),this.themeBackgroundHash(s.settingsGet("UserBackgroundHash"))},e}();t.a=new c},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){e.exports=!n(53)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var o=n(104),i=n(70);e.exports=function(e){return o(i(e))}},function(e,t,n){"use strict";n.r(t),n.d(t,"EmailModel",function(){return u}),n.d(t,"default",function(){return u});var o=n(8),a=n.n(o),i=n(4),r=n.n(i),s=n(77),c=n.n(s),l=n(2),u=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"none",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";a()(this,i),this.email="",this.name="",this.dkimStatus="",this.dkimValue="",this.email=e,this.name=t,this.dkimStatus=n,this.dkimValue=o,this.clearDuplicateName()}return i.newInstanceFromJson=function(e){var t=new i;return t.initByJson(e)?t:null},i.prototype.clear=function(){this.email="",this.name="",this.dkimStatus="none",this.dkimValue=""},i.prototype.validate=function(){return""!==this.name||""!==this.email},i.prototype.hash=function(){return"#"+(0<arguments.length&&void 0!==arguments[0]&&arguments[0]?"":this.name)+"#"+this.email+"#"},i.prototype.clearDuplicateName=function(){this.name===this.email&&(this.name="")},i.prototype.search=function(e){return-1<(this.name+" "+this.email).toLowerCase().indexOf(e.toLowerCase())},i.prototype.initByJson=function(e){var t=!1;return e&&"Object/Email"===e["@Object"]&&(this.name=Object(l.trim)(e.Name),this.email=Object(l.trim)(e.Email),this.dkimStatus=Object(l.trim)(e.DkimStatus||""),this.dkimValue=Object(l.trim)(e.DkimValue||""),t=""!==this.email,this.clearDuplicateName()),t},i.prototype.toLine=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o="";return""!==this.email&&(e&&""!==this.name?o=t?'<a href="mailto:'+Object(l.encodeHtml)(this.email)+"?to="+Object(l.encodeHtml)('"'+this.name+'" <'+this.email+">")+'" target="_blank" tabindex="-1">'+Object(l.encodeHtml)(this.name)+"</a>":n?Object(l.encodeHtml)(this.name):this.name:(o=this.email,""!==this.name?t?o=Object(l.encodeHtml)('"'+this.name+'" <')+'<a href="mailto:'+Object(l.encodeHtml)(this.email)+"?to="+Object(l.encodeHtml)('"'+this.name+'" <'+this.email+">")+'" target="_blank" tabindex="-1">'+Object(l.encodeHtml)(o)+"</a>"+Object(l.encodeHtml)(">"):(o='"'+this.name+'" <'+o+">",n&&(o=Object(l.encodeHtml)(o))):t&&(o='<a href="mailto:'+Object(l.encodeHtml)(this.email)+'" target="_blank" tabindex="-1">'+Object(l.encodeHtml)(this.email)+"</a>"))),o},i.splitEmailLine=function(e){var t=c()(e);if(Object(l.isNonEmptyArray)(t)){var n=[],o=!1;return t.forEach(function(e){var t=e.address?new i(e.address.replace(/^[<]+(.*)[>]+$/g,"$1"),e.name||""):null;t&&t.email&&(o=!0),n.push(t?t.toLine(!1):e.name)}),o?n:null}return null},i.parseEmailLine=function(e){var t=c()(e);return Object(l.isNonEmptyArray)(t)?r.a.compact(t.map(function(e){return e.address?new i(e.address.replace(/^[<]+(.*)[>]+$/g,"$1"),e.name||""):null})):[]},i.prototype.parse=function(e){if(""===(e=Object(l.trim)(e)))return!1;var t=c()(e);return!(!Object(l.isNonEmptyArray)(t)||!t[0]||(this.name=t[0].name||"",this.email=t[0].address||"",this.clearDuplicateName(),0))},i}()},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(3),r=n.n(a),s=n(6),c=n(16),l=n(22),u=n(2),d=function(){function n(){var e=this;if(i()(this,n),this.notificator=null,this.player=null,this.supported=!1,this.supportedMp3=!1,this.supportedOgg=!1,this.supportedWav=!1,this.supportedNotification=!1,this.player=this.createNewObject(),this.supported=!(s.bMobileDevice||s.bSafari||!this.player||!this.player.play),this.supported&&this.player&&this.player.canPlayType&&(this.supportedMp3=""!==this.player.canPlayType("audio/mpeg;").replace(/no/,""),this.supportedWav=""!==this.player.canPlayType('audio/wav; codecs="1"').replace(/no/,""),this.supportedOgg=""!==this.player.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,""),this.supportedNotification=this.supported&&this.supportedMp3),this.player&&(this.supportedMp3||this.supportedOgg||this.supportedWav)||(this.supported=!1,this.supportedMp3=!1,this.supportedOgg=!1,this.supportedWav=!1,this.supportedNotification=!1),this.supported&&this.player){var t=function(){return e.stop()};this.player.addEventListener("ended",t),this.player.addEventListener("error",t),l.b("audio.api.stop",t)}}return n.prototype.createNewObject=function(){var e=r.a.Audio?new r.a.Audio:null;return e&&e.canPlayType&&e.pause&&e.play&&(e.preload="none",e.loop=!1,e.autoplay=!1,e.muted=!1),e},n.prototype.paused=function(){return!this.supported||!!this.player.paused},n.prototype.stop=function(){this.supported&&this.player.pause&&this.player.pause(),l.a("audio.stop")},n.prototype.pause=function(){this.stop()},n.prototype.clearName=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return e=Object(u.trim)(e),t&&"."+t===e.toLowerCase().substr(-1*(t.length+1))&&(e=Object(u.trim)(e.substr(0,e.length-4))),""===e?"audio":e},n.prototype.playMp3=function(e,t){this.supported&&this.supportedMp3&&(this.player.src=e,this.player.play(),l.a("audio.start",[this.clearName(t,"mp3"),"mp3"]))},n.prototype.playOgg=function(e,t){this.supported&&this.supportedOgg&&(this.player.src=e,this.player.play(),t=this.clearName(t,"oga"),t=this.clearName(t,"ogg"),l.a("audio.start",[t,"ogg"]))},n.prototype.playWav=function(e,t){this.supported&&this.supportedWav&&(this.player.src=e,this.player.play(),l.a("audio.start",[this.clearName(t,"wav"),"wav"]))},n.prototype.playNotification=function(){this.supported&&this.supportedMp3&&(this.notificator||(this.notificator=this.createNewObject(),this.notificator.src=c.D("new-mail.mp3")),this.notificator&&this.notificator.play&&this.notificator.play())},n}();t.a=new d},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(1),u=n(2),d=n(0),p=function(n){function o(e){i()(this,o);var t=r()(this,n.call(this));return t.value=e.value||"",t.size=e.size||0,t.label=e.label||"",t.preLabel=e.preLabel||"",t.enable=!!Object(u.isUnd)(e.enable)||e.enable,t.trigger=e.trigger&&e.trigger.subscribe?e.trigger:null,t.placeholder=e.placeholder||"",t.labeled=!Object(u.isUnd)(e.label),t.preLabeled=!Object(u.isUnd)(e.preLabel),t.triggered=!Object(u.isUnd)(e.trigger)&&!!t.trigger,t.classForTrigger=l.a.observable(""),t.className=l.a.computed(function(){var e=l.a.unwrap(t.size);return(0<e?"span"+e:"")+(t.trigger?" "+Object(u.trim)("settings-saved-trigger-input "+t.classForTrigger()):"")}),!Object(u.isUnd)(e.width)&&e.element&&e.element.find("input,select,textarea").css("width",e.width),t.disposable.push(t.className),t.trigger&&(t.setTriggerState(t.trigger()),t.disposable.push(t.trigger.subscribe(t.setTriggerState,t))),t}return c()(o,n),o.prototype.setTriggerState=function(e){switch(Object(u.pInt)(e)){case d.SaveSettingsStep.TrueResult:this.classForTrigger("success");break;case d.SaveSettingsStep.FalseResult:this.classForTrigger("error");break;default:this.classForTrigger("")}},o}(n(27).a)},,function(e,t,n){var o=n(60),i=n(78),a=n(67),r=Object.defineProperty;t.f=n(42)?Object.defineProperty:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return r(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(3),p=n.n(l),u=n(4),d=n.n(u),h=n(23),f=n(2),m=n(0),b=n(15),g=n(5),y=n(33),v=n(26),S=n(13),O=n(17),w=n(1),T=n(10),C=n(22),A=function(t){function n(){i()(this,n);var e=r()(this,t.call(this,"FolderModel"));return e.name=w.a.observable(""),e.fullName="",e.fullNameRaw="",e.fullNameHash="",e.delimiter="",e.namespace="",e.deep=0,e.interval=0,e.selectable=!1,e.existen=!0,e.type=w.a.observable(m.FolderType.User),e.focused=w.a.observable(!1),e.selected=w.a.observable(!1),e.edited=w.a.observable(!1),e.subScribed=w.a.observable(!0),e.checkable=w.a.observable(!1),e.subFolders=w.a.observableArray([]),e.deleteAccess=w.a.observable(!1),e.actionBlink=w.a.observable(!1).extend({falseTimeout:1e3}),e.nameForEdit=w.a.observable(""),e.privateMessageCountAll=w.a.observable(0),e.privateMessageCountUnread=w.a.observable(0),e.collapsedPrivate=w.a.observable(!0),e}return c()(n,t),n.newInstanceFromJson=function(e){var t=new n;return t.initByJson(e)?t.initComputed():null},n.prototype.initComputed=function(){var o=this,e=Object(b.h)();return this.isInbox=w.a.computed(function(){return m.FolderType.Inbox===o.type()}),this.hasSubScribedSubfolders=w.a.computed(function(){return!!d.a.find(o.subFolders(),function(e){return(e.subScribed()||e.hasSubScribedSubfolders())&&!e.isSystemFolder()})}),this.canBeEdited=w.a.computed(function(){return m.FolderType.User===o.type()&&o.existen&&o.selectable}),this.visible=w.a.computed(function(){var e=o.subScribed(),t=o.hasSubScribedSubfolders();return e||t&&(!o.existen||!o.selectable)}),this.isSystemFolder=w.a.computed(function(){return m.FolderType.User!==o.type()}),this.hidden=w.a.computed(function(){var e=o.isSystemFolder(),t=o.hasSubScribedSubfolders();return e&&!t||!o.selectable&&!t}),this.selectableForFolderList=w.a.computed(function(){return!o.isSystemFolder()&&o.selectable}),this.messageCountAll=w.a.computed({read:this.privateMessageCountAll,write:function(e){Object(f.isPosNumeric)(e,!0)?o.privateMessageCountAll(e):o.privateMessageCountAll.valueHasMutated()}}).extend({notify:"always"}),this.messageCountUnread=w.a.computed({read:this.privateMessageCountUnread,write:function(e){Object(f.isPosNumeric)(e,!0)?o.privateMessageCountUnread(e):o.privateMessageCountUnread.valueHasMutated()}}).extend({notify:"always"}),this.printableUnreadCount=w.a.computed(function(){var e=o.messageCountAll(),t=o.messageCountUnread(),n=o.type();if(0<e){if(m.FolderType.Draft===n)return""+e;if(0<t&&m.FolderType.Trash!==n&&m.FolderType.Archive!==n&&m.FolderType.SentItems!==n)return""+t}return""}),this.canBeDeleted=w.a.computed(function(){return!o.isSystemFolder()&&0===o.subFolders().length&&e!==o.fullNameRaw}),this.canBeSubScribed=w.a.computed(function(){return!o.isSystemFolder()&&o.selectable&&e!==o.fullNameRaw}),this.canBeChecked=this.canBeSubScribed,this.localName=w.a.computed(function(){Object(T.trigger)();var e=o.name(),t=o.type();if(o.isSystemFolder())switch(t){case m.FolderType.Inbox:e=Object(T.i18n)("FOLDER_LIST/INBOX_NAME");break;case m.FolderType.SentItems:e=Object(T.i18n)("FOLDER_LIST/SENT_NAME");break;case m.FolderType.Draft:e=Object(T.i18n)("FOLDER_LIST/DRAFTS_NAME");break;case m.FolderType.Spam:e=Object(T.i18n)("FOLDER_LIST/SPAM_NAME");break;case m.FolderType.Trash:e=Object(T.i18n)("FOLDER_LIST/TRASH_NAME");break;case m.FolderType.Archive:e=Object(T.i18n)("FOLDER_LIST/ARCHIVE_NAME")}return e}),this.manageFolderSystemName=w.a.computed(function(){Object(T.trigger)();var e="",t=o.type(),n=o.name();if(o.isSystemFolder())switch(t){case m.FolderType.Inbox:e="("+Object(T.i18n)("FOLDER_LIST/INBOX_NAME")+")";break;case m.FolderType.SentItems:e="("+Object(T.i18n)("FOLDER_LIST/SENT_NAME")+")";break;case m.FolderType.Draft:e="("+Object(T.i18n)("FOLDER_LIST/DRAFTS_NAME")+")";break;case m.FolderType.Spam:e="("+Object(T.i18n)("FOLDER_LIST/SPAM_NAME")+")";break;case m.FolderType.Trash:e="("+Object(T.i18n)("FOLDER_LIST/TRASH_NAME")+")";break;case m.FolderType.Archive:e="("+Object(T.i18n)("FOLDER_LIST/ARCHIVE_NAME")+")"}return(""!==e&&"("+n+")"===e||"(inbox)"===e.toLowerCase())&&(e=""),e}),this.collapsed=w.a.computed({read:function(){return!o.hidden()&&o.collapsedPrivate()},write:function(e){o.collapsedPrivate(e)}}),this.hasUnreadMessages=w.a.computed(function(){return 0<o.messageCountUnread()&&""!==o.printableUnreadCount()}),this.hasSubScribedUnreadMessagesSubfolders=w.a.computed(function(){return!!d.a.find(o.subFolders(),function(e){return e.hasUnreadMessages()||e.hasSubScribedUnreadMessagesSubfolders()})}),this.name.subscribe(function(e){o.nameForEdit(e)}),this.edited.subscribe(function(e){e&&o.nameForEdit(o.name())}),this.messageCountUnread.subscribe(function(e){m.FolderType.Inbox===o.type()&&C.a("mailbox.inbox-unread-count",[e])}),this},n.prototype.collapsedCss=function(){return this.hasSubScribedSubfolders()?this.collapsed()?"icon-right-mini e-collapsed-sign":"icon-down-mini e-collapsed-sign":"icon-none e-collapsed-sign"},n.prototype.initByJson=function(e){var t=!1,n=Object(b.h)();return e&&"Object/Folder"===e["@Object"]&&(this.name(e.Name),this.delimiter=e.Delimiter,this.fullName=e.FullName,this.fullNameRaw=e.FullNameRaw,this.fullNameHash=e.FullNameHash,this.deep=e.FullNameRaw.split(this.delimiter).length-1,this.selectable=!!e.IsSelectable,this.existen=!!e.IsExists,this.subScribed(!!e.IsSubscribed),this.checkable(!!e.Checkable),this.type(n===this.fullNameRaw?m.FolderType.Inbox:m.FolderType.User),t=!0),t},n.prototype.printableFullName=function(){return this.fullName.split(this.delimiter).join(" / ")},n}(n(36).a),E=function(){function e(){i()(this,e),this.oPromisesStack={}}return e.prototype.func=function(e){return e(),this},e.prototype.fastResolve=function(e){return p.a.Promise.resolve(e)},e.prototype.fastReject=function(e){return p.a.Promise.reject(e)},e.prototype.setTrigger=function(e,t){e&&(t=!!t,(Object(f.isArray)(e)?e:[e]).forEach(function(e){e&&e(t)}))},e}(),F=new(function(e){function t(){return i()(this,t),r()(this,e.apply(this,arguments))}return c()(t,e),t.prototype.isFolderExpanded=function(e,t){return t&&Object(f.isArray)(t)&&-1!==d.a.indexOf(t,e)},t.prototype.normalizeFolder=function(e){return""===e||h.r===e||null!==b.e(e)?e:""},t.prototype.folderResponseParseRec=function(n,e,o){var i=this,a=S.a.displaySpecSetting(),r=[];return d.a.each(e,function(e){if(e){var t=b.e(e.FullNameRaw);t||(t=A.newInstanceFromJson(e))&&(b.r(e.FullNameRaw,t),b.p(t.fullNameHash,e.FullNameRaw,t)),t&&(a?t.checkable(!!e.Checkable):t.checkable(!0),t.collapsed(!i.isFolderExpanded(t.fullNameHash,o)),e.Extended&&(e.Extended.Hash&&b.q(t.fullNameRaw,e.Extended.Hash),Object(f.isNormal)(e.Extended.MessageCount)&&t.messageCountAll(e.Extended.MessageCount),Object(f.isNormal)(e.Extended.MessageUnseenCount)&&t.messageCountUnread(e.Extended.MessageUnseenCount)),e.SubFolders&&"Collection/FolderCollection"===e.SubFolders["@Object"]&&e.SubFolders["@Collection"]&&Object(f.isArray)(e.SubFolders["@Collection"])&&t.subFolders(i.folderResponseParseRec(n,e.SubFolders["@Collection"],o)),r.push(t))}}),r},t.prototype.foldersList=function(e){if(e&&"Collection/FolderCollection"===e["@Object"]&&e["@Collection"]&&Object(f.isArray)(e["@Collection"])){var t=y.a(m.ClientSideKeyName.ExpandedFolders),n=Object(f.pInt)(e.CountRec),o=Object(f.pInt)(g.appSettingsGet("folderSpecLimit"));o=100<o?100:o<10?10:o,S.a.displaySpecSetting(n<=0||o<n),S.a.folderList(this.folderResponseParseRec(Object(f.isUnd)(e.Namespace)?"":e.Namespace,e["@Collection"],t))}},t.prototype.foldersAdditionalParameters=function(e){if(e&&e&&"Collection/FolderCollection"===e["@Object"]&&e["@Collection"]&&Object(f.isArray)(e["@Collection"])){Object(f.isUnd)(e.Namespace)||(S.a.namespace=e.Namespace),v.a.threadsAllowed(!!g.appSettingsGet("useImapThread")&&e.IsThreadsSupported&&!0),S.a.folderList.optimized(!!e.Optimized);var t=!1;e.SystemFolders&&""==""+g.settingsGet("SentFolder")+g.settingsGet("DraftFolder")+g.settingsGet("SpamFolder")+g.settingsGet("TrashFolder")+g.settingsGet("ArchiveFolder")+g.settingsGet("NullFolder")&&(g.settingsSet("SentFolder",e.SystemFolders[m.ServerFolderType.SENT]||null),g.settingsSet("DraftFolder",e.SystemFolders[m.ServerFolderType.DRAFTS]||null),g.settingsSet("SpamFolder",e.SystemFolders[m.ServerFolderType.JUNK]||null),g.settingsSet("TrashFolder",e.SystemFolders[m.ServerFolderType.TRASH]||null),g.settingsSet("ArchiveFolder",e.SystemFolders[m.ServerFolderType.ALL]||null),t=!0),S.a.sentFolder(this.normalizeFolder(g.settingsGet("SentFolder"))),S.a.draftFolder(this.normalizeFolder(g.settingsGet("DraftFolder"))),S.a.spamFolder(this.normalizeFolder(g.settingsGet("SpamFolder"))),S.a.trashFolder(this.normalizeFolder(g.settingsGet("TrashFolder"))),S.a.archiveFolder(this.normalizeFolder(g.settingsGet("ArchiveFolder"))),t&&O.a.saveSystemFolders(f.noop,{SentFolder:S.a.sentFolder(),DraftFolder:S.a.draftFolder(),SpamFolder:S.a.spamFolder(),TrashFolder:S.a.trashFolder(),ArchiveFolder:S.a.archiveFolder(),NullFolder:"NullFolder"}),y.b(m.ClientSideKeyName.FoldersLashHash,e.FoldersHash)}},t}(E)),j=n(7),N=n.n(j),R=n(16),I=n(6),L=n(29),_=function(t){function n(){i()(this,n);var e=r()(this,t.call(this));return e.foldersTimeout=0,e}return c()(n,t),n.prototype.foldersReload=function(e){return this.abort("Folders").postRequest("Folders",e).then(function(e){return F.foldersList(e.Result),F.foldersAdditionalParameters(e.Result),!0})},n.prototype.foldersReloadWithTimeout=function(e){var t=this;this.setTrigger(e,!0),p.a.clearTimeout(this.foldersTimeout),this.foldersTimeout=p.a.setTimeout(function(){t.foldersReload(e)},500)},n.prototype.folderDelete=function(e,t){return this.postRequest("FolderDelete",t,{Folder:e})},n.prototype.folderCreate=function(e,t,n){return this.postRequest("FolderCreate",n,{Folder:e,Parent:t})},n.prototype.folderRename=function(e,t,n){return this.postRequest("FolderRename",n,{Folder:e,NewFolderName:t})},n.prototype.attachmentsActions=function(e,t,n){return this.postRequest("AttachmentsActions",n,{Do:e,Hashes:t})},n.prototype.welcomeClose=function(){return this.postRequest("WelcomeClose")},n}(function(t){function n(){i()(this,n);var e=r()(this,t.call(this));return e.oRequests={},e.clear(),e}return c()(n,t),n.prototype.clear=function(){this.oRequests={}},n.prototype.abort=function(e,t){return this.oRequests[e]&&(!t&&this.oRequests[e].abort&&(this.oRequests[e].__aborted__=!0,this.oRequests[e].abort()),this.oRequests[e]=null,delete this.oRequests[e]),this},n.prototype.ajaxRequest=function(c,t,n,l,o,u){var d=this;return new p.a.Promise(function(a,r){var s=Object(f.microtime)();n=Object(f.isNormal)(n)?n:h.g,o=Object(f.isUnd)(o)?"":Object(f.pString)(o),t&&(l.XToken=g.appSettingsGet("token")),L.f("ajax-default-request",[c,l,o]),d.setTrigger(u,!0);var e=N.a.ajax({type:t?"POST":"GET",url:Object(R.a)(o),async:!0,dataType:"json",data:t&&l||{},timeout:n,global:!0}).always(function(e,t){var n=!1,o=null;e&&e.Time&&(n=Object(f.pInt)(e.Time)>Object(f.microtime)()-s);var i="";switch(!0){case"success"===t&&e&&e.Result&&c===e.Action:i=m.StorageResultType.Success;break;case!("abort"!==t||e&&e.__aborted__):i=m.StorageResultType.Abort;break;default:i=m.StorageResultType.Error}L.f("ajax-default-response",[c,m.StorageResultType.Success===i?e:null,i,n,l]),"success"===t?e&&e.Result&&c===e.Action?(e.__cached__=n,a(e)):e&&e.Action?r((o=e).ErrorCode?e.ErrorCode:m.Notification.AjaxFalse):(o=e,r(m.Notification.AjaxParse)):"timeout"===t?(o=e,r(m.Notification.AjaxTimeout)):"abort"===t?e&&e.__aborted__||r(m.Notification.AjaxAbort):(o=e,r(m.Notification.AjaxParse)),d.oRequests[c]&&(d.oRequests[c]=null,delete d.oRequests[c]),d.setTrigger(u,!1),o&&(-1<Object(f.inArray)(o.ErrorCode,[m.Notification.AuthError,m.Notification.AccessError,m.Notification.ConnectionError,m.Notification.DomainNotAllowed,m.Notification.AccountNotAllowed,m.Notification.MailServerError,m.Notification.UnknownNotification,m.Notification.UnknownError])&&(I.data.iAjaxErrorCount+=1),m.Notification.InvalidToken===o.ErrorCode&&(I.data.iTokenErrorCount+=1),h.q<I.data.iTokenErrorCount&&I.data.__APP__&&I.data.__APP__.loginAndLogoutReload&&I.data.__APP__.loginAndLogoutReload(!1,!0),(o.ClearAuth||o.Logout||h.a<I.data.iAjaxErrorCount)&&(I.data.__APP__&&I.data.__APP__.clearClientSideToken&&I.data.__APP__.clearClientSideToken(),I.data.__APP__&&!o.ClearAuth&&I.data.__APP__.loginAndLogoutReload&&I.data.__APP__.loginAndLogoutReload(!1,!0)))});e&&(d.oRequests[c]&&(d.oRequests[c]=null,delete d.oRequests[c]),d.oRequests[c]=e)})},n.prototype.getRequest=function(e,t,n,o){return n=e+"/"+(n=Object(f.isUnd)(n)?"":Object(f.pString)(n)),this.ajaxRequest(e,!1,o,null,n,t)},n.prototype.postRequest=function(e,t,n,o){return(n=n||{}).Action=e,this.ajaxRequest(e,!0,o,n,"",t)},n}(E));t.a=new _},function(e,t,n){var o=n(50),i=n(63);e.exports=n(42)?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=window.moment},function(e,t){e.exports=window.progressJs},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(4),r=n.n(a),s=n(1);t.a=new function e(){var t=this;i()(this,e),this.identities=s.a.observableArray([]),this.identities.loading=s.a.observable(!1).extend({throttle:100}),this.identitiesIDS=s.a.computed(function(){return r.a.compact(r.a.map(t.identities(),function(e){return e?e.id:null}))})}},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(1),r=n(0),s=n(5),c=function(){function e(){i()(this,e),this.contacts=a.a.observableArray([]),this.contacts.loading=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.contacts.importing=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.contacts.syncing=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.contacts.exportingVcf=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.contacts.exportingCsv=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.allowContactsSync=a.a.observable(!1),this.enableContactsSync=a.a.observable(!1),this.contactsSyncUrl=a.a.observable(""),this.contactsSyncUser=a.a.observable(""),this.contactsSyncPass=a.a.observable("")}return e.prototype.populate=function(){this.allowContactsSync(!!s.settingsGet("ContactsSyncIsAllowed")),this.enableContactsSync(!!s.settingsGet("EnableContactsSync")),this.contactsSyncUrl(s.settingsGet("ContactsSyncUrl")),this.contactsSyncUser(s.settingsGet("ContactsSyncUser")),this.contactsSyncPass(s.settingsGet("ContactsSyncPassword"))},e}();t.a=new c},function(e,t,n){var m=n(41),b=n(38),g=n(81),y=n(52),v=n(43),S=function(e,t,n){var o,i,a,r=e&S.F,s=e&S.G,c=e&S.S,l=e&S.P,u=e&S.B,d=e&S.W,p=s?b:b[t]||(b[t]={}),h=p.prototype,f=s?m:c?m[t]:(m[t]||{}).prototype;for(o in s&&(n=t),n)(i=!r&&f&&void 0!==f[o])&&v(p,o)||(a=i?f[o]:n[o],p[o]=s&&"function"!=typeof f[o]?n[o]:u&&i?g(a,m):d&&f[o]==a?function(o){var e=function(e,t,n){if(this instanceof o){switch(arguments.length){case 0:return new o;case 1:return new o(e);case 2:return new o(e,t)}return new o(e,t,n)}return o.apply(this,arguments)};return e.prototype=o.prototype,e}(a):l&&"function"==typeof a?g(Function.call,a):a,l&&((p.virtual||(p.virtual={}))[o]=a,e&S.R&&h&&!h[o]&&y(h,o,a)))};S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128,e.exports=S},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(3),a=n.n(o);function i(o){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!a.a.Promise||!a.a.Promise.all)throw new Error("Promises are not available your environment.");if(!o)throw new Error("src should not be empty.");return new a.a.Promise(function(e,t){var n=a.a.document.createElement("script");n.onload=function(){e(o)},n.onerror=function(){t(new Error(o))},n.async=!0===i,n.src=o,a.a.document.body.appendChild(n)})}},function(e,t,n){var o=n(47);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var o=n(89)("wks"),i=n(74),a=n(41).Symbol,r="function"==typeof a;(e.exports=function(e){return o[e]||(o[e]=r&&a[e]||(r?a:i)("Symbol."+e))}).store=o},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(3),s=n.n(a),r=n(1),c=n(0),l=n(22),u=n(46),d=n(5),p=function(){function e(){var o=this;i()(this,e),this.enableSoundNotification=r.a.observable(!1),this.soundNotificationIsSupported=r.a.observable(!1),this.allowDesktopNotification=r.a.observable(!1),this.desktopNotificationPermissions=r.a.computed(function(){o.allowDesktopNotification();var e=c.DesktopNotification.NotSupported,t=o.notificationClass();if(t&&t.permission)switch(t.permission.toLowerCase()){case"granted":e=c.DesktopNotification.Allowed;break;case"denied":e=c.DesktopNotification.Denied;break;case"default":e=c.DesktopNotification.NotAllowed}else s.a.webkitNotifications&&s.a.webkitNotifications.checkPermission&&(e=s.a.webkitNotifications.checkPermission());return e}).extend({notify:"always"}),this.enableDesktopNotification=r.a.computed({read:function(){return o.allowDesktopNotification()&&c.DesktopNotification.Allowed===o.desktopNotificationPermissions()},write:function(e){if(e){var t=o.notificationClass(),n=o.desktopNotificationPermissions();t&&c.DesktopNotification.Allowed===n?o.allowDesktopNotification(!0):t&&c.DesktopNotification.NotAllowed===n?t.requestPermission(function(){o.allowDesktopNotification.valueHasMutated(),c.DesktopNotification.Allowed===o.desktopNotificationPermissions()?o.allowDesktopNotification()?o.allowDesktopNotification.valueHasMutated():o.allowDesktopNotification(!0):o.allowDesktopNotification()?o.allowDesktopNotification(!1):o.allowDesktopNotification.valueHasMutated()}):o.allowDesktopNotification(!1)}else o.allowDesktopNotification(!1)}}).extend({notify:"always"}),this.enableDesktopNotification.valueHasMutated||(this.enableDesktopNotification.valueHasMutated=function(){o.allowDesktopNotification.valueHasMutated()}),this.computers(),this.initNotificationPlayer()}return e.prototype.computers=function(){var e=this;this.isDesktopNotificationSupported=r.a.computed(function(){return c.DesktopNotification.NotSupported!==e.desktopNotificationPermissions()}),this.isDesktopNotificationDenied=r.a.computed(function(){return c.DesktopNotification.NotSupported===e.desktopNotificationPermissions()||c.DesktopNotification.Denied===e.desktopNotificationPermissions()})},e.prototype.initNotificationPlayer=function(){u.a&&u.a.supportedNotification?this.soundNotificationIsSupported(!0):(this.enableSoundNotification(!1),this.soundNotificationIsSupported(!1))},e.prototype.playSoundNotification=function(e){u.a&&u.a.supportedNotification&&(e||this.enableSoundNotification())&&u.a.playNotification()},e.prototype.displayDesktopNotification=function(e,t,n,o){if(this.enableDesktopNotification()){var i=this.notificationClass(),a=i?new i(t,{body:n,icon:e}):null;a&&(a.show&&a.show(),o&&(a.onclick=function(){s.a.focus(),o.Folder&&o.Uid&&l.a("mailbox.message.show",[o.Folder,o.Uid])}),s.a.setTimeout((r=a,function(){r.cancel?r.cancel():r.close&&r.close()}),c.Magics.Time7s))}var r},e.prototype.populate=function(){this.enableSoundNotification(!!d.settingsGet("SoundNotification")),this.enableDesktopNotification(!!d.settingsGet("DesktopNotifications"))},e.prototype.notificationClass=function(){return s.a.Notification&&s.a.Notification.requestPermission?s.a.Notification:null},e}();t.a=new p},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,c){"use strict";c.r(t);var n,o,i,a,r,s,l,u,d,p,h=c(18),f=c.n(h),m=c(8),b=c.n(m),g=c(11),y=c.n(g),v=c(12),S=c.n(v),O=c(3),w=c.n(O),T=c(4),C=c.n(T),A=c(7),E=c.n(A),F=c(1),j=c(19),N=c.n(j),R=c(79),I=c.n(R),L=c(0),_=c(2),P=c(23),M=c(6),D=c(16),k=c(10),x=c(34),U=c(15),H=c(95),B=c(26),G=c(28),K=c(56),V=c(31),z=c(13),q=c(30),W=c(14),Y=c(25),$=c(17),J=c(5),X=c(22),Z=c(80),Q=function(c){function l(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"",r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"";b()(this,l);var s=y()(this,c.call(this,"ComposeAttachmentModel"));return s.id=e,s.isInline=!!o,s.isLinked=!!i,s.CID=a,s.contentLocation=r,s.fromMessage=!1,s.fileName=F.a.observable(t),s.size=F.a.observable(n),s.tempName=F.a.observable(""),s.progress=F.a.observable(0),s.error=F.a.observable(""),s.waiting=F.a.observable(!0),s.uploading=F.a.observable(!1),s.enabled=F.a.observable(!0),s.complete=F.a.observable(!1),s.progressText=F.a.computed(function(){var e=s.progress();return 0===e?"":(98<e?100:e)+"%"}),s.progressStyle=F.a.computed(function(){var e=s.progress();return 0===e?"":"width:"+(98<e?100:e)+"%"}),s.title=F.a.computed(function(){var e=s.error();return""!==e?e:s.fileName()}),s.friendlySize=F.a.computed(function(){var e=s.size();return null===e?"":Object(_.friendlySize)(e)}),s.mimeType=F.a.computed(function(){return Object(_.mimeContentType)(s.fileName())}),s.fileExt=F.a.computed(function(){return Object(_.getFileExtension)(s.fileName())}),s.regDisposables([s.progressText,s.progressStyle,s.title,s.friendlySize,s.mimeType,s.fileExt]),s}return S()(l,c),l.prototype.initByUploadJson=function(e){var t=!1;return e&&(this.fileName(e.Name),this.size(Object(_.isUnd)(e.Size)?0:Object(_.pInt)(e.Size)),this.tempName(Object(_.isUnd)(e.TempName)?"":e.TempName),t=!(this.isInline=!1)),t},l.prototype.iconClass=function(){return Object(Z.d)(Object(Z.c)(this.fileExt(),this.mimeType()))[0]},l.prototype.iconText=function(){return Object(Z.d)(Object(Z.c)(this.fileExt(),this.mimeType()))[1]},l}(c(36).a),ee=c(20),te=c(9),ne=c(24);function oe(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}c.d(t,"ComposePopupView",function(){return ie}),c.d(t,"default",function(){return ie});var ie=(n=Object(te.popup)({name:"View/Popup/Compose",templateID:"PopupsCompose"}),o=Object(te.command)(function(e){return e.canBeSentOrSaved()}),i=Object(te.command)(function(e){return e.canBeSentOrSaved()}),a=Object(te.command)(function(e){return e.isDraftFolderMessage()}),r=Object(te.command)(function(e){return e.canBeSentOrSaved()}),s=Object(te.command)(function(e){return e.allowContacts}),l=Object(te.command)(function(e){return e.dropboxEnabled()}),u=Object(te.command)(function(e){return e.driveEnabled()}),n((oe((p=function(e){function o(){b()(this,o);var t=y()(this,e.call(this)),n=function(e,t,n,o){if(t&&e&&t[n]()&&(o||e[n]())){var i=t[n](),a=Object(_.trim)(e[n]()).split(/[,]/);a=C.a.filter(a,function(e){return(e=Object(_.trim)(e))&&Object(_.trim)(i)!==e}),o&&a.push(i),e[n](a.join(","))}};return t.oLastMessage=null,t.oEditor=null,t.aDraftInfo=null,t.sInReplyTo="",t.bFromDraft=!1,t.sReferences="",t.sLastFocusedField="to",t.resizerTrigger=C.a.bind(t.resizerTrigger,t),t.allowContacts=!!B.a.contactsIsAllowed(),t.allowFolders=!!J.capa(L.Capa.Folders),t.bSkipNextHide=!1,t.composeInEdit=B.a.composeInEdit,t.editorDefaultType=G.a.editorDefaultType,t.capaOpenPGP=q.a.capaOpenPGP,t.identitiesDropdownTrigger=F.a.observable(!1),t.to=F.a.observable(""),t.to.focused=F.a.observable(!1),t.cc=F.a.observable(""),t.cc.focused=F.a.observable(!1),t.bcc=F.a.observable(""),t.bcc.focused=F.a.observable(!1),t.replyTo=F.a.observable(""),t.replyTo.focused=F.a.observable(!1),F.a.computed(function(){switch(!0){case t.to.focused():t.sLastFocusedField="to";break;case t.cc.focused():t.sLastFocusedField="cc";break;case t.bcc.focused():t.sLastFocusedField="bcc"}}).extend({notify:"always"}),t.subject=F.a.observable(""),t.subject.focused=F.a.observable(!1),t.isHtml=F.a.observable(!1),t.requestDsn=F.a.observable(!1),t.requestReadReceipt=F.a.observable(!1),t.markAsImportant=F.a.observable(!1),t.sendError=F.a.observable(!1),t.sendSuccessButSaveError=F.a.observable(!1),t.savedError=F.a.observable(!1),t.sendButtonSuccess=F.a.computed(function(){return!t.sendError()&&!t.sendSuccessButSaveError()}),t.sendErrorDesc=F.a.observable(""),t.savedErrorDesc=F.a.observable(""),t.sendError.subscribe(function(e){e||t.sendErrorDesc("")}),t.savedError.subscribe(function(e){e||t.savedErrorDesc("")}),t.sendSuccessButSaveError.subscribe(function(e){e||t.savedErrorDesc("")}),t.savedTime=F.a.observable(0),t.savedTimeText=F.a.computed(function(){return 0<t.savedTime()?Object(k.i18n)("COMPOSE/SAVED_TIME",{TIME:Object(x.format)(t.savedTime()-1,"LT")}):""}),t.emptyToError=F.a.observable(!1),t.emptyToErrorTooltip=F.a.computed(function(){return t.emptyToError()?Object(k.i18n)("COMPOSE/EMPTY_TO_ERROR_DESC"):""}),t.attachmentsInProcessError=F.a.observable(!1),t.attachmentsInErrorError=F.a.observable(!1),t.attachmentsErrorTooltip=F.a.computed(function(){var e="";switch(!0){case t.attachmentsInProcessError():e=Object(k.i18n)("COMPOSE/ATTACHMENTS_UPLOAD_ERROR_DESC");break;case t.attachmentsInErrorError():e=Object(k.i18n)("COMPOSE/ATTACHMENTS_ERROR_DESC")}return e}),t.showCc=F.a.observable(!1),t.showBcc=F.a.observable(!1),t.showReplyTo=F.a.observable(!1),t.cc.subscribe(function(e){!1===t.showCc()&&0<e.length&&t.showCc(!0)}),t.bcc.subscribe(function(e){!1===t.showBcc()&&0<e.length&&t.showBcc(!0)}),t.replyTo.subscribe(function(e){!1===t.showReplyTo()&&0<e.length&&t.showReplyTo(!0)}),t.draftFolder=F.a.observable(""),t.draftUid=F.a.observable(""),t.sending=F.a.observable(!1),t.saving=F.a.observable(!1),t.attachments=F.a.observableArray([]),t.attachmentsInProcess=t.attachments.filter(function(e){return e&&!e.complete()}),t.attachmentsInReady=t.attachments.filter(function(e){return e&&e.complete()}),t.attachmentsInError=t.attachments.filter(function(e){return e&&""!==e.error()}),t.attachmentsCount=F.a.computed(function(){return t.attachments().length}),t.attachmentsInErrorCount=F.a.computed(function(){return t.attachmentsInError().length}),t.attachmentsInProcessCount=F.a.computed(function(){return t.attachmentsInProcess().length}),t.isDraftFolderMessage=F.a.computed(function(){return""!==t.draftFolder()&&""!==t.draftUid()}),t.attachmentsPlace=F.a.observable(!1),t.attachments.subscribe(t.resizerTrigger),t.attachmentsPlace.subscribe(t.resizerTrigger),t.attachmentsInErrorCount.subscribe(function(e){0===e&&t.attachmentsInErrorError(!1)}),t.composeUploaderButton=F.a.observable(null),t.composeUploaderDropPlace=F.a.observable(null),t.dragAndDropEnabled=F.a.observable(!1),t.dragAndDropOver=F.a.observable(!1).extend({throttle:1}),t.dragAndDropVisible=F.a.observable(!1).extend({throttle:1}),t.attacheMultipleAllowed=F.a.observable(!1),t.addAttachmentEnabled=F.a.observable(!1),t.composeEditorArea=F.a.observable(null),t.identities=K.a.identities,t.identitiesOptions=F.a.computed(function(){return C.a.map(K.a.identities(),function(e){return{item:e,optValue:e.id(),optText:e.formattedName()}})}),t.currentIdentity=F.a.observable(t.identities()[0]?t.identities()[0]:null),t.currentIdentity.extend({toggleSubscribe:[t,function(e){n(t,e,"bcc"),n(t,e,"replyTo")},function(e){n(t,e,"bcc",!0),n(t,e,"replyTo",!0)}]}),t.currentIdentityView=F.a.computed(function(){var e=t.currentIdentity();return e?e.formattedName():"unknown"}),t.to.subscribe(function(e){t.emptyToError()&&0<e.length&&t.emptyToError(!1)}),t.attachmentsInProcess.subscribe(function(e){t.attachmentsInProcessError()&&Object(_.isArray)(e)&&0===e.length&&t.attachmentsInProcessError(!1)}),t.resizer=F.a.observable(!1).extend({throttle:50}),t.resizer.subscribe(function(){t.oEditor&&t.oEditor.resize()}),t.canBeSentOrSaved=F.a.computed(function(){return!t.sending()&&!t.saving()}),t.sendMessageResponse=C.a.bind(t.sendMessageResponse,t),t.saveMessageResponse=C.a.bind(t.saveMessageResponse,t),X.b("interval.2m",function(){!t.modalVisibility()||z.a.draftFolderNotEnabled()||!G.a.allowDraftAutosave()||t.isEmptyForm(!1)||t.saving()||t.sending()||t.savedError()||t.saveCommand()}),t.showCc.subscribe(t.resizerTrigger),t.showBcc.subscribe(t.resizerTrigger),t.showReplyTo.subscribe(t.resizerTrigger),t.dropboxEnabled=Y.a.dropbox.enabled,t.dropboxApiKey=Y.a.dropbox.apiKey,t.driveEnabled=F.a.observable(M.bXMLHttpRequestSupported&&!!J.settingsGet("AllowGoogleSocial")&&!!J.settingsGet("AllowGoogleSocialDrive")&&!!J.settingsGet("GoogleClientID")&&!!J.settingsGet("GoogleApiKey")),t.driveVisible=F.a.observable(!1),t.driveCallback=C.a.bind(t.driveCallback,t),t.onMessageUploadAttachments=C.a.bind(t.onMessageUploadAttachments,t),t.bDisabeCloseOnEsc=!0,t.sDefaultKeyScope=L.KeyState.Compose,t.tryToClosePopup=C.a.debounce(C.a.bind(t.tryToClosePopup,t),L.Magics.Time200ms),t.emailsSource=C.a.bind(t.emailsSource,t),t.autosaveFunction=C.a.bind(t.autosaveFunction,t),t.iTimer=0,t}return S()(o,e),o.prototype.sendCommand=function(){var e=Object(_.trim)(this.to()),t=Object(_.trim)(this.cc()),n=Object(_.trim)(this.bcc()),o=z.a.sentFolder();if(this.attachmentsInProcessError(!1),this.attachmentsInErrorError(!1),this.emptyToError(!1),0<this.attachmentsInProcess().length?(this.attachmentsInProcessError(!0),this.attachmentsPlace(!0)):0<this.attachmentsInError().length&&(this.attachmentsInErrorError(!0),this.attachmentsPlace(!0)),""===e&&""===t&&""===n&&this.emptyToError(!0),!this.emptyToError()&&!this.attachmentsInErrorError()&&!this.attachmentsInProcessError())if(G.a.replySameFolder()&&Object(_.isArray)(this.aDraftInfo)&&3===this.aDraftInfo.length&&Object(_.isNormal)(this.aDraftInfo[2])&&0<this.aDraftInfo[2].length&&(o=this.aDraftInfo[2]),this.allowFolders||(o=P.r),""===o)Object(te.showScreenPopup)(c(119),[L.SetSystemFoldersNotification.Sent]);else{if(this.sendError(!1),this.sending(!0),Object(_.isArray)(this.aDraftInfo)&&3===this.aDraftInfo.length){var i=Object(U.j)(this.aDraftInfo[2],this.aDraftInfo[1]);i&&("forward"===this.aDraftInfo[0]?i[3]=!0:i[2]=!0,Object(U.t)(this.aDraftInfo[2],this.aDraftInfo[1],i),Object(ee.a)().reloadFlagsCurrentMessageListAndMessageFromCache(),Object(U.q)(this.aDraftInfo[2],""))}o=P.r===o?"":o,Object(U.q)(this.draftFolder(),""),Object(U.q)(o,""),$.a.sendMessage(this.sendMessageResponse,this.currentIdentity()?this.currentIdentity().id():"",this.draftFolder(),this.draftUid(),o,e,this.cc(),this.bcc(),this.replyTo(),this.subject(),!!this.oEditor&&this.oEditor.isHtml(),this.oEditor?this.oEditor.getData(!0):"",this.prepearAttachmentsForSendOrSave(),this.aDraftInfo,this.sInReplyTo,this.sReferences,this.requestDsn(),this.requestReadReceipt(),this.markAsImportant())}},o.prototype.saveCommand=function(){return!!this.allowFolders&&(z.a.draftFolderNotEnabled()?Object(te.showScreenPopup)(c(119),[L.SetSystemFoldersNotification.Draft]):(this.savedError(!1),this.saving(!0),this.autosaveStart(),Object(U.q)(z.a.draftFolder(),""),$.a.saveMessage(this.saveMessageResponse,this.currentIdentity()?this.currentIdentity().id():"",this.draftFolder(),this.draftUid(),z.a.draftFolder(),this.to(),this.cc(),this.bcc(),this.replyTo(),this.subject(),!!this.oEditor&&this.oEditor.isHtml(),this.oEditor?this.oEditor.getData(!0):"",this.prepearAttachmentsForSendOrSave(),this.aDraftInfo,this.sInReplyTo,this.sReferences,this.markAsImportant())),!0)},o.prototype.deleteCommand=function(){var e=this,t=c(99);!Object(te.isPopupVisible)(t)&&this.modalVisibility()&&Object(te.showScreenPopup)(t,[Object(k.i18n)("POPUPS_ASK/DESC_WANT_DELETE_MESSAGES"),function(){e.modalVisibility()&&(Object(ee.a)().deleteMessagesFromFolderWithoutCheck(e.draftFolder(),[e.draftUid()]),Object(te.hideScreenPopup)(o))}])},o.prototype.skipCommand=function(){this.bSkipNextHide=!0,!this.modalVisibility()||this.saving()||this.sending()||z.a.draftFolderNotEnabled()||!G.a.allowDraftAutosave()||this.saveCommand(),this.tryToClosePopup()},o.prototype.contactsCommand=function(){var e=this;this.allowContacts&&(this.skipCommand(),C.a.delay(function(){Object(te.showScreenPopup)(c(181),[!0,e.sLastFocusedField])},L.Magics.Time200ms))},o.prototype.dropboxCommand=function(){var t=this;return w.a.Dropbox&&w.a.Dropbox.choose({success:function(e){e&&e[0]&&e[0].link&&t.addDropboxAttachment(e[0])},linkType:"direct",multiselect:!1}),!0},o.prototype.driveCommand=function(){return this.driveOpenPopup(),!0},o.prototype.autosaveFunction=function(){!this.modalVisibility()||z.a.draftFolderNotEnabled()||!G.a.allowDraftAutosave()||this.isEmptyForm(!1)||this.saving()||this.sending()||this.savedError()||this.saveCommand(),this.autosaveStart()},o.prototype.autosaveStart=function(){w.a.clearTimeout(this.iTimer),this.iTimer=w.a.setTimeout(this.autosaveFunction,L.Magics.Time1m)},o.prototype.autosaveStop=function(){w.a.clearTimeout(this.iTimer)},o.prototype.emailsSource=function(e,t){Object(ee.a)().getAutocomplete(e.term,function(e){t(C.a.map(e,function(e){return e.toLine(!1)}))})},o.prototype.openOpenPgpPopup=function(){var e=this;q.a.capaOpenPGP()&&this.oEditor&&!this.oEditor.isHtml()&&Object(te.showScreenPopup)(c(207),[function(t){e.editor(function(e){e.setPlain(t)})},this.oEditor.getData(!1),this.currentIdentity(),this.to(),this.cc(),this.bcc()])},o.prototype.reloadDraftFolder=function(){var e=z.a.draftFolder();""!==e&&P.r!==e&&(Object(U.q)(e,""),z.a.currentFolderFullNameRaw()===e?Object(ee.a)().reloadMessageList(!0):Object(ee.a)().folderInformation(e))},o.prototype.findIdentityByMessage=function(e,t){var n=1e3,o=null,i=K.a.identities(),a={},r=function(e){e&&e.email&&a[e.email]&&(!o||n>a[e.email][1])&&(o=a[e.email][0],n=a[e.email][1])};if(C.a.each(i,function(e,t){a[e.email()]=[e,t]}),t)switch(e){case L.ComposeType.Empty:break;case L.ComposeType.Reply:case L.ComposeType.ReplyAll:case L.ComposeType.Forward:case L.ComposeType.ForwardAsAttachment:C.a.each(C.a.union(t.to,t.cc,t.bcc),r),o||C.a.each(t.deliveredTo,r);break;case L.ComposeType.Draft:C.a.each(C.a.union(t.from,t.replyTo),r)}return o||i[0]||null},o.prototype.selectIdentity=function(e){e&&e.item&&(this.currentIdentity(e.item),this.setSignatureFromIdentity(e.item))},o.prototype.sendMessageResponse=function(e,t){var n=!1,o="";this.sending(!1),L.StorageResultType.Success===e&&t&&t.Result&&(n=!0,this.modalVisibility()&&Object(_.delegateRun)(this,"closeCommand")),this.modalVisibility()&&!n&&(t&&L.Notification.CantSaveMessage===t.ErrorCode?(this.sendSuccessButSaveError(!0),this.savedErrorDesc(Object(_.trim)(Object(k.i18n)("COMPOSE/SAVED_ERROR_ON_SEND")))):(o=Object(k.getNotification)(t&&t.ErrorCode?t.ErrorCode:L.Notification.CantSendMessage,t&&t.ErrorMessage?t.ErrorMessage:""),this.sendError(!0),this.sendErrorDesc(o||Object(k.getNotification)(L.Notification.CantSendMessage)))),this.reloadDraftFolder()},o.prototype.saveMessageResponse=function(e,t){var n=!1;if(this.saving(!1),L.StorageResultType.Success===e&&t&&t.Result&&t.Result.NewFolder&&t.Result.NewUid){if(n=!0,this.bFromDraft){var o=W.a.message();o&&this.draftFolder()===o.folderFullNameRaw&&this.draftUid()===o.uid&&W.a.message(null)}this.draftFolder(t.Result.NewFolder),this.draftUid(t.Result.NewUid),this.savedTime(w.a.Math.round((new w.a.Date).getTime()/1e3)),this.bFromDraft&&Object(U.q)(this.draftFolder(),"")}n||(this.savedError(!0),this.savedErrorDesc(Object(k.getNotification)(L.Notification.CantSaveMessage))),this.reloadDraftFolder()},o.prototype.onHide=function(){this.autosaveStop(),this.bSkipNextHide||(B.a.composeInEdit(!1),this.reset()),this.bSkipNextHide=!1,this.to.focused(!1),Object(te.routeOn)()},o.prototype.editor=function(e){var t=this;e&&(!this.oEditor&&this.composeEditorArea()?this.oEditor=new H.HtmlEditor(this.composeEditorArea(),null,function(){e(t.oEditor),t.resizerTrigger()},function(e){t.isHtml(!!e)}):this.oEditor&&(e(this.oEditor),this.resizerTrigger()))},o.prototype.converSignature=function(t){var e=10,n="",o=[],i=/{{MOMENT:([^}]+)}}/g;if(t=t.replace(/[\r]/g,""),""!==(n=this.oLastMessage?this.emailArrayToStringLineHelper(this.oLastMessage.from,!0):"")&&(t=t.replace(/{{FROM-FULL}}/g,n),-1===n.indexOf(" ")&&0<n.indexOf("@")&&(n=n.replace(/@[\S]+/,"")),t=t.replace(/{{FROM}}/g,n)),-1<(t=(t=(t=(t=t.replace(/[\s]{1,2}{{FROM}}/g,"{{FROM}}")).replace(/[\s]{1,2}{{FROM-FULL}}/g,"{{FROM-FULL}}")).replace(/{{FROM}}/g,"")).replace(/{{FROM-FULL}}/g,"")).indexOf("{{DATE}}")&&(t=t.replace(/{{DATE}}/g,Object(x.format)(0,"llll"))),-1<t.indexOf("{{TIME}}")&&(t=t.replace(/{{TIME}}/g,Object(x.format)(0,"LT"))),-1<t.indexOf("{{MOMENT:"))try{for(var a=null;null!==(a=i.exec(t))&&(a&&a[0]&&a[1]&&o.push([a[0],a[1]]),0!=(e-=1)););o&&0<o.length&&C.a.each(o,function(e){t=t.replace(e[0],Object(x.format)(0,e[1]))}),t=t.replace(/{{MOMENT:[^}]+}}/g,"")}catch(t){}return t},o.prototype.setSignatureFromIdentity=function(o){var i=this;o&&this.editor(function(e){var t=!1,n=o.signature();""!==n&&":HTML:"===n.substr(0,6)&&(t=!0,n=n.substr(6)),e.setSignature(i.converSignature(n),t,!!o.signatureInsertBefore())})},o.prototype.onShow=function(e,t,n,o,i,a,r){var s=this;Object(te.routeOff)(),this.autosaveStart(),B.a.composeInEdit()?(e=e||L.ComposeType.Empty,L.ComposeType.Empty!==e?Object(te.showScreenPopup)(c(99),[Object(k.i18n)("COMPOSE/DISCARD_UNSAVED_DATA"),function(){s.initOnShow(e,t,n,o,i,a,r)},null,null,null,!1]):(this.addEmailsTo(this.to,n),this.addEmailsTo(this.cc,o),this.addEmailsTo(this.bcc,i),Object(_.isNormal)(a)&&""!==a&&""===this.subject()&&this.subject(a))):this.initOnShow(e,t,n,o,i,a,r)},o.prototype.onWarmUp=function(){this.modalVisibility&&!this.modalVisibility()&&this.editor(function(e){return e.modeToggle(!1)})},o.prototype.addEmailsTo=function(e,t){if(Object(_.isNonEmptyArray)(t)){var n=Object(_.trim)(e()),o=C.a.uniq(C.a.compact(C.a.map(t,function(e){return e?e.toLine(!1):null})));e(n+(""===n?"":", ")+Object(_.trim)(o.join(", ")))}},o.prototype.emailArrayToStringLineHelper=function(e,t){return t=!!t,C.a.map(e,function(e){return e.toLine(t)}).join(", ")},o.prototype.initOnShow=function(e,t,n,o,i,a,r){var s=this;B.a.composeInEdit(!0);var c="",l="",u="",d="",p="",h="",f="",m=null,b=null,g=null,y={},v=V.a.email(),S=e||L.ComposeType.Empty;if((t=t||null)&&Object(_.isNormal)(t)&&(g=Object(_.isArray)(t)&&1===t.length?t[0]:Object(_.isArray)(t)?null:t),this.oLastMessage=g,null!==v&&(y[v]=!0),this.reset(),(m=this.findIdentityByMessage(S,g))&&(y[m.email()]=!0),Object(_.isNonEmptyArray)(n)&&this.to(this.emailArrayToStringLineHelper(n)),Object(_.isNonEmptyArray)(o)&&this.cc(this.emailArrayToStringLineHelper(o)),Object(_.isNonEmptyArray)(i)&&this.bcc(this.emailArrayToStringLineHelper(i)),""!==S&&g){d=Object(x.format)(g.dateTimeStampInUTC(),"FULL"),p=g.subject(),b=g.aDraftInfo;var O=E()(g.body).clone();O&&(Object(_.clearBqSwitcher)(O),h=O.html());var w=null;switch(S){case L.ComposeType.Empty:break;case L.ComposeType.Reply:this.to(this.emailArrayToStringLineHelper(g.replyEmails(y))),this.subject(Object(_.replySubjectAdd)("Re",p)),this.prepearMessageAttachments(g,S),this.aDraftInfo=["reply",g.uid,g.folderFullNameRaw],this.sInReplyTo=g.sMessageId,this.sReferences=Object(_.trim)(this.sInReplyTo+" "+g.sReferences);break;case L.ComposeType.ReplyAll:w=g.replyAllEmails(y),this.to(this.emailArrayToStringLineHelper(w[0])),this.cc(this.emailArrayToStringLineHelper(w[1])),this.subject(Object(_.replySubjectAdd)("Re",p)),this.prepearMessageAttachments(g,S),this.aDraftInfo=["reply",g.uid,g.folderFullNameRaw],this.sInReplyTo=g.sMessageId,this.sReferences=Object(_.trim)(this.sInReplyTo+" "+g.references());break;case L.ComposeType.Forward:case L.ComposeType.ForwardAsAttachment:this.subject(Object(_.replySubjectAdd)("Fwd",p)),this.prepearMessageAttachments(g,S),this.aDraftInfo=["forward",g.uid,g.folderFullNameRaw],this.sInReplyTo=g.sMessageId,this.sReferences=Object(_.trim)(this.sInReplyTo+" "+g.sReferences);break;case L.ComposeType.Draft:this.to(this.emailArrayToStringLineHelper(g.to)),this.cc(this.emailArrayToStringLineHelper(g.cc)),this.bcc(this.emailArrayToStringLineHelper(g.bcc)),this.replyTo(this.emailArrayToStringLineHelper(g.replyTo)),this.bFromDraft=!0,this.draftFolder(g.folderFullNameRaw),this.draftUid(g.uid),this.subject(p),this.prepearMessageAttachments(g,S),this.aDraftInfo=Object(_.isNonEmptyArray)(b)&&3===b.length?b:null,this.sInReplyTo=g.sInReplyTo,this.sReferences=g.sReferences;break;case L.ComposeType.EditAsNew:this.to(this.emailArrayToStringLineHelper(g.to)),this.cc(this.emailArrayToStringLineHelper(g.cc)),this.bcc(this.emailArrayToStringLineHelper(g.bcc)),this.replyTo(this.emailArrayToStringLineHelper(g.replyTo)),this.subject(p),this.prepearMessageAttachments(g,S),this.aDraftInfo=Object(_.isNonEmptyArray)(b)&&3===b.length?b:null,this.sInReplyTo=g.sInReplyTo,this.sReferences=g.sReferences}switch(S){case L.ComposeType.Reply:case L.ComposeType.ReplyAll:c=g.fromToLine(!1,!0),f=Object(k.i18n)("COMPOSE/REPLY_MESSAGE_TITLE",{DATETIME:d,EMAIL:c}),h="<br /><br />"+f+":<br /><br /><blockquote>"+Object(_.trim)(h)+"</blockquote>";break;case L.ComposeType.Forward:c=g.fromToLine(!1,!0),l=g.toToLine(!1,!0),u=g.ccToLine(!1,!0),h="<br /><br />"+Object(k.i18n)("COMPOSE/FORWARD_MESSAGE_TOP_TITLE")+"<br />"+Object(k.i18n)("COMPOSE/FORWARD_MESSAGE_TOP_FROM")+": "+c+"<br />"+Object(k.i18n)("COMPOSE/FORWARD_MESSAGE_TOP_TO")+": "+l+(0<u.length?"<br />"+Object(k.i18n)("COMPOSE/FORWARD_MESSAGE_TOP_CC")+": "+u:"")+"<br />"+Object(k.i18n)("COMPOSE/FORWARD_MESSAGE_TOP_SENT")+": "+Object(_.encodeHtml)(d)+"<br />"+Object(k.i18n)("COMPOSE/FORWARD_MESSAGE_TOP_SUBJECT")+": "+Object(_.encodeHtml)(p)+"<br /><br />"+Object(_.trim)(h)+"<br /><br />";break;case L.ComposeType.ForwardAsAttachment:h=""}this.editor(function(e){e.setHtml(h,!1),(L.EditorDefaultType.PlainForced===s.editorDefaultType()||!g.isHtml()&&L.EditorDefaultType.HtmlForced!==s.editorDefaultType())&&e.modeToggle(!1),m&&L.ComposeType.Draft!==S&&L.ComposeType.EditAsNew!==S&&s.setSignatureFromIdentity(m),s.setFocusInPopup()})}else L.ComposeType.Empty===S?(this.subject(Object(_.isNormal)(a)?""+a:""),h=Object(_.isNormal)(r)?""+r:"",this.editor(function(e){e.setHtml(h,!1),L.EditorDefaultType.Html!==s.editorDefaultType()&&L.EditorDefaultType.HtmlForced!==s.editorDefaultType()&&e.modeToggle(!1),m&&s.setSignatureFromIdentity(m),s.setFocusInPopup()})):Object(_.isNonEmptyArray)(t)?(C.a.each(t,function(e){s.addMessageAsAttachment(e)}),this.editor(function(e){e.setHtml("",!1),L.EditorDefaultType.Html!==s.editorDefaultType()&&L.EditorDefaultType.HtmlForced!==s.editorDefaultType()&&e.modeToggle(!1),m&&L.ComposeType.Draft!==S&&L.ComposeType.EditAsNew!==S&&s.setSignatureFromIdentity(m),s.setFocusInPopup()})):this.setFocusInPopup();var T=this.getAttachmentsDownloadsForUpload();Object(_.isNonEmptyArray)(T)&&$.a.messageUploadAttachments(this.onMessageUploadAttachments,T),m&&this.currentIdentity(m),this.resizerTrigger()},o.prototype.onMessageUploadAttachments=function(e,t){var o=this;L.StorageResultType.Success===e&&t&&t.Result?this.viewModelVisibility()||C.a.each(t.Result,function(e,t){var n=o.getAttachmentById(e);n&&(n.tempName(t),n.waiting(!1).uploading(!1).complete(!0))}):this.setMessageAttachmentFailedDownloadText()},o.prototype.setFocusInPopup=function(){var e=this;M.bMobileDevice||C.a.delay(function(){""===e.to()?e.to.focused(!0):e.oEditor&&(e.to.focused()||e.oEditor.focus())},L.Magics.Time100ms)},o.prototype.onShowWithDelay=function(){this.resizerTrigger()},o.prototype.tryToClosePopup=function(){var e=this,t=c(99);!Object(te.isPopupVisible)(t)&&this.modalVisibility()&&(this.bSkipNextHide||this.isEmptyForm()&&!this.draftUid()?Object(_.delegateRun)(this,"closeCommand"):Object(te.showScreenPopup)(t,[Object(k.i18n)("POPUPS_ASK/DESC_WANT_CLOSE_THIS_WINDOW"),function(){e.modalVisibility()&&Object(_.delegateRun)(e,"closeCommand")}]))},o.prototype.onBuild=function(){var e=this;this.initUploader(),N()("ctrl+q, command+q, ctrl+w, command+w",L.KeyState.Compose,_.noopFalse),N()("`",L.KeyState.Compose,function(){return!(e.oEditor&&!e.oEditor.hasFocus()&&!Object(_.inFocus)()&&(e.identitiesDropdownTrigger(!0),1))}),N()("ctrl+`",L.KeyState.Compose,function(){return e.identitiesDropdownTrigger(!0),!1}),N()("esc, ctrl+down, command+down",L.KeyState.Compose,function(){return e.skipCommand(),!1}),this.allowFolders&&N()("ctrl+s, command+s",L.KeyState.Compose,function(){return e.saveCommand(),!1}),J.appSettingsGet("allowCtrlEnterOnCompose")&&N()("ctrl+enter, command+enter",L.KeyState.Compose,function(){return e.sendCommand(),!1}),N()("shift+esc",L.KeyState.Compose,function(){return e.modalVisibility()&&e.tryToClosePopup(),!1}),X.b("window.resize.real",this.resizerTrigger),X.b("window.resize.real",C.a.debounce(this.resizerTrigger,L.Magics.Time50ms)),Y.a.appendDropbox(),this.driveEnabled()&&E.a.getScript("https://apis.google.com/js/api.js",function(){w.a.gapi&&e.driveVisible(!0)}),w.a.setInterval(function(){e.modalVisibility()&&e.oEditor&&e.oEditor.resize()},L.Magics.Time5s)},o.prototype.driveCallback=function(t,e){var n=this;if(e&&w.a.XMLHttpRequest&&w.a.google&&e[w.a.google.picker.Response.ACTION]===w.a.google.picker.Action.PICKED&&e[w.a.google.picker.Response.DOCUMENTS]&&e[w.a.google.picker.Response.DOCUMENTS][0]&&e[w.a.google.picker.Response.DOCUMENTS][0].id){var i=new w.a.XMLHttpRequest;i.open("GET","https://www.googleapis.com/drive/v2/files/"+e[w.a.google.picker.Response.DOCUMENTS][0].id),i.setRequestHeader("Authorization","Bearer "+t),i.addEventListener("load",function(){if(i&&i.responseText){var o=w.a.JSON.parse(i.responseText),e=function(e,t,n){e&&e.exportLinks&&(e.exportLinks[t]?(o.downloadUrl=e.exportLinks[t],o.title=e.title+"."+n,o.mimeType=t):e.exportLinks["application/pdf"]&&(o.downloadUrl=e.exportLinks["application/pdf"],o.title=e.title+".pdf",o.mimeType="application/pdf"))};if(o&&!o.downloadUrl&&o.mimeType&&o.exportLinks)switch(o.mimeType.toString().toLowerCase()){case"application/vnd.google-apps.document":e(o,"application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx");break;case"application/vnd.google-apps.spreadsheet":e(o,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx");break;case"application/vnd.google-apps.drawing":e(o,"image/png","png");break;case"application/vnd.google-apps.presentation":e(o,"application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx");break;default:e(o,"application/pdf","pdf")}o&&o.downloadUrl&&n.addDriveAttachment(o,t)}}),i.send()}},o.prototype.driveCreatePiker=function(e){var t=this;w.a.gapi&&e&&e.access_token&&w.a.gapi.load("picker",{callback:function(){w.a.google&&w.a.google.picker&&(new w.a.google.picker.PickerBuilder).addView(w.a.google.picker.ViewId.DOCS).setAppId(J.settingsGet("GoogleClientID")).setOAuthToken(e.access_token).setCallback(C.a.bind(t.driveCallback,t,e.access_token)).enableFeature(w.a.google.picker.Feature.NAV_HIDDEN).build().setVisible(!0)}})},o.prototype.driveOpenPopup=function(){var n=this;w.a.gapi&&w.a.gapi.load("auth",{callback:function(){var e=w.a.gapi.auth.getToken(),t=function(e){if(e&&!e.error){var t=w.a.gapi.auth.getToken();return t&&n.driveCreatePiker(t),!0}return!1};e?n.driveCreatePiker(e):w.a.gapi.auth.authorize({client_id:J.settingsGet("GoogleClientID"),scope:"https://www.googleapis.com/auth/drive.readonly",immediate:!0},function(e){t(e)||w.a.gapi.auth.authorize({client_id:J.settingsGet("GoogleClientID"),scope:"https://www.googleapis.com/auth/drive.readonly",immediate:!1},t)})}})},o.prototype.getAttachmentById=function(t){return C.a.find(this.attachments(),function(e){return e&&t===e.id})},o.prototype.cancelAttachmentHelper=function(t,n){var o=this;return function(){var e=C.a.find(o.attachments(),function(e){return e&&e.id===t});e&&(o.attachments.remove(e),Object(_.delegateRunOnDestroy)(e),n&&n.cancel(t))}},o.prototype.initUploader=function(){var s=this;if(this.composeUploaderButton()){var c={},a=Object(_.pInt)(J.settingsGet("AttachmentLimit")),r=new I.a({action:Object(D.G)(),name:"uploader",queueSize:2,multipleSizeLimit:50,clickElement:this.composeUploaderButton(),dragAndDropElement:this.composeUploaderDropPlace()});r?(r.on("onDragEnter",function(){s.dragAndDropOver(!0)}).on("onDragLeave",function(){s.dragAndDropOver(!1)}).on("onBodyDragEnter",function(){s.attachmentsPlace(!0),s.dragAndDropVisible(!0)}).on("onBodyDragLeave",function(){s.dragAndDropVisible(!1)}).on("onProgress",function(e,t,n){var o=c[e];o||(o=s.getAttachmentById(e))&&(c[e]=o),o&&o.progress(w.a.Math.floor(t/n*100))}).on("onSelect",function(e,t){s.dragAndDropOver(!1);var n=Object(_.isUnd)(t.FileName)?"":t.FileName.toString(),o=Object(_.isNormal)(t.Size)?Object(_.pInt)(t.Size):null,i=new Q(e,n,o);return i.cancel=s.cancelAttachmentHelper(e,r),s.attachments.push(i),s.attachmentsPlace(!0),!(0<o&&0<a&&a<o&&(i.waiting(!1).uploading(!0).complete(!0).error(Object(k.i18n)("UPLOAD/ERROR_FILE_IS_TOO_BIG")),1))}).on("onStart",function(e){var t=c[e];t||(t=s.getAttachmentById(e))&&(c[e]=t),t&&t.waiting(!1).uploading(!0).complete(!1)}).on("onComplete",function(e,t,n){var o=s.getAttachmentById(e),i=n&&n.Result&&n.Result.ErrorCode?n.Result.ErrorCode:null,a=t&&n&&n.Result&&n.Result.Attachment?n.Result.Attachment:null,r="";null!==i?r=Object(k.getUploadErrorDescByCode)(i):a||(r=Object(k.i18n)("UPLOAD/ERROR_UNKNOWN")),o&&(""!==r&&0<r.length?o.waiting(!1).uploading(!1).complete(!0).error(r):a&&(o.waiting(!1).uploading(!1).complete(!0),o.initByUploadJson(a)),Object(_.isUnd)(c[e])&&delete c[e])}),this.addAttachmentEnabled(!0).dragAndDropEnabled(r.isDragAndDropSupported())):this.addAttachmentEnabled(!1).dragAndDropEnabled(!1)}},o.prototype.prepearAttachmentsForSendOrSave=function(){var t={};return C.a.each(this.attachmentsInReady(),function(e){e&&""!==e.tempName()&&e.enabled()&&(t[e.tempName()]=[e.fileName(),e.isInline?"1":"0",e.CID,e.contentLocation])}),t},o.prototype.addMessageAsAttachment=function(e){if(e){var t=e.subject();t=".eml"===t.substr(-4).toLowerCase()?t:t+".eml";var n=new Q(e.requestHash,t,e.size());n.fromMessage=!0,n.cancel=this.cancelAttachmentHelper(e.requestHash),n.waiting(!1).uploading(!0).complete(!0),this.attachments.push(n)}},o.prototype.addAttachmentHelper=function(e,t,n){var o=new Q(e,t,n);return o.fromMessage=!1,o.cancel=this.cancelAttachmentHelper(e),o.waiting(!1).uploading(!0).complete(!1),this.attachments.push(o),this.attachmentsPlace(!0),o},o.prototype.addDropboxAttachment=function(e){var t=Object(_.pInt)(J.settingsGet("AttachmentLimit")),n=e.bytes,o=this.addAttachmentHelper(e.link,e.name,n);return 0<n&&0<t&&t<n?(o.uploading(!1).complete(!0),o.error(Object(k.i18n)("UPLOAD/ERROR_FILE_IS_TOO_BIG")),!1):($.a.composeUploadExternals(function(e,t){var n=!1;o.uploading(!1).complete(!0),L.StorageResultType.Success===e&&t&&t.Result&&t.Result[o.id]&&(n=!0,o.tempName(t.Result[o.id])),n||o.error(Object(k.getUploadErrorDescByCode)(L.UploadErrorCode.FileNoUploaded))},[e.link]),!0)},o.prototype.addDriveAttachment=function(e,t){var n=Object(_.pInt)(J.settingsGet("AttachmentLimit")),o=e.fileSize?Object(_.pInt)(e.fileSize):0,i=this.addAttachmentHelper(e.downloadUrl,e.title,o);return 0<o&&0<n&&n<o?(i.uploading(!1).complete(!0),i.error(Object(k.i18n)("UPLOAD/ERROR_FILE_IS_TOO_BIG")),!1):($.a.composeUploadDrive(function(e,t){var n=!1;i.uploading(!1).complete(!0),L.StorageResultType.Success===e&&t&&t.Result&&t.Result[i.id]&&(n=!0,i.tempName(t.Result[i.id][0]),i.size(Object(_.pInt)(t.Result[i.id][1]))),n||i.error(Object(k.getUploadErrorDescByCode)(L.UploadErrorCode.FileNoUploaded))},e.downloadUrl,t),!0)},o.prototype.prepearMessageAttachments=function(e,o){var i=this;if(e)if(L.ComposeType.ForwardAsAttachment===o)this.addMessageAsAttachment(e);else{var t=e.attachments();C.a.each(Object(_.isNonEmptyArray)(t)?t:[],function(e){var t=!1;switch(o){case L.ComposeType.Reply:case L.ComposeType.ReplyAll:t=e.isLinked;break;case L.ComposeType.Forward:case L.ComposeType.Draft:case L.ComposeType.EditAsNew:t=!0}if(t){var n=new Q(e.download,e.fileName,e.estimatedSize,e.isInline,e.isLinked,e.cid,e.contentLocation);n.fromMessage=!0,n.cancel=i.cancelAttachmentHelper(e.download),n.waiting(!1).uploading(!0).complete(!1),i.attachments.push(n)}})}},o.prototype.removeLinkedAttachments=function(){var e=C.a.find(this.attachments(),function(e){return e&&e.isLinked});e&&(this.attachments.remove(e),Object(_.delegateRunOnDestroy)(e))},o.prototype.setMessageAttachmentFailedDownloadText=function(){C.a.each(this.attachments(),function(e){e&&e.fromMessage&&e.waiting(!1).uploading(!1).complete(!0).error(Object(k.getUploadErrorDescByCode)(L.UploadErrorCode.FileNoUploaded))})},o.prototype.isEmptyForm=function(){var e=0<arguments.length&&void 0!==arguments[0]&&!arguments[0]?0===this.attachmentsInReady().length:0===this.attachments().length;return 0===this.to().length&&0===this.cc().length&&0===this.bcc().length&&0===this.replyTo().length&&0===this.subject().length&&e&&(!this.oEditor||""===this.oEditor.getData())},o.prototype.reset=function(){this.to(""),this.cc(""),this.bcc(""),this.replyTo(""),this.subject(""),this.requestDsn(!1),this.requestReadReceipt(!1),this.markAsImportant(!1),this.attachmentsPlace(!1),this.aDraftInfo=null,this.sInReplyTo="",this.bFromDraft=!1,this.sReferences="",this.sendError(!1),this.sendSuccessButSaveError(!1),this.savedError(!1),this.savedTime(0),this.emptyToError(!1),this.attachmentsInProcessError(!1),this.showCc(!1),this.showBcc(!1),this.showReplyTo(!1),Object(_.delegateRunOnDestroy)(this.attachments()),this.attachments([]),this.dragAndDropOver(!1),this.dragAndDropVisible(!1),this.draftFolder(""),this.draftUid(""),this.sending(!1),this.saving(!1),this.oEditor&&this.oEditor.clear(!1)},o.prototype.getAttachmentsDownloadsForUpload=function(){return C.a.map(C.a.filter(this.attachments(),function(e){return e&&""===e.tempName()}),function(e){return e.id})},o.prototype.resizerTrigger=function(){this.resizer(!this.resizer())},o}(ne.a)).prototype,"sendCommand",[o],f()(p.prototype,"sendCommand"),p.prototype),oe(p.prototype,"saveCommand",[i],f()(p.prototype,"saveCommand"),p.prototype),oe(p.prototype,"deleteCommand",[a],f()(p.prototype,"deleteCommand"),p.prototype),oe(p.prototype,"skipCommand",[r],f()(p.prototype,"skipCommand"),p.prototype),oe(p.prototype,"contactsCommand",[s],f()(p.prototype,"contactsCommand"),p.prototype),oe(p.prototype,"dropboxCommand",[l],f()(p.prototype,"dropboxCommand"),p.prototype),oe(p.prototype,"driveCommand",[u],f()(p.prototype,"driveCommand"),p.prototype),d=p))||d)},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o=n(8),i=n.n(o),a=n(4),r=n.n(a),s=n(75),c=n.n(s),l=n(2),u=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];i()(this,n),this.oCross=null,this.sScreenName=e,this.aViewModels=Object(l.isArray)(t)?t:[]}return n.prototype.viewModels=function(){return this.aViewModels},n.prototype.screenName=function(){return this.sScreenName},n.prototype.routes=function(){return null},n.prototype.__cross=function(){return this.oCross},n.prototype.__start=function(){var t=null,n=null,e=this.routes();Object(l.isNonEmptyArray)(e)&&(n=r.a.bind(this.onRoute||l.noop,this),t=c.a.create(),e.forEach(function(e){e&&t&&(t.addRoute(e[0],n).rules=e[1])}),this.oCross=t)},n}()},function(e,t){e.exports=window.ssm},function(e,t,n){var i=n(47);e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"c",function(){return f}),n.d(t,"e",function(){return m}),n.d(t,"b",function(){return b}),n.d(t,"a",function(){return g});var o=n(3),i=n.n(o),a="__rlA";function r(e){if(e in i.a&&i.a[e]&&i.a[e].setItem){var t=i.a[e],n="testLocalStorage_"+i.a.Math.random();try{if(t.setItem(n,n),n===t.getItem(n))return t.removeItem(n),!0}catch(e){}}return!1}var s=r("sessionStorage")&&i.a.sessionStorage||null,c=i.a.top||i.a||null,l=function(e){var t=null;if(s)t=s.getItem(e)||null;else if(c&&i.a.JSON){var n=c.name&&"{"===c.name.toString().substr(0,1)?i.a.JSON.parse(c.name.toString()):null;t=n&&n[e]||null}return t},u=function(e,t){if(s)s.setItem(e,t);else if(c&&i.a.JSON){var n=c.name&&"{"===c.name.toString().substr(0,1)?i.a.JSON.parse(c.name.toString()):null;(n=n||{})[e]=t,c.name=i.a.JSON.stringify(n)}},d=function(){return i.a.Math.round((new i.a.Date).getTime()/1e3)},p=function(){return u("__rlT",d())},h=function(){var e=l("__rlT",0);return e&&i.a.parseInt(e,10)||0};function f(){return l(a)}function m(){var e="AuthAccountHash",t=i.a.__rlah_data();u(a,t&&t[e]?t[e]:""),p()}function b(){u(a,""),p()}function g(){return d()>h()+36e5&&(b(),!0)}i.a.setInterval(p,6e4)},,function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var o=n(72),i=n(63),a=n(44),r=n(67),s=n(43),c=n(78),l=Object.getOwnPropertyDescriptor;t.f=n(42)?l:function(e,t){if(e=a(e),t=r(t,!0),c)try{return l(e,t)}catch(e){}if(s(e,t))return i(!o.f.call(e,t),e[t])}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){e.exports=!0},function(e,t){var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(e,t){e.exports=window.crossroads},function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(1),u=n(2),d=function(n){function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i()(this,o);var t=r()(this,n.call(this));return t.value=e.value,!Object(u.isUnd)(t.value)&&t.value.subscribe||(t.value=l.a.observable(!Object(u.isUnd)(t.value)&&!!t.value)),t.enable=e.enable,!Object(u.isUnd)(t.enable)&&t.enable.subscribe||(t.enable=l.a.observable(!!Object(u.isUnd)(t.enable)||!!t.enable)),t.disable=e.disable,!Object(u.isUnd)(t.disable)&&t.disable.subscribe||(t.disable=l.a.observable(!Object(u.isUnd)(t.disable)&&!!t.disable)),t.label=e.label||"",t.inline=!Object(u.isUnd)(e.inline)&&e.inline,t.readOnly=!Object(u.isUnd)(e.readOnly)&&!!e.readOnly,t.inverted=!Object(u.isUnd)(e.inverted)&&!!e.inverted,t.labeled=!Object(u.isUnd)(e.label),t.labelAnimated=!!e.labelAnimated,t}return c()(o,n),o.prototype.click=function(){this.readOnly||!this.enable()||this.disable()||this.value(!this.value())},o}(n(27).a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();t.default=function p(e){var t=[],n=[],o=[];return new a(e).tokenize().forEach(function(e){"operator"!==e.type||","!==e.value&&";"!==e.value?n.push(e):(n.length&&t.push(n),n=[])}),n.length&&t.push(n),t.forEach(function(e){(e=function(e){for(var t=!1,n="text",o=void 0,i=[],a={address:[],comment:[],group:[],text:[]},r=0,s=e.length;r<s;r++){var c=e[r];if("operator"===c.type)switch(c.value){case"<":n="address";break;case"(":n="comment";break;case":":n="group",t=!0;break;default:n="text"}else c.value&&a[n].push(c.value)}if(!a.text.length&&a.comment.length&&(a.text=a.comment,a.comment=[]),t)a.text=a.text.join(" "),i.push({name:a.text||o&&o.name,group:a.group.length?p(a.group.join(",")):[]});else{if(!a.address.length&&a.text.length){for(var l=a.text.length-1;0<=l;l--)if(a.text[l].match(/^[^@\s]+@[^@\s]+$/)){a.address=a.text.splice(l,1);break}var u=function(e){return a.address.length?e:(a.address=[e.trim()]," ")};if(!a.address.length)for(var d=a.text.length-1;0<=d&&(a.text[d]=a.text[d].replace(/\s*\b[^@\s]+@[^@\s]+\b\s*/,u).trim(),!a.address.length);d--);}if(!a.text.length&&a.comment.length&&(a.text=a.comment,a.comment=[]),1<a.address.length&&(a.text=a.text.concat(a.address.splice(1))),a.text=a.text.join(" "),a.address=a.address.join(" "),!a.address&&t)return[];(o={address:a.address||a.text||"",name:a.text||a.address||""}).address===o.name&&((o.address||"").match(/@/)?o.name="":o.address=""),i.push(o)}return i}(e)).length&&(o=o.concat(e))}),o};var i={'"':'"',"(":")","<":">",",":"",":":";",";":""},a=function(){function n(e){!function(e,t){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.str=(e||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[]}return o(n,[{key:"tokenize",value:function(){for(var e=void 0,t=[],n=0,o=this.str.length;n<o;n++)e=this.str.charAt(n),this.checkChar(e);return this.list.forEach(function(e){e.value=(e.value||"").toString().trim(),e.value&&t.push(e)}),t}},{key:"checkChar",value:function(e){if((e in i||"\\"===e)&&this.escaped)this.escaped=!1;else{if(this.operatorExpecting&&e===this.operatorExpecting)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting="",void(this.escaped=!1);if(!this.operatorExpecting&&e in i)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting=i[e],void(this.escaped=!1)}this.escaped||"\\"!==e?(this.node||(this.node={type:"text",value:""},this.list.push(this.node)),this.escaped&&"\\"!==e&&(this.node.value+="\\"),this.node.value+=e,this.escaped=!1):this.escaped=!0}}]),n}()},function(e,t,n){e.exports=!n(42)&&!n(53)(function(){return 7!=Object.defineProperty(n(82)("div"),"a",{get:function(){return 7}}).a})},function(e,t){e.exports=window.Jua},function(e,t,n){"use strict";n.d(t,"c",function(){return S}),n.d(t,"d",function(){return O}),n.d(t,"b",function(){return w}),n.d(t,"a",function(){return T});var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(3),u=n.n(l),d=n(4),p=n.n(d),h=n(1),f=n(0),m=n(6),b=n(2),g=n(16),y=n(36),v=n(46),S=p.a.memoize(function(e,t){e=Object(b.trim)(e).toLowerCase(),t=Object(b.trim)(t).toLowerCase();var n=f.FileType.Unknown,o=t.split("/");switch(!0){case"image"===o[0]||-1<Object(b.inArray)(e,["png","jpg","jpeg","gif","bmp"]):n=f.FileType.Image;break;case"audio"===o[0]||-1<Object(b.inArray)(e,["mp3","ogg","oga","wav"]):n=f.FileType.Audio;break;case"video"===o[0]||-1<Object(b.inArray)(e,["mkv","avi"]):n=f.FileType.Video;break;case-1<Object(b.inArray)(e,["php","js","css"]):n=f.FileType.Code;break;case"eml"===e||-1<Object(b.inArray)(t,["message/delivery-status","message/rfc822"]):n=f.FileType.Eml;break;case"text"===o[0]&&"html"!==o[1]||-1<Object(b.inArray)(e,["txt","log"]):n=f.FileType.Text;break;case"text/html"===t||-1<Object(b.inArray)(e,["html"]):n=f.FileType.Html;break;case-1<Object(b.inArray)(o[1],["zip","7z","tar","rar","gzip","bzip","bzip2","x-zip","x-7z","x-rar","x-tar","x-gzip","x-bzip","x-bzip2","x-zip-compressed","x-7z-compressed","x-rar-compressed"])||-1<Object(b.inArray)(e,["zip","7z","tar","rar","gzip","bzip","bzip2"]):n=f.FileType.Archive;break;case-1<Object(b.inArray)(o[1],["pdf","x-pdf"])||-1<Object(b.inArray)(e,["pdf"]):n=f.FileType.Pdf;break;case-1<Object(b.inArray)(t,["application/pgp-signature","application/pgp-keys"])||-1<Object(b.inArray)(e,["asc","pem","ppk"]):n=f.FileType.Certificate;break;case-1<Object(b.inArray)(t,["application/pkcs7-signature"])||-1<Object(b.inArray)(e,["p7s"]):n=f.FileType.CertificateBin;break;case-1<Object(b.inArray)(o[1],["rtf","msword","vnd.msword","vnd.openxmlformats-officedocument.wordprocessingml.document","vnd.openxmlformats-officedocument.wordprocessingml.template","vnd.ms-word.document.macroEnabled.12","vnd.ms-word.template.macroEnabled.12"]):n=f.FileType.WordText;break;case-1<Object(b.inArray)(o[1],["excel","ms-excel","vnd.ms-excel","vnd.openxmlformats-officedocument.spreadsheetml.sheet","vnd.openxmlformats-officedocument.spreadsheetml.template","vnd.ms-excel.sheet.macroEnabled.12","vnd.ms-excel.template.macroEnabled.12","vnd.ms-excel.addin.macroEnabled.12","vnd.ms-excel.sheet.binary.macroEnabled.12"]):n=f.FileType.Sheet;break;case-1<Object(b.inArray)(o[1],["powerpoint","ms-powerpoint","vnd.ms-powerpoint","vnd.openxmlformats-officedocument.presentationml.presentation","vnd.openxmlformats-officedocument.presentationml.template","vnd.openxmlformats-officedocument.presentationml.slideshow","vnd.ms-powerpoint.addin.macroEnabled.12","vnd.ms-powerpoint.presentation.macroEnabled.12","vnd.ms-powerpoint.template.macroEnabled.12","vnd.ms-powerpoint.slideshow.macroEnabled.12"]):n=f.FileType.Presentation}return n}),O=p.a.memoize(function(e){var t="",n="icon-file";switch(e){case f.FileType.Text:case f.FileType.Eml:case f.FileType.WordText:n="icon-file-text";break;case f.FileType.Html:case f.FileType.Code:n="icon-file-code";break;case f.FileType.Image:n="icon-file-image";break;case f.FileType.Audio:n="icon-file-music";break;case f.FileType.Video:n="icon-file-movie";break;case f.FileType.Archive:n="icon-file-zip";break;case f.FileType.Certificate:case f.FileType.CertificateBin:n="icon-file-certificate";break;case f.FileType.Sheet:n="icon-file-excel";break;case f.FileType.Presentation:n="icon-file-chart-graph";break;case f.FileType.Pdf:t="pdf",n="icon-none"}return[n,t]}),w=function(e){var t="",n=[];if(Object(b.isNonEmptyArray)(e)&&(t="icon-attachment",(n=p.a.uniq(p.a.compact(p.a.map(e,function(e){return e?S(Object(b.getFileExtension)(e[0]),e[1]):""}))))&&1===n.length&&n[0]))switch(n[0]){case f.FileType.Text:case f.FileType.WordText:t="icon-file-text";break;case f.FileType.Html:case f.FileType.Code:t="icon-file-code";break;case f.FileType.Image:t="icon-file-image";break;case f.FileType.Audio:t="icon-file-music";break;case f.FileType.Video:t="icon-file-movie";break;case f.FileType.Archive:t="icon-file-zip";break;case f.FileType.Certificate:case f.FileType.CertificateBin:t="icon-file-certificate";break;case f.FileType.Sheet:t="icon-file-excel";break;case f.FileType.Presentation:t="icon-file-chart-graph"}return t},T=function(t){function n(){i()(this,n);var e=r()(this,t.call(this,"AttachmentModel"));return e.checked=h.a.observable(!1),e.mimeType="",e.fileName="",e.fileNameExt="",e.fileType=f.FileType.Unknown,e.estimatedSize=0,e.friendlySize="",e.isInline=!1,e.isLinked=!1,e.isThumbnail=!1,e.cid="",e.cidWithOutTags="",e.contentLocation="",e.download="",e.folder="",e.uid="",e.mimeIndex="",e.framed=!1,e}return c()(n,t),n.newInstanceFromJson=function(e){var t=new n;return t.initByJson(e)?t:null},n.prototype.initByJson=function(e){var t=!1;return e&&"Object/Attachment"===e["@Object"]&&(this.mimeType=Object(b.trim)((e.MimeType||"").toLowerCase()),this.fileName=Object(b.trim)(e.FileName),this.estimatedSize=Object(b.pInt)(e.EstimatedSize),this.isInline=!!e.IsInline,this.isLinked=!!e.IsLinked,this.isThumbnail=!!e.IsThumbnail,this.cid=e.CID,this.contentLocation=e.ContentLocation,this.download=e.Download,this.folder=e.Folder,this.uid=e.Uid,this.mimeIndex=e.MimeIndex,this.framed=!!e.Framed,this.friendlySize=Object(b.friendlySize)(this.estimatedSize),this.cidWithOutTags=this.cid.replace(/^<+/,"").replace(/>+$/,""),this.fileNameExt=Object(b.getFileExtension)(this.fileName),this.fileType=S(this.fileNameExt,this.mimeType),t=!0),t},n.prototype.isImage=function(){return f.FileType.Image===this.fileType},n.prototype.isMp3=function(){return f.FileType.Audio===this.fileType&&"mp3"===this.fileNameExt},n.prototype.isOgg=function(){return f.FileType.Audio===this.fileType&&("oga"===this.fileNameExt||"ogg"===this.fileNameExt)},n.prototype.isWav=function(){return f.FileType.Audio===this.fileType&&"wav"===this.fileNameExt},n.prototype.hasThumbnail=function(){return this.isThumbnail},n.prototype.isText=function(){return f.FileType.Text===this.fileType||f.FileType.Eml===this.fileType||f.FileType.Certificate===this.fileType||f.FileType.Html===this.fileType||f.FileType.Code===this.fileType},n.prototype.isPdf=function(){return f.FileType.Pdf===this.fileType},n.prototype.isFramed=function(){return this.framed&&m.data.__APP__&&m.data.__APP__.googlePreviewSupported()&&!(this.isPdf()&&m.bAllowPdfPreview)&&!this.isText()&&!this.isImage()},n.prototype.hasPreview=function(){return this.isImage()||this.isPdf()&&m.bAllowPdfPreview||this.isText()||this.isFramed()},n.prototype.hasPreplay=function(){return v.a.supportedMp3&&this.isMp3()||v.a.supportedOgg&&this.isOgg()||v.a.supportedWav&&this.isWav()},n.prototype.linkDownload=function(){return Object(g.c)(this.download)},n.prototype.linkPreview=function(){return Object(g.e)(this.download)},n.prototype.linkThumbnail=function(){return this.hasThumbnail()?Object(g.g)(this.download):""},n.prototype.linkThumbnailPreviewStyle=function(){var e=this.linkThumbnail();return""===e?"":"background:url("+e+")"},n.prototype.linkFramed=function(){return Object(g.d)(this.download)},n.prototype.linkPreviewAsPlain=function(){return Object(g.f)(this.download)},n.prototype.linkPreviewMain=function(){var e="";switch(!0){case this.isImage():case this.isPdf()&&m.bAllowPdfPreview:e=this.linkPreview();break;case this.isText():e=this.linkPreviewAsPlain();break;case this.isFramed():e=this.linkFramed()}return e},n.prototype.generateTransferDownloadUrl=function(){var e=this.linkDownload();return"http"!==e.substr(0,4)&&(e=u.a.location.protocol+"//"+u.a.location.host+u.a.location.pathname+e),this.mimeType+":"+this.fileName+":"+e},n.prototype.eventDragStart=function(e,t){var n=t.originalEvent||t;return e&&n&&n.dataTransfer&&n.dataTransfer.setData&&n.dataTransfer.setData("DownloadURL",this.generateTransferDownloadUrl()),!0},n.prototype.iconClass=function(){return O(this.fileType)[0]},n.prototype.iconText=function(){return O(this.fileType)[1]},n}(y.a)},function(e,t,n){var a=n(101);e.exports=function(o,i,e){if(a(o),void 0===i)return o;switch(e){case 1:return function(e){return o.call(i,e)};case 2:return function(e,t){return o.call(i,e,t)};case 3:return function(e,t,n){return o.call(i,e,t,n)}}return function(){return o.apply(i,arguments)}}},function(e,t,n){var o=n(47),i=n(41).document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?o:n)(e)}},function(e,t){e.exports={}},function(e,t,o){var i=o(60),a=o(128),r=o(90),s=o(88)("IE_PROTO"),c=function(){},l=function(){var e,t=o(82)("iframe"),n=r.length;for(t.style.display="none",o(132).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l.prototype[r[n]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(c.prototype=i(e),n=new c,c.prototype=null,n[s]=e):n=l(),void 0===t?n:a(n,t)}},function(e,t,n){var o=n(109),i=n(90);e.exports=Object.keys||function(e){return o(e,i)}},function(e,t,n){var o=n(89)("keys"),i=n(74);e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t,n){var o=n(38),i=n(41),a=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:o.version,mode:n(73)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var o=n(50).f,i=n(43),a=n(61)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&o(e,a,{configurable:!0,value:t})}},function(e,t,n){t.f=n(61)},function(e,t,n){var o=n(41),i=n(38),a=n(73),r=n(92),s=n(50).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:o.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:r.f(e)})}},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(27),u=function(e){function t(){return i()(this,t),r()(this,e.apply(this,arguments))}return c()(t,e),t}(n(76).a);t.default=Object(l.b)(u,"CheckboxComponent")},function(e,t,n){"use strict";n.r(t),n.d(t,"HtmlEditor",function(){return f}),n.d(t,"default",function(){return f});var o=n(8),a=n.n(o),i=n(3),r=n.n(i),s=n(4),c=n.n(s),l=n(7),u=n.n(l),d=n(6),p=n(0),h=n(5),f=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;a()(this,i),this.blurTimer=0,this.__resizable=!1,this.__inited=!1,this.onBlur=null,this.onReady=null,this.onModeChange=null,this.onBlur=t,this.onReady=n,this.onModeChange=o,this.element=e,this.$element=u()(e),this.resize=c.a.throttle(c.a.bind(this.resizeEditor,this),100),this.init()}return i.prototype.runOnBlur=function(){this.onBlur&&this.onBlur()},i.prototype.blurTrigger=function(){var e=this;this.onBlur&&(r.a.clearTimeout(this.blurTimer),this.blurTimer=r.a.setTimeout(function(){e.runOnBlur()},p.Magics.Time200ms))},i.prototype.focusTrigger=function(){this.onBlur&&r.a.clearTimeout(this.blurTimer)},i.prototype.isHtml=function(){return!!this.editor&&"wysiwyg"===this.editor.mode},i.prototype.clearCachedSignature=function(){this.editor&&this.editor.execCommand("insertSignature",{clearCache:!0})},i.prototype.setSignature=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.editor&&this.editor.execCommand("insertSignature",{isHtml:t,insertBefore:n,signature:e})},i.prototype.checkDirty=function(){return!!this.editor&&this.editor.checkDirty()},i.prototype.resetDirty=function(){this.editor&&this.editor.resetDirty()},i.prototype.getData=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t="";if(this.editor)try{t="plain"===this.editor.mode&&this.editor.plugins.plain&&this.editor.__plain?this.editor.__plain.getRawData():e?'<div data-html-editor-font-wrapper="true" style="font-family: arial, sans-serif; font-size: 13px;">'+this.editor.getData()+"</div>":this.editor.getData()}catch(e){}return t},i.prototype.getDataWithHtmlMark=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return(this.isHtml()?":HTML:":"")+this.getData(e)},i.prototype.modeToggle=function(e,t){if(this.editor){try{e?"plain"===this.editor.mode&&this.editor.setMode("wysiwyg"):"wysiwyg"===this.editor.mode&&this.editor.setMode("plain")}catch(e){}t&&this.resize()}},i.prototype.setHtmlOrPlain=function(e,t){":HTML:"===e.substr(0,6)?this.setHtml(e.substr(6),t):this.setPlain(e,t)},i.prototype.setHtml=function(e,t){if(this.editor&&this.__inited){this.clearCachedSignature(),this.modeToggle(!0),e=e.replace(/<p[^>]*><\/p>/gi,"");try{this.editor.setData(e)}catch(e){}t&&this.focus()}},i.prototype.replaceHtml=function(e,t){if(this.editor&&this.__inited&&"wysiwyg"===this.editor.mode)try{this.editor.setData(this.editor.getData().replace(e,t))}catch(e){}},i.prototype.setPlain=function(e,t){if(this.editor&&this.__inited){if(this.clearCachedSignature(),this.modeToggle(!1),"plain"===this.editor.mode&&this.editor.plugins.plain&&this.editor.__plain)this.editor.__plain.setRawData(e);else try{this.editor.setData(e)}catch(e){}t&&this.focus()}},i.prototype.init=function(){var i=this;if(this.element&&!this.editor){var e=function(){var e=d.htmlEditorDefaultConfig,t=h.settingsGet("Language"),n=!!h.appSettingsGet("allowHtmlEditorSourceButton"),o=!!h.appSettingsGet("allowHtmlEditorBitiButtons");!n&&o||e.toolbarGroups.__cfgInited||(e.toolbarGroups.__cfgInited=!0,n&&(e.removeButtons=e.removeButtons.replace(",Source","")),o||(e.removePlugins+=(e.removePlugins?",":"")+"bidi")),e.enterMode=r.a.CKEDITOR.ENTER_BR,e.shiftEnterMode=r.a.CKEDITOR.ENTER_P,e.language=d.htmlEditorLangsMap[(t||"en").toLowerCase()]||"en",r.a.CKEDITOR.env&&(r.a.CKEDITOR.env.isCompatible=!0),i.editor=r.a.CKEDITOR.appendTo(i.element,e),i.editor.on("key",function(e){return!e||!e.data||p.EventKeyCode.Tab!==e.data.keyCode}),i.editor.on("blur",function(){i.blurTrigger()}),i.editor.on("mode",function(){i.blurTrigger(),i.onModeChange&&i.onModeChange("plain"!==i.editor.mode)}),i.editor.on("focus",function(){i.focusTrigger()}),r.a.FileReader&&i.editor.on("drop",function(e){if(0<e.data.dataTransfer.getFilesCount()){var t=e.data.dataTransfer.getFile(0);if(t&&r.a.FileReader&&e.data.dataTransfer.id&&t.type&&t.type.match(/^image/i)){var n="[img="+e.data.dataTransfer.id+"]",o=new r.a.FileReader;o.onloadend=function(){o.result&&i.replaceHtml(n,'<img src="'+o.result+'" />')},o.readAsDataURL(t),e.data.dataTransfer.setData("text/html",n)}}}),i.editor.on("instanceReady",function(){i.editor.removeMenuItem&&(i.editor.removeMenuItem("cut"),i.editor.removeMenuItem("copy"),i.editor.removeMenuItem("paste")),i.__resizable=!0,i.__inited=!0,i.resize(),i.onReady&&i.onReady()})};r.a.CKEDITOR?e():r.a.__initEditor=e}},i.prototype.focus=function(){if(this.editor)try{this.editor.focus()}catch(e){}},i.prototype.hasFocus=function(){if(this.editor)try{return!!this.editor.focusManager.hasFocus}catch(e){}return!1},i.prototype.blur=function(){if(this.editor)try{this.editor.focusManager.blur(!0)}catch(e){}},i.prototype.resizeEditor=function(){if(this.editor&&this.__resizable)try{this.editor.resize(this.$element.width(),this.$element.innerHeight())}catch(e){}},i.prototype.setReadOnly=function(e){if(this.editor)try{this.editor.setReadOnly(!!e)}catch(e){}},i.prototype.clear=function(e){this.setHtml("",e)},i}()},function(y,e,v){!function(e,t){"use strict";var n,a,r,s,u,l,c,o,d,g,U,H,B,G,p,i,h,f,K,V,m,b;try{n=v(54)}catch(e){}y.exports=(r="function"==typeof(a=n),s=!!window.addEventListener,u=window.document,l=window.setTimeout,c=function(e,t,n,o){s?e.addEventListener(t,n,!!o):e.attachEvent("on"+t,n)},o=function(e,t,n,o){s?e.removeEventListener(t,n,!!o):e.detachEvent("on"+t,n)},d=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},f={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!(h=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),11<e.month&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e}),firstDay:0,formatStrict:!(i=function(e,t,n){var o;u.createEvent?((o=u.createEvent("HTMLEvents")).initEvent(t,!0,!1),o=p(o,n),e.dispatchEvent(o)):u.createEventObject&&(o=u.createEventObject(),o=p(o,n),e.fireEvent("on"+t,o))}),minDate:null,maxDate:null,yearRange:10,showWeekNumber:!(p=function(e,t,n){var o,i;for(o in t)(i=void 0!==e[o])&&"object"==typeof t[o]&&null!==t[o]&&void 0===t[o].nodeName?U(t[o])?n&&(e[o]=new Date(t[o].getTime())):g(t[o])?n&&(e[o]=t[o].slice(0)):e[o]=p({},t[o],n):!n&&i||(e[o]=t[o]);return e}),pickWholeWeek:!(G=function(e,t){return e.getTime()===t.getTime()}),minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!(B=function(e){U(e)&&e.setHours(0,0,0,0)}),yearSuffix:"",showMonthAfterYear:!(H=function(e,t){return[31,e%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t]}),showDaysInNextAndPreviousMonths:!(U=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())}),enableSelectionDaysInNextAndPreviousMonths:!(g=function(e){return/Array/.test(Object.prototype.toString.call(e))}),numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},K=function(e,t,n){for(t+=e.firstDay;7<=t;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},V=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},m=function(e,t,n,o,i,a){var r,s,c,l,u,d=e._o,p=n===d.minYear,h=n===d.maxYear,f='<div id="'+a+'" class="pika-title" role="heading" aria-live="assertive">',m=!0,b=!0;for(c=[],r=0;r<12;r++)c.push('<option value="'+(n===i?r-t:12+r-t)+'"'+(r===o?' selected="selected"':"")+(p&&r<d.minMonth||h&&r>d.maxMonth?'disabled="disabled"':"")+">"+d.i18n.months[r]+"</option>");for(l='<div class="pika-label">'+d.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+c.join("")+"</select></div>",g(d.yearRange)?(r=d.yearRange[0],s=d.yearRange[1]+1):(r=n-d.yearRange,s=1+n+d.yearRange),c=[];r<s&&r<=d.maxYear;r++)r>=d.minYear&&c.push('<option value="'+r+'"'+(r===n?' selected="selected"':"")+">"+r+"</option>");return u='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+c.join("")+"</select></div>",d.showMonthAfterYear?f+=u+l:f+=l+u,p&&(0===o||d.minMonth>=o)&&(m=!1),h&&(11===o||d.maxMonth<=o)&&(b=!1),0===t&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(f+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),f+"</div>"},(b=function(e){var o=this,i=o.config(e);o._onMouseDown=function(e){if(o._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(d(t,"is-disabled")||(!d(t,"pika-button")||d(t,"is-empty")||d(t.parentNode,"is-disabled")?d(t,"pika-prev")?o.prevMonth():d(t,"pika-next")&&o.nextMonth():(o.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),i.bound&&l(function(){o.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100))),d(t,"pika-select"))o._c=!0;else{if(!e.preventDefault)return e.returnValue=!1;e.preventDefault()}}},o._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(d(t,"pika-select-month")?o.gotoMonth(t.value):d(t,"pika-select-year")&&o.gotoYear(t.value))},o._onKeyChange=function(e){if(e=e||window.event,o.isVisible())switch(e.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:e.preventDefault(),o.adjustDate("subtract",1);break;case 38:o.adjustDate("subtract",7);break;case 39:o.adjustDate("add",1);break;case 40:o.adjustDate("add",7)}},o._onInputChange=function(e){var t;e.firedBy!==o&&(t=i.parse?i.parse(i.field.value,i.format):r?(t=a(i.field.value,i.format,i.formatStrict))&&t.isValid()?t.toDate():null:new Date(Date.parse(i.field.value)),U(t)&&o.setDate(t),o._v||o.show())},o._onInputFocus=function(){o.show()},o._onInputClick=function(){o.show()},o._onInputBlur=function(){var e=u.activeElement;do{if(d(e,"pika-single"))return}while(e=e.parentNode);o._c||(o._b=l(function(){o.hide()},50)),o._c=!1},o._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,n=t;if(t){!s&&d(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),c(t,"change",o._onChange)));do{if(d(n,"pika-single")||n===i.trigger)return}while(n=n.parentNode);o._v&&t!==i.trigger&&n!==i.trigger&&o.hide()}},o.el=u.createElement("div"),o.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),c(o.el,"mousedown",o._onMouseDown,!0),c(o.el,"touchend",o._onMouseDown,!0),c(o.el,"change",o._onChange),i.keyboardInput&&c(u,"keydown",o._onKeyChange),i.field&&(i.container?i.container.appendChild(o.el):i.bound?u.body.appendChild(o.el):i.field.parentNode.insertBefore(o.el,i.field.nextSibling),c(i.field,"change",o._onInputChange),i.defaultDate||(r&&i.field.value?i.defaultDate=a(i.field.value,i.format).toDate():i.defaultDate=new Date(Date.parse(i.field.value)),i.setDefaultDate=!0));var t=i.defaultDate;U(t)?i.setDefaultDate?o.setDate(t,!0):o.gotoDate(t):o.gotoDate(new Date),i.bound?(this.hide(),o.el.className+=" is-bound",c(i.trigger,"click",o._onInputClick),c(i.trigger,"focus",o._onInputFocus),c(i.trigger,"blur",o._onInputBlur)):this.show()}).prototype={config:function(e){this._o||(this._o=p({},f,!0));var t=p(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=4<n?4:n,U(t.minDate)||(t.minDate=!1),U(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),g(t.yearRange)){var o=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||o,t.yearRange[1]=parseInt(t.yearRange[1],10)||o}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||f.yearRange,100<t.yearRange&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,U(this._d)?this._o.toString?this._o.toString(this._d,e):r?a(this._d).format(e):this._d.toDateString():""},getMoment:function(){return r?a(this._d):null},setMoment:function(e,t){r&&a.isMoment(e)&&this.setDate(e.toDate(),t)},getDate:function(){return U(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",i(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),U(e)){var n=this._o.minDate,o=this._o.maxDate;U(n)&&e<n?e=n:U(o)&&o<e&&(e=o),this._d=new Date(e.getTime()),B(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),i(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(U(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),t=i<n.getTime()||o.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,o=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(o.valueOf()+i):"subtract"===e&&(n=new Date(o.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=h(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=h({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(B(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=f.minDate,this._o.minYear=f.minYear,this._o.minMonth=f.minMonth,this._o.startRange=f.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(B(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=f.maxDate,this._o.maxYear=f.maxYear,this._o.maxMonth=f.maxMonth,this._o.endRange=f.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,o=n.minYear,i=n.maxYear,a=n.minMonth,r=n.maxMonth,s="";this._y<=o&&(this._y=o,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=i&&(this._y=i,!isNaN(r)&&this._m>r&&(this._m=r)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var c=0;c<n.numberOfMonths;c++)s+='<div class="pika-lendar">'+m(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,t)+this.render(this.calendars[c].year,this.calendars[c].month,t)+"</div>";this.el.innerHTML=s,n.bound&&"hidden"!==n.field.type&&l(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var e,t,n,o,i,a,r,s,c,l;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||u.documentElement.clientWidth,a=window.innerHeight||u.documentElement.clientHeight,r=window.pageYOffset||u.body.scrollTop||u.documentElement.scrollTop,"function"==typeof e.getBoundingClientRect)s=(l=e.getBoundingClientRect()).left+window.pageXOffset,c=l.bottom+window.pageYOffset;else for(s=t.offsetLeft,c=t.offsetTop+t.offsetHeight;t=t.offsetParent;)s+=t.offsetLeft,c+=t.offsetTop;(this._o.reposition&&i<s+n||-1<this._o.position.indexOf("right")&&0<s-n+e.offsetWidth)&&(s=s-n+e.offsetWidth),(this._o.reposition&&a+r<c+o||-1<this._o.position.indexOf("top")&&0<c-o-e.offsetHeight)&&(c=c-o-e.offsetHeight),this.el.style.left=s+"px",this.el.style.top=c+"px"}},render:function(e,t,n){var o,i,a,r,s,c,l,u,d=this._o,p=new Date,h=H(e,t),f=new Date(e,t,1).getDay(),m=[],b=[];B(p),0<d.firstDay&&(f-=d.firstDay)<0&&(f+=7);for(var g=0===t?11:t-1,y=11===t?0:t+1,v=0===t?e-1:e,S=11===t?e+1:e,O=H(v,g),w=h+f,T=w;7<T;)T-=7;w+=7-T;for(var C=!1,A=0,E=0;A<w;A++){var F=new Date(e,t,A-f+1),j=!!U(this._d)&&G(F,this._d),N=G(F,p),R=-1!==d.events.indexOf(F.toDateString()),I=A<f||h+f<=A,L=A-f+1,_=t,P=e,M=d.startRange&&G(d.startRange,F),D=d.endRange&&G(d.endRange,F),k=d.startRange&&d.endRange&&d.startRange<F&&F<d.endRange;I&&(A<f?(L=O+L,_=g,P=v):(L-=h,_=y,P=S));var x={day:L,month:_,year:P,hasEvent:R,isSelected:j,isToday:N,isDisabled:d.minDate&&F<d.minDate||d.maxDate&&F>d.maxDate||d.disableWeekends&&(0===(l=F.getDay())||6===l)||d.disableDayFn&&d.disableDayFn(F),isEmpty:I,isStartRange:M,isEndRange:D,isInRange:k,showDaysInNextAndPreviousMonths:d.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:d.enableSelectionDaysInNextAndPreviousMonths};d.pickWholeWeek&&j&&(C=!0),b.push(V(x)),7==++E&&(d.showWeekNumber&&b.unshift((a=A-f,r=t,s=e,c=void 0,c=new Date(s,0,1),'<td class="pika-week">'+Math.ceil(((new Date(s,r,a)-c)/864e5+c.getDay()+1)/7)+"</td>")),m.push((o=b,i=d.isRTL,'<tr class="pika-row'+(d.pickWholeWeek?" pick-whole-week":"")+(C?" is-selected":"")+'">'+(i?o.reverse():o).join("")+"</tr>")),E=0,C=!(b=[]))}return u=m,'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+K(e,t)+'">'+K(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(d)+"<tbody>"+u.join("")+"</tbody></table>"},isVisible:function(){return this._v},show:function(){var e,t;this.isVisible()||(this._v=!0,this.draw(),(e=this.el).className=(t=(" "+e.className+" ").replace(" is-hidden "," ")).trim?t.trim():t.replace(/^\s+|\s+$/g,""),this._o.bound&&(c(u,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e,t,n=this._v;!1!==n&&(this._o.bound&&o(u,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",e=this.el,d(e,t="is-hidden")||(e.className=""===e.className?t:e.className+" "+t),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),o(this.el,"mousedown",this._onMouseDown,!0),o(this.el,"touchend",this._onMouseDown,!0),o(this.el,"change",this._onChange),e.keyboardInput&&o(u,"keydown",this._onKeyChange),e.field&&(o(e.field,"change",this._onInputChange),e.bound&&(o(e.trigger,"click",this._onInputClick),o(e.trigger,"focus",this._onInputFocus),o(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},b)}()},function(e,t){e.exports=window.Autolinker},function(e,t,n){"use strict";var o=n(8),i=n.n(o),a=n(1),r=n(0);t.a=new function e(){i()(this,e),this.capa=a.a.observable(""),this.modules=a.a.observable({}),this.filters=a.a.observableArray([]),this.filters.loading=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.filters.saving=a.a.observable(!1).extend({throttle:r.Magics.Time200ms}),this.raw=a.a.observable("")}},function(e,t,n){"use strict";n.r(t),n.d(t,"AskPopupView",function(){return y}),n.d(t,"default",function(){return y});var o,i=n(8),a=n.n(i),r=n(11),s=n.n(r),c=n(12),l=n.n(c),u=n(1),d=n(19),p=n.n(d),h=n(0),f=n(2),m=n(10),b=n(9),g=n(24),y=Object(b.popup)({name:"View/Popup/Ask",templateID:"PopupsAsk"})(o=function(t){function n(){a()(this,n);var e=s()(this,t.call(this));return e.askDesc=u.a.observable(""),e.yesButton=u.a.observable(""),e.noButton=u.a.observable(""),e.yesFocus=u.a.observable(!1),e.noFocus=u.a.observable(!1),e.fYesAction=null,e.fNoAction=null,e.bFocusYesOnShow=!0,e.bDisabeCloseOnEsc=!0,e.sDefaultKeyScope=h.KeyState.PopupAsk,e}return l()(n,t),n.prototype.clearPopup=function(){this.askDesc(""),this.yesButton(Object(m.i18n)("POPUPS_ASK/BUTTON_YES")),this.noButton(Object(m.i18n)("POPUPS_ASK/BUTTON_NO")),this.yesFocus(!1),this.noFocus(!1),this.fYesAction=null,this.fNoAction=null},n.prototype.yesClick=function(){this.cancelCommand(),Object(f.isFunc)(this.fYesAction)&&this.fYesAction.call(null)},n.prototype.noClick=function(){this.cancelCommand(),Object(f.isFunc)(this.fNoAction)&&this.fNoAction.call(null)},n.prototype.onShow=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"",a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];this.clearPopup(),this.fYesAction=t||null,this.fNoAction=n||null,this.askDesc(e||""),o&&this.yesButton(o),i&&this.noButton(i),this.bFocusYesOnShow=!!a},n.prototype.onShowWithDelay=function(){this.bFocusYesOnShow&&this.yesFocus(!0)},n.prototype.onBuild=function(){var e=this;p()("tab, shift+tab, right, left",h.KeyState.PopupAsk,function(){return e.yesFocus()?e.noFocus(!0):e.yesFocus(!0),!1}),p()("esc",h.KeyState.PopupAsk,function(){return e.noClick(),!1})},n}(g.a))||o},function(e,t){e.exports=window.ifvisible},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){n(103);var o=n(38).Object;e.exports=function(e,t){return o.getOwnPropertyDescriptor(e,t)}},function(e,t,n){var o=n(44),i=n(71).f;n(105)("getOwnPropertyDescriptor",function(){return function(e,t){return i(o(e),t)}})},function(e,t,n){var o=n(83);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t,n){var i=n(58),a=n(38),r=n(53);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),i(i.S+i.F*r(function(){n(1)}),"Object",o)}},function(e,t,n){"use strict";t.__esModule=!0;var o=r(n(123)),i=r(n(139)),a="function"==typeof i.default&&"symbol"==typeof o.default?function(e){return typeof e}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function r(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof i.default&&"symbol"===a(o.default)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":a(e)}},function(e,t,n){"use strict";var v=n(73),S=n(58),O=n(108),w=n(52),T=n(85),C=n(127),A=n(91),E=n(133),F=n(61)("iterator"),j=!([].keys&&"next"in[].keys()),N=function(){return this};e.exports=function(e,t,n,o,i,a,r){C(n,t,o);var s,c,l,u=function(e){if(!j&&e in f)return f[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},d=t+" Iterator",p="values"==i,h=!1,f=e.prototype,m=f[F]||f["@@iterator"]||i&&f[i],b=m||u(i),g=i?p?u("entries"):b:void 0,y="Array"==t&&f.entries||m;if(y&&(l=E(y.call(new e)))!==Object.prototype&&l.next&&(A(l,d,!0),v||"function"==typeof l[F]||w(l,F,N)),p&&m&&"values"!==m.name&&(h=!0,b=function(){return m.call(this)}),v&&!r||!j&&!h&&f[F]||w(f,F,b),T[t]=b,T[d]=N,i)if(s={values:p?b:u("values"),keys:a?b:u("keys"),entries:g},r)for(c in s)c in f||O(f,c,s[c]);else S(S.P+S.F*(j||h),t,s);return s}},function(e,t,n){e.exports=n(52)},function(e,t,n){var r=n(43),s=n(44),c=n(129)(!1),l=n(88)("IE_PROTO");e.exports=function(e,t){var n,o=s(e),i=0,a=[];for(n in o)n!=l&&r(o,n)&&a.push(n);for(;t.length>i;)r(o,n=t[i++])&&(~c(a,n)||a.push(n));return a}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var o=n(109),i=n(90).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return o(e,i)}},function(e,t,n){"use strict";n.r(t),n.d(t,"LanguagesPopupView",function(){return b}),n.d(t,"default",function(){return b});var o,i=n(8),a=n.n(i),r=n(11),s=n.n(r),c=n(12),l=n.n(c),u=n(4),d=n.n(u),p=n(1),h=n(2),f=n(9),m=n(24),b=Object(f.popup)({name:"View/Popup/Languages",templateID:"PopupsLanguages"})(o=function(t){function n(){a()(this,n);var e=s()(this,t.call(this));return e.fLang=null,e.userLanguage=p.a.observable(""),e.langs=p.a.observableArray([]),e.languages=p.a.computed(function(){var t=e.userLanguage();return d.a.map(e.langs(),function(e){return{key:e,user:e===t,selected:p.a.observable(!1),fullName:Object(h.convertLangName)(e)}})}),e.langs.subscribe(function(){e.setLanguageSelection()}),e}return l()(n,t),n.prototype.languageTooltipName=function(e){var t=Object(h.convertLangName)(e,!0);return Object(h.convertLangName)(e,!1)===t?"":t},n.prototype.setLanguageSelection=function(){var t=this.fLang?p.a.unwrap(this.fLang):"";d.a.each(this.languages(),function(e){e.selected(e.key===t)})},n.prototype.onBeforeShow=function(){this.fLang=null,this.userLanguage(""),this.langs([])},n.prototype.onShow=function(e,t,n){this.fLang=e,this.userLanguage(n||""),this.langs(t)},n.prototype.changeLanguage=function(e){this.fLang&&this.fLang(e),this.cancelCommand()},n}(m.a))||o},function(e,t,n){"use strict";var o=n(3),i=n.n(o),a=n(2),r=n(6),s=n(0),c=n(29),l=n(10),u=n(45);t.a=function(t){r.data.__APP__=t,r.$win.on("keydown",a.killCtrlACtrlS).on("unload",function(){r.data.bUnload=!0}),r.$html.addClass(r.bMobileDevice?"mobile":"no-mobile").on("click.dropdown.data-api",a.detectDropdownVisibility);var e=i.a.rl||{};e.i18n=l.i18n,e.createCommand=a.createCommandLegacy,e.addSettingsViewModel=c.b,e.addSettingsViewModelForAdmin=c.c,e.addHook=c.a,e.settingsGet=c.d,e.pluginSettingsGet=c.h,e.pluginRemoteRequest=c.e,e.EmailModel=u.EmailModel,e.Enums=s,i.a.rl=e,i.a.__APP_BOOT=function(e){Object(a.domReady)(function(){i.a.setTimeout(function(){i.a.rainloopTEMPLATES&&i.a.rainloopTEMPLATES[0]?(i.a.document.getElementById("rl-templates").innerHTML=i.a.rainloopTEMPLATES[0],i.a.setTimeout(function(){r.$html.removeClass("no-js rl-booted-trigger").addClass("rl-booted"),t.bootstart()},s.Magics.Time10ms)):e(),i.a.__APP_BOOT=null},s.Magics.Time10ms)})}}},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var o=n(8),i=n.n(o),a=n(1),r=n(6),s=n(5),c=function(){function e(){i()(this,e),this.allowLanguagesOnSettings=a.a.observable(!0),this.allowLanguagesOnLogin=a.a.observable(!0),this.newMoveToFolder=a.a.observable(!0),this.interfaceAnimation=a.a.observable(!0),this.interfaceAnimation.subscribe(function(e){var t=r.bMobileDevice||!e;r.$html.toggleClass("rl-anim",!t).toggleClass("no-rl-anim",t)}),this.interfaceAnimation.valueHasMutated(),this.prem=a.a.observable(!1),this.community=a.a.observable(!0)}return e.prototype.populate=function(){this.allowLanguagesOnLogin(!!s.settingsGet("AllowLanguagesOnLogin")),this.allowLanguagesOnSettings(!!s.settingsGet("AllowLanguagesOnSettings")),this.newMoveToFolder(!!s.settingsGet("NewMoveToFolder")),this.interfaceAnimation(!!s.settingsGet("InterfaceAnimation")),this.prem(!!s.settingsGet("PremType")),this.community(!!s.settingsGet("Community"))},e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return y});var o=n(8),i=n.n(o),a=n(3),u=n.n(a),r=n(4),d=n.n(r),s=n(7),p=n.n(s),c=n(23),l=n(0),h=n(2),f=n(6),m=n(16),b=n(29),g=n(5),y=function(){function e(){i()(this,e),this.oRequests={}}return e.prototype.defaultResponse=function(e,t,n,o,i,a){var r=function(){l.StorageResultType.Success!==n&&f.data.bUnload&&(n=l.StorageResultType.Unload),l.StorageResultType.Success===n&&o&&!o.Result?(o&&-1<Object(h.inArray)(o.ErrorCode,[l.Notification.AuthError,l.Notification.AccessError,l.Notification.ConnectionError,l.Notification.DomainNotAllowed,l.Notification.AccountNotAllowed,l.Notification.MailServerError,l.Notification.UnknownNotification,l.Notification.UnknownError])&&(f.data.iAjaxErrorCount+=1),o&&l.Notification.InvalidToken===o.ErrorCode&&(f.data.iTokenErrorCount+=1),c.q<f.data.iTokenErrorCount&&f.data.__APP__&&f.data.__APP__.loginAndLogoutReload&&f.data.__APP__.loginAndLogoutReload(!1,!0),(o.ClearAuth||o.Logout||c.a<f.data.iAjaxErrorCount)&&f.data.__APP__&&f.data.__APP__.clearClientSideToken&&(f.data.__APP__.clearClientSideToken(),!o.ClearAuth&&f.data.__APP__.loginAndLogoutReload&&f.data.__APP__.loginAndLogoutReload(!1,!0))):l.StorageResultType.Success===n&&o&&o.Result&&(f.data.iAjaxErrorCount=0,f.data.iTokenErrorCount=0),Object(b.f)("ajax-default-response",[t,l.StorageResultType.Success===n?o:null,n,i,a]),e&&e(n,l.StorageResultType.Success===n?o:null,i,t,a)};switch(n){case"success":n=l.StorageResultType.Success;break;case"abort":n=l.StorageResultType.Abort;break;default:n=l.StorageResultType.Error}l.StorageResultType.Error===n?d.a.delay(r,300):r()},e.prototype.ajaxRequest=function(o,i){var a,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2e4,r=this,t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[],s=""===t,c=(new u.a.Date).getTime();(a=(i=i||{}).Action||"")&&0<n.length&&d.a.each(n,function(e){r.oRequests[e]&&(r.oRequests[e].__aborted=!0,r.oRequests[e].abort&&r.oRequests[e].abort(),r.oRequests[e]=null)}),s&&(i.XToken=g.appSettingsGet("token"));var l=p.a.ajax({type:s?"POST":"GET",url:Object(m.a)(t),async:!0,dataType:"json",data:s?i:{},headers:{},timeout:e,global:!0});return l.always(function(e,t){var n=!1;e&&e.Time&&(n=Object(h.pInt)(e.Time)>(new u.a.Date).getTime()-c),a&&r.oRequests[a]&&(r.oRequests[a].__aborted&&(t="abort"),r.oRequests[a]=null),r.defaultResponse(o,a,t,e,n,i)}),a&&0<n.length&&-1<Object(h.inArray)(a,n)&&(this.oRequests[a]&&(this.oRequests[a].__aborted=!0,this.oRequests[a].abort&&this.oRequests[a].abort(),this.oRequests[a]=null),this.oRequests[a]=l),l},e.prototype.defaultRequest=function(e,t,n,o,i,a){return(n=n||{}).Action=t,i=Object(h.pString)(i),Object(b.f)("ajax-default-request",[t,n,i]),this.ajaxRequest(e,n,Object(h.isUnd)(o)?c.g:Object(h.pInt)(o),i,a)},e.prototype.noop=function(e){this.defaultRequest(e,"Noop")},e.prototype.jsError=function(e,t,n,o,i,a,r){this.defaultRequest(e,"JsError",{Message:t,FileName:n,LineNo:o,Location:i,HtmlCapa:a,TimeOnPage:r})},e.prototype.jsInfo=function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.defaultRequest(e,"JsInfo",{Type:t,Data:n,IsError:o?"1":"0"})},e.prototype.getPublicKey=function(e){this.defaultRequest(e,"GetPublicKey")},e.prototype.jsVersion=function(e,t){this.defaultRequest(e,"Version",{Version:t})},e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return y});var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(4),u=n.n(l),d=n(7),p=n.n(d),h=n(1),f=n(6),m=n(2),b=n(16),g=n(9),y=function(n){function o(e){i()(this,o);var t=r()(this,n.call(this,"settings",e));return t.menu=h.a.observableArray([]),t.oCurrentSubScreen=null,t.oViewModelPlace=null,t.setupSettings(),t}return c()(o,n),o.prototype.setupSettings=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&e()},o.prototype.onRoute=function(t){var e=this,n=null,o=null,i=null,a=null;if((o=u.a.find(f.VIEW_MODELS.settings,function(e){return e&&e.__rlSettingsData&&t===e.__rlSettingsData.Route}))&&(u.a.find(f.VIEW_MODELS["settings-removed"],function(e){return e&&e===o})&&(o=null),o&&u.a.find(f.VIEW_MODELS["settings-disabled"],function(e){return e&&e===o})&&(o=null)),o){if(o.__builded&&o.__vm)n=o.__vm;else if((i=this.oViewModelPlace)&&1===i.length){n=new o,(a=p()("<div></div>").addClass("rl-settings-view-model").hide()).appendTo(i),n.viewModelDom=a,n.__rlSettingsData=o.__rlSettingsData,o.__dom=a,o.__builded=!0,o.__vm=n;var r={name:o.__rlSettingsData.Template};h.a.applyBindingAccessorsToNode(a[0],{translatorInit:!0,template:function(){return r}},n),Object(m.delegateRun)(n,"onBuild",[a])}else Object(m.log)("Cannot find sub settings view model position: SettingsSubScreen");n&&u.a.defer(function(){e.oCurrentSubScreen&&(Object(m.delegateRun)(e.oCurrentSubScreen,"onHide"),e.oCurrentSubScreen.viewModelDom.hide()),e.oCurrentSubScreen=n,e.oCurrentSubScreen&&(Object(m.delegateRun)(e.oCurrentSubScreen,"onBeforeShow"),e.oCurrentSubScreen.viewModelDom.show(),Object(m.delegateRun)(e.oCurrentSubScreen,"onShow"),Object(m.delegateRun)(e.oCurrentSubScreen,"onShowWithDelay",[],200),u.a.each(e.menu(),function(e){e.selected(n&&n.__rlSettingsData&&e.route===n.__rlSettingsData.Route)}),p()("#rl-content .b-settings .b-content .content").scrollTop(0)),Object(m.windowResize)()})}else Object(g.setHash)(Object(b.z)(),!1,!0)},o.prototype.onHide=function(){this.oCurrentSubScreen&&this.oCurrentSubScreen.viewModelDom&&(Object(m.delegateRun)(this.oCurrentSubScreen,"onHide"),this.oCurrentSubScreen.viewModelDom.hide())},o.prototype.onBuild=function(){var e=this;u.a.each(f.VIEW_MODELS.settings,function(t){t&&t.__rlSettingsData&&!u.a.find(f.VIEW_MODELS["settings-removed"],function(e){return e&&e===t})&&e.menu.push({route:t.__rlSettingsData.Route,label:t.__rlSettingsData.Label,selected:h.a.observable(!1),disabled:!!u.a.find(f.VIEW_MODELS["settings-disabled"],function(e){return e&&e===t})})}),this.oViewModelPlace=p()("#rl-content #rl-settings-subscreen")},o.prototype.routes=function(){var e=u.a.find(f.VIEW_MODELS.settings,function(e){return e&&e.__rlSettingsData&&e.__rlSettingsData.IsDefault}),n=e&&e.__rlSettingsData?e.__rlSettingsData.Route:"general",t={subname:/^(.*)$/,normalize_:function(e,t){return t.subname=Object(m.isUnd)(t.subname)?n:Object(m.pString)(t.subname),[t.subname]}};return[["{subname}/",t],["{subname}",t],["",t]]},o}(n(65).a)},function(e,t,b){"use strict";var n=b(8),i=b.n(n),o=b(11),a=b.n(o),r=b(12),s=b.n(r),c=b(3),l=b.n(c),u=b(7),d=b.n(u),p=b(4),h=b.n(p),f=b(1),m=b(19),g=b.n(m),y=b(66),v=b.n(y),S=b(6),O=b(2),w=b(0),T=b(16),C=b(10),A=b(5),E=b(40),F=b(32),j=null,N=null,R=function(){function t(e){i()(this,t),this.dom=null,this.opened=f.a.observable(!1),this.cmd=f.a.observable(""),this.focused=f.a.observable(!1),this.themes=E.a.themes,this.cmdHistory=[],this.cmdHistoryShift=0,this.cmdHelper=f.a.observable(""),this.cmds=["help","version","clear","theme","lang"],this.cmdsWithParameters=["theme","lang"],this.isAdmin=!1,this.dom=e,this.isAdmin=!!A.appSettingsGet("admin")}return t.prototype.runCmd=function(e,t,n){var o,i,a,r,s,c,l,u="",d=null;if(this.cmdHelper(""),n){switch(e){case"lang":d=(this.isAdmin?F.a.languagesAdmin():F.a.languages()).filter(function(e){return 0===e.lastIndexOf(t,0)});break;case"theme":d=E.a.themes().filter(function(e){return 0===e.lastIndexOf(t,0)})}if(e&&d)if(1===d.length&&d[0])this.cmd(e+" "+d[0]);else if(1<d.length&&d[0]&&d[1]){for(var p="",h=0,f=d[0].split(""),m=f.length;h<m&&d[1][h]===f[h];h++)p+=f[h];p&&(this.cmdHelper("["+d.join(", ")+"]"),this.cmd(e+" "+p))}return""}switch(e){case"hi":u="hello";break;case"?":case"ls":case"help":l=this.cmds,u=b(159).replace("{{ commands }}",l.join(" "));break;case"v":case"version":u=b(162).replace("{{ version }}",A.appSettingsGet("version")+" ("+A.appSettingsGet("appVersionType")+")");break;case"clear":this.dom.find(".rl-cmd-history-data").empty(),u="";break;case"theme":s=t,c=E.a.themes(),u=s&&-1<Object(O.inArray)(s,c)?(Object(O.changeTheme)(s),""):b(160).replace("{{ themes }}",c.join(", "));break;case"lang":i=t,a=this.isAdmin,r=this.isAdmin?F.a.languagesAdmin():F.a.languages(),u=i&&-1<Object(O.inArray)(i,r)?(Object(C.reload)(a,i),""):b(161).replace("{{ langs }}",r.join(", "));break;default:o=e,u=b(158).replace("{{ cmd }}",o)}return u},t.prototype.onCmd=function(e){var t=this,n=this.cmd().replace(/[\s]+/," "),o=Object(O.trim)(n).replace().split(/[\s]+/),i=o.shift();if(""===Object(O.trim)(n))return!1;if(e)if(-1<Object(O.inArray)(i,this.cmds)){var a=this.runCmd(i,o.join(" "),!0);a&&this.cmd(a)}else{var r=this.cmds.filter(function(e){return e!==i&&0===e.lastIndexOf(i,0)});1===r.length&&r[0]&&this.cmd(r[0]+(-1<Object(O.inArray)(r[0],this.cmdsWithParameters)?" ":""))}else{this.cmdHistory.unshift(n),this.cmdHistory=h.a.uniq(this.cmdHistory),this.cmdHistoryShift=0;var s=this.runCmd(i,o.join(" "),!1),c=this.dom.find(".rl-cmd-history-data");c&&c[0]&&(c.append(d()("<div></div>").html(b(163).replace("{{ cmd }}",n))),s&&c.append(d()("<div></div>").html(s)),h.a.delay(function(){t.dom.find(".rl-cmd-history").scrollTop(c.height())},50))}return!0},t.prototype.onEsc=function(){return this.opened(!1),!1},t.prototype.onTab=function(){return this.onCmd(!0),!1},t.prototype.onEnter=function(){return this.onCmd(!1),this.cmd(""),!1},t.prototype.onKeyDown=function(e){if(e&&e.keyCode&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey&&0<this.cmdHistory.length){var t=l.a.parseInt(e.keyCode,10);if(w.EventKeyCode.Up===t||w.EventKeyCode.Down===t)return this.cmdHistory[this.cmdHistoryShift]?(this.cmd(this.cmdHistory[this.cmdHistoryShift]),w.EventKeyCode.Up===t?this.cmdHistoryShift+=1:w.EventKeyCode.Down===t&&(this.cmdHistoryShift-=1)):this.cmdHistoryShift=0,!1}return!0},t}();var I=b(22),L=b(25),_=b(9),P=function(){function e(){i()(this,e)}return e.prototype.bootstart=function(){},e}();b.d(t,"a",function(){return M});var M=function(e){function t(n){i()(this,t);var o=a()(this,e.call(this));return o.googlePreviewSupportedCache=null,o.isLocalAutocomplete=!0,o.iframe=null,o.lastErrorTime=0,o.iframe=d()('<iframe class="internal-hiddden" />').appendTo("body"),S.$win.on("error",function(e){if(e&&e.originalEvent&&e.originalEvent.message&&-1===Object(O.inArray)(e.originalEvent.message,["Script error.","Uncaught Error: Error calling method on NPObject."])){var t=Object(O.timestamp)();if(o.lastErrorTime>=t)return;o.lastErrorTime=t,n.jsError(O.noop,e.originalEvent.message,e.originalEvent.filename,e.originalEvent.lineno,l.a.location&&l.a.location.toString?l.a.location.toString():"",S.$html.attr("class"),Object(O.microtime)()-S.startMicrotime)}}),S.$win.on("resize",function(){I.a("window.resize")}),I.b("window.resize",h.a.throttle(function(){var e=S.$win.height(),t=S.$win.height();S.$win.__sizes[0]===e&&S.$win.__sizes[1]===t||(S.$win.__sizes[0]=e,S.$win.__sizes[1]=t,I.a("window.resize.real"))},w.Magics.Time50ms)),S.$doc.on("keydown",function(e){e&&e.ctrlKey&&S.$html.addClass("rl-ctrl-key-pressed")}).on("keyup",function(e){e&&!e.ctrlKey&&S.$html.removeClass("rl-ctrl-key-pressed")}),S.$doc.on("mousemove keypress click",h.a.debounce(function(){I.a("rl.auto-logout-refresh")},w.Magics.Time5s)),g()("esc, enter",w.KeyState.All,function(){Object(O.detectDropdownVisibility)()}),A.appSettingsGet("allowCmdInterface")&&g()("ctrl+shift+`",w.KeyState.All,function(){var e;A.appSettingsGet("allowCmdInterface")&&(null===j&&((j=d()("<div></div>")).appendTo(S.$body),e=j,N||(N=new R(e),f.a.applyBindingAccessorsToNode(e[0],{translatorInit:!0,template:function(){return{name:"Cmd"}}},N))),h.a.delay(function(){N&&(N.opened(!N.opened()),N.opened()&&h.a.delay(function(){N&&N.focused&&N.focused(!0)},w.Magics.Time50ms))},w.Magics.Time50ms))}),o}return s()(t,e),t.prototype.remote=function(){return null},t.prototype.data=function(){return null},t.prototype.getApplicationConfiguration=function(e,t){return this.applicationConfiguration[e]||t},t.prototype.download=function(e){if(S.sUserAgent&&(-1<S.sUserAgent.indexOf("chrome")||-1<S.sUserAgent.indexOf("chrome"))){var t=l.a.document.createElement("a");if(t.href=e,l.a.document&&l.a.document.createEvent){var n=l.a.document.createEvent.MouseEvents;if(n&&n.initEvent&&t.dispatchEvent)return n.initEvent("click",!0,!0),t.dispatchEvent(n),!0}}return S.bMobileDevice?(l.a.open(e,"_self"),l.a.focus()):this.iframe.attr("src",e),!0},t.prototype.googlePreviewSupported=function(){return null===this.googlePreviewSupportedCache&&(this.googlePreviewSupportedCache=!!A.settingsGet("AllowGoogleSocial")&&!!A.settingsGet("AllowGoogleSocialPreview")),this.googlePreviewSupportedCache},t.prototype.setWindowTitle=function(e){e=Object(O.isNormal)(e)&&0<e.length?""+e:"",A.settingsGet("Title")&&(e+=(e?" - ":"")+A.settingsGet("Title")),l.a.document.title=e+" ...",l.a.document.title=e},t.prototype.redirectToAdminPanel=function(){h.a.delay(function(){l.a.location.href=Object(T.x)()},w.Magics.Time100ms)},t.prototype.clearClientSideToken=function(){l.a.__rlah_clear&&l.a.__rlah_clear()},t.prototype.setClientSideToken=function(e){l.a.__rlah_set&&(l.a.__rlah_set(e),A.settingsSet("AuthAccountHash",e),Object(T.v)())},t.prototype.loginAndLogoutReload=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=!!A.appSettingsGet("inIframe"),i=Object(O.pString)(A.appSettingsGet("customLogoutLink"));t&&this.clearClientSideToken(),t&&n&&l.a.close&&l.a.close(),i=i||(e?Object(T.x)():Object(T.y)()),t&&l.a.location.href!==i?h.a.delay(function(){o&&l.a.parent?l.a.parent.location.href=i:l.a.location.href=i,S.$win.trigger("rl.tooltips.diactivate")},w.Magics.Time100ms):(Object(_.routeOff)(),Object(_.setHash)(Object(T.w)(),!0),Object(_.routeOff)(),h.a.delay(function(){o&&l.a.parent?l.a.parent.location.reload():l.a.location.reload(),S.$win.trigger("rl.tooltips.diactivate")},w.Magics.Time100ms))},t.prototype.historyBack=function(){l.a.history.back()},t.prototype.bootstart=function(){I.a("rl.bootstart");var e=A.appSettingsGet("mobile");f.a.components.register("SaveTrigger",b(164).default),f.a.components.register("Input",b(165).default),f.a.components.register("Select",b(166).default),f.a.components.register("Radio",b(171).default),f.a.components.register("TextArea",b(167).default),f.a.components.register("Date",b(168).default),f.a.components.register("x-script",b(169).default),A.appSettingsGet("materialDesign")&&S.bAnimationSupported?f.a.components.register("Checkbox",b(170).default):f.a.components.register("Checkbox",b(94).default),f.a.components.register("CheckboxSimple",b(94).default),Object(C.initOnStartOrLangChange)(C.initNotificationLanguage),h.a.delay(O.windowResizeCallback,w.Magics.Time1s),I.b("ssm.mobile-enter",function(){Object(S.leftPanelDisabled)(!0)}),I.b("ssm.mobile-leave",function(){Object(S.leftPanelDisabled)(!1)}),e?(S.$html.addClass("ssm-state-mobile").addClass("rl-mobile"),I.a("ssm.mobile-enter")):(S.$html.addClass("rl-desktop"),v.a.addState({id:"mobile",query:"(max-width: 767px)",onEnter:function(){S.$html.addClass("ssm-state-mobile"),I.a("ssm.mobile-enter")},onLeave:function(){S.$html.removeClass("ssm-state-mobile"),I.a("ssm.mobile-leave")}}),v.a.addState({id:"tablet",query:"(min-width: 768px) and (max-width: 999px)",onEnter:function(){S.$html.addClass("ssm-state-tablet")},onLeave:function(){S.$html.removeClass("ssm-state-tablet")}}),v.a.addState({id:"desktop",query:"(min-width: 1000px) and (max-width: 1400px)",onEnter:function(){S.$html.addClass("ssm-state-desktop")},onLeave:function(){S.$html.removeClass("ssm-state-desktop")}}),v.a.addState({id:"desktop-large",query:"(min-width: 1401px)",onEnter:function(){S.$html.addClass("ssm-state-desktop-large")},onLeave:function(){S.$html.removeClass("ssm-state-desktop-large")}})),S.leftPanelDisabled.subscribe(function(e){S.$html.toggleClass("rl-left-panel-disabled",e),S.$html.toggleClass("rl-left-panel-enabled",!e)}),S.leftPanelType.subscribe(function(e){S.$html.toggleClass("rl-left-panel-none","none"===e),S.$html.toggleClass("rl-left-panel-short","short"===e)}),S.leftPanelDisabled.valueHasMutated(),F.a.populate(),E.a.populate(),L.a.populate()},t}(P)},,function(e,t,n){"use strict";n.r(t),n.d(t,"FolderSystemPopupView",function(){return w}),n.d(t,"default",function(){return w});var o,i=n(8),r=n.n(i),a=n(11),s=n.n(a),c=n(12),l=n.n(c),u=n(4),d=n.n(u),p=n(1),h=n(0),f=n(23),m=n(2),b=n(10),g=n(13),y=n(5),v=n(17),S=n(9),O=n(24),w=Object(S.popup)({name:"View/Popup/FolderSystem",templateID:"PopupsFolderSystem"})(o=function(i){function a(){r()(this,a);var e=s()(this,i.call(this));e.sChooseOnText="",e.sUnuseText="",Object(b.initOnStartOrLangChange)(function(){e.sChooseOnText=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/SELECT_CHOOSE_ONE"),e.sUnuseText=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/SELECT_UNUSE_NAME")}),e.notification=p.a.observable(""),e.folderSelectList=p.a.computed(function(){return Object(m.folderListOptionsBuilder)([],g.a.folderList(),g.a.folderListSystemNames(),[["",e.sChooseOnText],[f.r,e.sUnuseText]],null,null,null,null,null,!0)}),e.sentFolder=g.a.sentFolder,e.draftFolder=g.a.draftFolder,e.spamFolder=g.a.spamFolder,e.trashFolder=g.a.trashFolder,e.archiveFolder=g.a.archiveFolder;var t=function(){y.settingsSet("SentFolder",g.a.sentFolder()),y.settingsSet("DraftFolder",g.a.draftFolder()),y.settingsSet("SpamFolder",g.a.spamFolder()),y.settingsSet("TrashFolder",g.a.trashFolder()),y.settingsSet("ArchiveFolder",g.a.archiveFolder())},n=d.a.debounce(function(){t(),v.a.saveSystemFolders(m.noop,{SentFolder:g.a.sentFolder(),DraftFolder:g.a.draftFolder(),SpamFolder:g.a.spamFolder(),TrashFolder:g.a.trashFolder(),ArchiveFolder:g.a.archiveFolder(),NullFolder:"NullFolder"})},h.Magics.Time1s),o=function(){t(),n()};return g.a.sentFolder.subscribe(o),g.a.draftFolder.subscribe(o),g.a.spamFolder.subscribe(o),g.a.trashFolder.subscribe(o),g.a.archiveFolder.subscribe(o),e.defautOptionsAfterRender=m.defautOptionsAfterRender,e}return l()(a,i),a.prototype.onShow=function(){var e="";switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:h.SetSystemFoldersNotification.None){case h.SetSystemFoldersNotification.Sent:e=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/NOTIFICATION_SENT");break;case h.SetSystemFoldersNotification.Draft:e=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/NOTIFICATION_DRAFTS");break;case h.SetSystemFoldersNotification.Spam:e=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/NOTIFICATION_SPAM");break;case h.SetSystemFoldersNotification.Trash:e=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/NOTIFICATION_TRASH");break;case h.SetSystemFoldersNotification.Archive:e=Object(b.i18n)("POPUPS_SYSTEM_FOLDERS/NOTIFICATION_ARCHIVE")}this.notification(e)},a}(O.a))||o},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var o=n(8),h=n.n(o),i=n(7),a=n.n(i),r=n(4),f=n.n(r),s=n(19),c=n.n(s),m=n(1),u=n(0),b=n(2),l=function(){function s(e,t,n,o,i,a,r){var c=this;h()(this,s),this.selectedItemUseCallback=!0,this.iSelectNextHelper=0,this.iFocusedNextHelper=0,this.sLastUid="",this.oCallbacks={},this.list=e,this.listChecked=m.a.computed(function(){return f.a.filter(c.list(),function(e){return e.checked()})}).extend({rateLimit:0}),this.isListChecked=m.a.computed(function(){return 0<c.listChecked().length}),this.focusedItem=n||m.a.observable(null),this.selectedItem=t||m.a.observable(null),this.itemSelectedThrottle=f.a.debounce(f.a.bind(this.itemSelected,this),300),this.listChecked.subscribe(function(e){0<e.length?null===c.selectedItem()?c.selectedItem.valueHasMutated&&c.selectedItem.valueHasMutated():c.selectedItem(null):c.autoSelect()&&c.focusedItem()&&c.selectedItem(c.focusedItem())},this),this.selectedItem.subscribe(function(e){e?(c.isListChecked()&&f.a.each(c.listChecked(),function(e){e.checked(!1)}),c.selectedItemUseCallback&&c.itemSelectedThrottle(e)):c.selectedItemUseCallback&&c.itemSelected(null)},this),this.selectedItem=this.selectedItem.extend({toggleSubscribeProperty:[this,"selected"]}),this.focusedItem=this.focusedItem.extend({toggleSubscribeProperty:[null,"focused"]}),this.sItemSelector=o,this.sItemSelectedSelector=i,this.sItemCheckedSelector=a,this.sItemFocusedSelector=r,this.focusedItem.subscribe(function(e){e&&(c.sLastUid=c.getItemUid(e))},this);var l=[],u=[],d=null,p=null;this.list.subscribe(function(e){Object(b.isArray)(e)&&f.a.each(e,function(e){if(e){var t=c.getItemUid(e);l.push(t),e.checked()&&u.push(t),null===d&&e.focused()&&(d=t),null===p&&e.selected()&&(p=t)}})},this,"beforeChange"),this.list.subscribe(function(e){var t=null,n=!1,o=d,i=!1,a=!1,r=0,s=[];c.selectedItemUseCallback=!1,c.focusedItem(null),c.selectedItem(null),Object(b.isArray)(e)&&(r=u.length,f.a.each(e,function(e){var t=c.getItemUid(e);s.push(t),null!==d&&d===t&&(c.focusedItem(e),d=null),0<r&&-1<Object(b.inArray)(t,u)&&(i=!0,e.checked(!0),r-=1),i||null===p||p!==t||(a=!0,c.selectedItem(e),p=null)}),c.selectedItemUseCallback=!0,i||a||!c.autoSelect()||(c.focusedItem()?c.selectedItem(c.focusedItem()):0<e.length&&(null!==o&&(n=!1,(o=f.a.find(l,function(e){return n&&-1<Object(b.inArray)(e,s)?e:(o===e&&(n=!0),!1)}))&&(t=f.a.find(e,function(e){return o===c.getItemUid(e)}))),c.selectedItem(t||null),c.focusedItem(c.selectedItem()))),(0!==c.iSelectNextHelper||0!==c.iFocusedNextHelper)&&0<e.length&&!c.focusedItem()&&(t=null,0!==c.iFocusedNextHelper&&(t=e[-1===c.iFocusedNextHelper?e.length-1:0]||null),t||0===c.iSelectNextHelper||(t=e[-1===c.iSelectNextHelper?e.length-1:0]||null),t&&(0!==c.iSelectNextHelper&&c.selectedItem(t||null),c.focusedItem(t||null),c.scrollToFocused(),f.a.delay(function(){return c.scrollToFocused()},100)),c.iSelectNextHelper=0,c.iFocusedNextHelper=0)),l=[],u=[],p=d=null})}return s.prototype.itemSelected=function(e){this.isListChecked()?e||(this.oCallbacks.onItemSelect||b.noop)(e||null):e&&(this.oCallbacks.onItemSelect||b.noop)(e)},s.prototype.goDown=function(e){this.newSelectPosition(u.EventKeyCode.Down,!1,e)},s.prototype.goUp=function(e){this.newSelectPosition(u.EventKeyCode.Up,!1,e)},s.prototype.unselect=function(){this.selectedItem(null),this.focusedItem(null)},s.prototype.init=function(e,t){var o=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"all";this.oContentVisible=e,this.oContentScrollable=t,this.oContentVisible&&this.oContentScrollable&&(a()(this.oContentVisible).on("selectstart",function(e){e&&e.preventDefault&&e.preventDefault()}).on("click",this.sItemSelector,function(e){o.actionClick(m.a.dataFor(e.currentTarget),e)}).on("click",this.sItemCheckedSelector,function(e){var t=m.a.dataFor(e.currentTarget);t&&(e&&e.shiftKey?o.actionClick(t,e):(o.focusedItem(t),t.checked(!t.checked())))}),c()("enter",n,function(){return!(o.focusedItem()&&!o.focusedItem().selected()&&(o.actionClick(o.focusedItem()),1))}),c()("ctrl+up, command+up, ctrl+down, command+down",n,function(){return!1}),c()("up, shift+up, down, shift+down, home, end, pageup, pagedown, insert, space",n,function(e,t){if(e&&t&&t.shortcut){var n=0;switch(t.shortcut){case"up":case"shift+up":n=u.EventKeyCode.Up;break;case"down":case"shift+down":n=u.EventKeyCode.Down;break;case"insert":n=u.EventKeyCode.Insert;break;case"space":n=u.EventKeyCode.Space;break;case"home":n=u.EventKeyCode.Home;break;case"end":n=u.EventKeyCode.End;break;case"pageup":n=u.EventKeyCode.PageUp;break;case"pagedown":n=u.EventKeyCode.PageDown}if(0<n)return o.newSelectPosition(n,c.a.shift),!1}return!0}))},s.prototype.autoSelect=function(){return!!(this.oCallbacks.onAutoSelect||b.noopTrue)()},s.prototype.doUpUpOrDownDown=function(e){(this.oCallbacks.onUpUpOrDownDown||b.noopTrue)(!!e)},s.prototype.getItemUid=function(e){var t="",n=this.oCallbacks.onItemGetUid||null;return n&&e&&(t=n(e)),t.toString()},s.prototype.newSelectPosition=function(t,e,n){var o=0,i=!1,a=!1,r=null,s=this.list(),c=s?s.length:0,l=this.focusedItem();if(0<c)if(l){if(l)if(u.EventKeyCode.Down===t||u.EventKeyCode.Up===t||u.EventKeyCode.Insert===t||u.EventKeyCode.Space===t)f.a.each(s,function(e){if(!a)switch(t){case u.EventKeyCode.Up:l===e?a=!0:r=e;break;case u.EventKeyCode.Down:case u.EventKeyCode.Insert:i?(r=e,a=!0):l===e&&(i=!0)}}),r||u.EventKeyCode.Down!==t&&u.EventKeyCode.Up!==t||this.doUpUpOrDownDown(u.EventKeyCode.Up===t);else if(u.EventKeyCode.Home===t||u.EventKeyCode.End===t)u.EventKeyCode.Home===t?r=s[0]:u.EventKeyCode.End===t&&(r=s[s.length-1]);else if(u.EventKeyCode.PageDown===t){for(;o<c;o++)if(l===s[o]){r=s[o=c-1<(o+=10)?c-1:o];break}}else if(u.EventKeyCode.PageUp===t)for(o=c;0<=o;o--)if(l===s[o]){r=s[o=(o-=10)<0?0:o];break}}else u.EventKeyCode.Down===t||u.EventKeyCode.Insert===t||u.EventKeyCode.Space===t||u.EventKeyCode.Home===t||u.EventKeyCode.PageUp===t?r=s[0]:u.EventKeyCode.Up!==t&&u.EventKeyCode.End!==t&&u.EventKeyCode.PageDown!==t||(r=s[s.length-1]);r?(this.focusedItem(r),l&&(e?u.EventKeyCode.Up!==t&&u.EventKeyCode.Down!==t||l.checked(!l.checked()):u.EventKeyCode.Insert!==t&&u.EventKeyCode.Space!==t||l.checked(!l.checked())),!this.autoSelect()&&!n||this.isListChecked()||u.EventKeyCode.Space===t||this.selectedItem(r),this.scrollToFocused()):l&&((!e||u.EventKeyCode.Up!==t&&u.EventKeyCode.Down!==t)&&u.EventKeyCode.Insert!==t&&u.EventKeyCode.Space!==t||l.checked(!l.checked()),this.focusedItem(l))},s.prototype.scrollToFocused=function(){if(!this.oContentVisible||!this.oContentScrollable)return!1;var e=this.list(),t=a()(this.sItemFocusedSelector,this.oContentScrollable),n=t.position(),o=this.oContentVisible.height(),i=t.outerHeight();return e&&e[0]&&e[0].focused()?(this.oContentScrollable.scrollTop(0),!0):!(!n||!(n.top<0||n.top+i>o)||(this.oContentScrollable.scrollTop(n.top<0?this.oContentScrollable.scrollTop()+n.top-20:this.oContentScrollable.scrollTop()+n.top-o+i+20),0))},s.prototype.scrollToTop=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return!(!this.oContentVisible||!this.oContentScrollable||(e||this.oContentScrollable.scrollTop()<50?this.oContentScrollable.scrollTop(0):this.oContentScrollable.stop().animate({scrollTop:0},200),0))},s.prototype.eventClickFunction=function(e,t){var n=0,o=0,i=!1,a=!1,r=[],s=!1,c=null,l="",u=this.getItemUid(e);if(t&&t.shiftKey&&""!==u&&""!==this.sLastUid&&u!==this.sLastUid)for(r=this.list(),s=e.checked(),n=0,o=r.length;n<o;n++)c=r[n],i=!1,(l=this.getItemUid(c))!==this.sLastUid&&l!==u||(i=!0),i&&(a=!a),(a||i)&&c.checked(s);this.sLastUid=""===u?"":u},s.prototype.actionClick=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e){var n=!0;t&&(!t.shiftKey||t.ctrlKey||t.metaKey||t.altKey?!t.ctrlKey&&!t.metaKey||t.shiftKey||t.altKey||(n=!1,this.focusedItem(e),this.selectedItem()&&e!==this.selectedItem()&&this.selectedItem().checked(!0),e.checked(!e.checked())):(n=!1,""===this.sLastUid&&(this.sLastUid=this.getItemUid(e)),e.checked(!e.checked()),this.eventClickFunction(e,t),this.focusedItem(e))),n&&this.selectMessageItem(e)}},s.prototype.on=function(e,t){this.oCallbacks[e]=t},s.prototype.selectMessageItem=function(e){this.focusedItem(e),this.selectedItem(e),this.scrollToFocused()},s}()},function(e,t,n){var o,i,a;void 0===(i="function"==typeof(o=a=function(){function m(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}return function e(h){function f(e,t,n){var o;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(n=m({path:"/"},f.defaults,n)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*n.expires),n.expires=i}n.expires=n.expires?n.expires.toUTCString():"";try{o=JSON.stringify(t),/^[\{\[]/.test(o)&&(t=o)}catch(e){}t=h.write?h.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var a="";for(var r in n)n[r]&&(a+="; "+r,!0!==n[r]&&(a+="="+n[r]));return document.cookie=e+"="+t+a}e||(o={});for(var s=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,l=0;l<s.length;l++){var u=s[l].split("="),d=u.slice(1).join("=");this.json||'"'!==d.charAt(0)||(d=d.slice(1,-1));try{var p=u[0].replace(c,decodeURIComponent);if(d=h.read?h.read(d,p):h(d,p)||d.replace(c,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(e===p){o=d;break}e||(o[p]=d)}catch(e){}}return o}}return(f.set=f).get=function(e){return f.call(f,e)},f.getJSON=function(){return f.apply({json:!0},[].slice.call(arguments))},f.defaults={},f.remove=function(e,t){f(e,"",m(t,{expires:-1}))},f.withConverter=e,f}(function(){})})?o.call(t,n,t,e):o)||(e.exports=i),e.exports=a()},function(e,t){e.exports='<html>\n<head>\n\t<meta charset="utf-8" />\n\t<meta name="viewport" content="user-scalable=no" />\n\t<meta name="apple-mobile-web-app-capable" content="yes" />\n\t<meta name="robots" content="noindex, nofollow, noodp" />\n\t<title>{{title}}</title>\n\t<style>\nhtml, body {\n\tbackground-color: #fff;\n\tfont-size: 13px;\n\tfont-family: arial, sans-serif;\n\tmargin: 0;\n\tpadding: 0;\n}\n\na {color: blue; text-decoration: underline}\na:visited {color: #609}\na:active {color: red}\nblockquote {border-left: 2px solid black; margin: 0; padding: 0px 10px}\n\npre {\n\tmargin: 0px;\n\tpadding: 0px;\n\tfont-family: Monaco, Menlo, Consolas, \'Courier New\', monospace;\n\tbackground: #fff;\n\tborder: none;\n\twhite-space: pre-wrap;\n\tword-wrap: break-word;\n\tword-break: break-all;\n}\n\n.body-wrp {\n\tpadding: 10px;\n}\n\n.body-wrp.html pre {\n\tfont-family: Monaco, Menlo, Consolas, \'Courier New\', monospace;\n\twhite-space: pre-wrap;\n\tword-wrap: break-word;\n\tword-break: normal;\n}\n\n.body-wrp.plain {\n\tpadding: 15px;\n\twhite-space: pre-wrap;\n\tfont-family: Monaco, Menlo, Consolas, \'Courier New\', monospace;\n}\n\n.body-wrp.plain pre {\n\tmargin: 0px;\n\tpadding: 0px;\n\tbackground: #fff;\n\tborder: none;\n\tfont-family: Monaco, Menlo, Consolas, \'Courier New\', monospace;\n\twhite-space: pre-wrap;\n\tword-wrap: break-word;\n\tword-break: normal;\n}\n\n.body-wrp.plain blockquote {\n\tborder-left: 2px solid blue;\n\tcolor: blue;\n}\n\n.body-wrp.plain blockquote blockquote {\n\tborder-left: 2px solid green;\n\tcolor: green;\n}\n\n.body-wrp.plain blockquote blockquote blockquote {\n\tborder-left: 2px solid red;\n\tcolor: red;\n}\n.rl-preview-subject {\n\tfont-size: 16px;\n\tfont-weight: bold;\n\tpadding: 15px;\n}\n.rl-preview-creds-from, .rl-preview-creds-to, .rl-preview-creds-cc {\n\tfont-size: 12px;\n\tpadding: 5px 15px;\n}\n.rl-preview-date {\n\tfloat: right;\n\tfont-size: 12px;\n\tpadding: 10px 15px;\n}\n.rl-preview-section {\n\tpadding: 0;\n\tmargin: 0;\n\tborder-bottom: 1px solid #ccc;\n}\n.rl-preview-hide {\n\tdisplay: none;\n}\n\t</style>\n</head>\n<body>\n\t<div class="rl-preview-section">\n\t\t<div class="rl-preview-subject">{{subject}}</div>\n\t</div>\n\t<div class="rl-preview-section">\n\t\t<div class="rl-preview-date">{{date}}</div>\n\t\t<div class="rl-preview-creds-from">{{fromCreds}}</div>\n\t\t<div class="rl-preview-creds-to">{{toLabel}}: {{toCreds}}</div>\n\t\t<div class="rl-preview-creds-cc {{ccClass}}">{{ccLabel}}: {{ccCreds}}</div>\n\t</div>\n\t<div class="body-wrp {{bodyClass}}">{{html}}</div>\n</body>\n</html>'},function(e,t,n){e.exports={default:n(124),__esModule:!0}},function(e,t,n){n(125),n(135),e.exports=n(92).f("iterator")},function(e,t,n){"use strict";var o=n(126)(!0);n(107)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=o(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var c=n(84),l=n(70);e.exports=function(s){return function(e,t){var n,o,i=String(l(e)),a=c(t),r=i.length;return a<0||r<=a?s?"":void 0:(n=i.charCodeAt(a))<55296||56319<n||a+1===r||(o=i.charCodeAt(a+1))<56320||57343<o?s?i.charAt(a):n:s?i.slice(a,a+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var o=n(86),i=n(63),a=n(91),r={};n(52)(r,n(61)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=o(r,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(50),s=n(60),c=n(87);e.exports=n(42)?Object.defineProperties:function(e,t){s(e);for(var n,o=c(t),i=o.length,a=0;a<i;)r.f(e,n=o[a++],t[n]);return e}},function(e,t,n){var c=n(44),l=n(130),u=n(131);e.exports=function(s){return function(e,t,n){var o,i=c(e),a=l(i.length),r=u(n,a);if(s&&t!=t){for(;r<a;)if((o=i[r++])!=o)return!0}else for(;r<a;r++)if((s||r in i)&&i[r]===t)return s||r||0;return!s&&-1}}},function(e,t,n){var o=n(84),i=Math.min;e.exports=function(e){return 0<e?i(o(e),9007199254740991):0}},function(e,t,n){var o=n(84),i=Math.max,a=Math.min;e.exports=function(e,t){return(e=o(e))<0?i(e+t,0):a(e,t)}},function(e,t,n){var o=n(41).document;e.exports=o&&o.documentElement},function(e,t,n){var o=n(43),i=n(134),a=n(88)("IE_PROTO"),r=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),o(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?r:null}},function(e,t,n){var o=n(70);e.exports=function(e){return Object(o(e))}},function(e,t,n){n(136);for(var o=n(41),i=n(52),a=n(85),r=n(61)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<s.length;c++){var l=s[c],u=o[l],d=u&&u.prototype;d&&!d[r]&&i(d,r,l),a[l]=a.Array}},function(e,t,n){"use strict";var o=n(137),i=n(138),a=n(85),r=n(44);e.exports=n(107)(Array,"Array",function(e,t){this._t=r(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,o("keys"),o("values"),o("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){e.exports={default:n(140),__esModule:!0}},function(e,t,n){n(141),n(146),n(147),n(148),e.exports=n(38).Symbol},function(e,t,n){"use strict";var o=n(41),r=n(43),i=n(42),a=n(58),s=n(108),c=n(142).KEY,l=n(53),u=n(89),d=n(91),p=n(74),h=n(61),f=n(92),m=n(93),b=n(143),g=n(144),y=n(60),v=n(47),S=n(44),O=n(67),w=n(63),T=n(86),C=n(145),A=n(71),E=n(50),F=n(87),j=A.f,N=E.f,R=C.f,I=o.Symbol,L=o.JSON,_=L&&L.stringify,P=h("_hidden"),M=h("toPrimitive"),D={}.propertyIsEnumerable,k=u("symbol-registry"),x=u("symbols"),U=u("op-symbols"),H=Object.prototype,B="function"==typeof I,G=o.QObject,K=!G||!G.prototype||!G.prototype.findChild,V=i&&l(function(){return 7!=T(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a})?function(e,t,n){var o=j(H,t);o&&delete H[t],N(e,t,n),o&&e!==H&&N(H,t,o)}:N,z=function(e){var t=x[e]=T(I.prototype);return t._k=e,t},q=B&&"symbol"==typeof I.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof I},W=function(e,t,n){return e===H&&W(U,t,n),y(e),t=O(t,!0),y(n),r(x,t)?(n.enumerable?(r(e,P)&&e[P][t]&&(e[P][t]=!1),n=T(n,{enumerable:w(0,!1)})):(r(e,P)||N(e,P,w(1,{})),e[P][t]=!0),V(e,t,n)):N(e,t,n)},Y=function(e,t){y(e);for(var n,o=b(t=S(t)),i=0,a=o.length;i<a;)W(e,n=o[i++],t[n]);return e},$=function(e){var t=D.call(this,e=O(e,!0));return!(this===H&&r(x,e)&&!r(U,e))&&(!(t||!r(this,e)||!r(x,e)||r(this,P)&&this[P][e])||t)},J=function(e,t){if(e=S(e),t=O(t,!0),e!==H||!r(x,t)||r(U,t)){var n=j(e,t);return!n||!r(x,t)||r(e,P)&&e[P][t]||(n.enumerable=!0),n}},X=function(e){for(var t,n=R(S(e)),o=[],i=0;n.length>i;)r(x,t=n[i++])||t==P||t==c||o.push(t);return o},Z=function(e){for(var t,n=e===H,o=R(n?U:S(e)),i=[],a=0;o.length>a;)!r(x,t=o[a++])||n&&!r(H,t)||i.push(x[t]);return i};B||(s((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=p(0<arguments.length?arguments[0]:void 0),n=function(e){this===H&&n.call(U,e),r(this,P)&&r(this[P],t)&&(this[P][t]=!1),V(this,t,w(1,e))};return i&&K&&V(H,t,{configurable:!0,set:n}),z(t)}).prototype,"toString",function(){return this._k}),A.f=J,E.f=W,n(111).f=C.f=X,n(72).f=$,n(110).f=Z,i&&!n(73)&&s(H,"propertyIsEnumerable",$,!0),f.f=function(e){return z(h(e))}),a(a.G+a.W+a.F*!B,{Symbol:I});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Q.length>ee;)h(Q[ee++]);for(var te=F(h.store),ne=0;te.length>ne;)m(te[ne++]);a(a.S+a.F*!B,"Symbol",{for:function(e){return r(k,e+="")?k[e]:k[e]=I(e)},keyFor:function(e){if(!q(e))throw TypeError(e+" is not a symbol!");for(var t in k)if(k[t]===e)return t},useSetter:function(){K=!0},useSimple:function(){K=!1}}),a(a.S+a.F*!B,"Object",{create:function(e,t){return void 0===t?T(e):Y(T(e),t)},defineProperty:W,defineProperties:Y,getOwnPropertyDescriptor:J,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),L&&a(a.S+a.F*(!B||l(function(){var e=I();return"[null]"!=_([e])||"{}"!=_({a:e})||"{}"!=_(Object(e))})),"JSON",{stringify:function(e){for(var t,n,o=[e],i=1;arguments.length>i;)o.push(arguments[i++]);if(n=t=o[1],(v(t)||void 0!==e)&&!q(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!q(t))return t}),o[1]=t,_.apply(L,o)}}),I.prototype[M]||n(52)(I.prototype,M,I.prototype.valueOf),d(I,"Symbol"),d(Math,"Math",!0),d(o.JSON,"JSON",!0)},function(e,t,n){var o=n(74)("meta"),i=n(47),a=n(43),r=n(50).f,s=0,c=Object.isExtensible||function(){return!0},l=!n(53)(function(){return c(Object.preventExtensions({}))}),u=function(e){r(e,o,{value:{i:"O"+ ++s,w:{}}})},d=e.exports={KEY:o,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,o)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[o].i},getWeak:function(e,t){if(!a(e,o)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[o].w},onFreeze:function(e){return l&&d.NEED&&c(e)&&!a(e,o)&&u(e),e}}},function(e,t,n){var s=n(87),c=n(110),l=n(72);e.exports=function(e){var t=s(e),n=c.f;if(n)for(var o,i=n(e),a=l.f,r=0;i.length>r;)a.call(e,o=i[r++])&&t.push(o);return t}},function(e,t,n){var o=n(83);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,t,n){var o=n(44),i=n(111).f,a={}.toString,r="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return r&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return r.slice()}}(e):i(o(e))}},function(e,t){},function(e,t,n){n(93)("asyncIterator")},function(e,t,n){n(93)("observable")},function(e,t,n){e.exports={default:n(150),__esModule:!0}},function(e,t,n){n(151),e.exports=n(38).Object.setPrototypeOf},function(e,t,n){var o=n(58);o(o.S,"Object",{setPrototypeOf:n(152).set})},function(e,t,i){var n=i(47),o=i(60),a=function(e,t){if(o(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,o){try{(o=i(81)(Function.call,i(71).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return a(e,t),n?e.__proto__=t:o(e,t),e}}({},!1):void 0),check:a}},function(e,t,n){e.exports={default:n(154),__esModule:!0}},function(e,t,n){n(155);var o=n(38).Object;e.exports=function(e,t){return o.create(e,t)}},function(e,t,n){var o=n(58);o(o.S,"Object",{create:n(86)})},function(e,t,n){"use strict";n.r(t),n.d(t,"AccountPopupView",function(){return N}),n.d(t,"default",function(){return N});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(0),T=n(2),C=n(10),A=n(17),E=n(20),F=n(9),j=n(24),N=(o=Object(F.popup)({name:"View/Popup/Account",templateID:"PopupsAccount"}),i=Object(F.command)(function(e){return!e.submitRequest()}),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.isNew=O.a.observable(!0),e.email=O.a.observable(""),e.password=O.a.observable(""),e.emailError=O.a.observable(!1),e.passwordError=O.a.observable(!1),e.email.subscribe(function(){e.emailError(!1)}),e.password.subscribe(function(){e.passwordError(!1)}),e.submitRequest=O.a.observable(!1),e.submitError=O.a.observable(""),e.submitErrorAdditional=O.a.observable(""),e.emailFocus=O.a.observable(!1),e}return S()(n,t),n.prototype.addAccountCommand=function(){var n=this;return this.emailError(""===Object(T.trim)(this.email())),this.passwordError(""===Object(T.trim)(this.password())),!this.emailError()&&!this.passwordError()&&(this.submitRequest(!0),A.a.accountSetup(function(e,t){n.submitRequest(!1),w.StorageResultType.Success===e&&t?t.Result?(Object(E.a)().accountsAndIdentities(),n.cancelCommand()):(n.submitError(t.ErrorCode?Object(C.getNotification)(t.ErrorCode):Object(C.getNotification)(w.Notification.UnknownError)),t.ErrorMessageAdditional&&n.submitErrorAdditional(t.ErrorMessageAdditional)):(n.submitError(Object(C.getNotification)(w.Notification.UnknownError)),n.submitErrorAdditional(""))},this.email(),this.password(),this.isNew()),!0)},n.prototype.clearPopup=function(){this.isNew(!0),this.email(""),this.password(""),this.emailError(!1),this.passwordError(!1),this.submitRequest(!1),this.submitError(""),this.submitErrorAdditional("")},n.prototype.onShow=function(e){this.clearPopup(),e&&e.canBeEdit()&&(this.isNew(!1),this.email(e.email))},n.prototype.onShowWithDelay=function(){this.emailFocus(!0)},n}(j.a)).prototype,c="addAccountCommand",l=[i],u=f()(r.prototype,"addAccountCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"IdentityPopupView",function(){return R}),n.d(t,"default",function(){return R});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(0),T=n(6),C=n(2),A=n(10),E=n(17),F=n(20),j=n(9),N=n(24),R=(o=Object(j.popup)({name:"View/Popup/Identity",templateID:"PopupsIdentity"}),i=Object(j.command)(function(e){return!e.submitRequest()}),o((s=(r=function(e){function n(){b()(this,n);var t=y()(this,e.call(this));return t.id="",t.edit=O.a.observable(!1),t.owner=O.a.observable(!1),t.email=O.a.observable("").validateEmail(),t.email.focused=O.a.observable(!1),t.name=O.a.observable(""),t.name.focused=O.a.observable(!1),t.replyTo=O.a.observable("").validateSimpleEmail(),t.replyTo.focused=O.a.observable(!1),t.bcc=O.a.observable("").validateSimpleEmail(),t.bcc.focused=O.a.observable(!1),t.signature=O.a.observable(""),t.signatureInsertBefore=O.a.observable(!1),t.showBcc=O.a.observable(!1),t.showReplyTo=O.a.observable(!1),t.submitRequest=O.a.observable(!1),t.submitError=O.a.observable(""),t.bcc.subscribe(function(e){!1===t.showBcc()&&0<e.length&&t.showBcc(!0)}),t.replyTo.subscribe(function(e){!1===t.showReplyTo()&&0<e.length&&t.showReplyTo(!0)}),t}return S()(n,e),n.prototype.addOrEditIdentityCommand=function(){var n=this;return this.signature&&this.signature.__fetchEditorValue&&this.signature.__fetchEditorValue(),this.email.hasError()||this.email.hasError(""===Object(C.trim)(this.email())),this.email.hasError()?(this.owner()||this.email.focused(!0),!1):this.replyTo.hasError()?(this.replyTo.focused(!0),!1):this.bcc.hasError()?(this.bcc.focused(!0),!1):(this.submitRequest(!0),E.a.identityUpdate(function(e,t){n.submitRequest(!1),w.StorageResultType.Success===e&&t?t.Result?(Object(F.a)().accountsAndIdentities(),n.cancelCommand()):t.ErrorCode&&n.submitError(Object(A.getNotification)(t.ErrorCode)):n.submitError(Object(A.getNotification)(w.Notification.UnknownError))},this.id,this.email(),this.name(),this.replyTo(),this.bcc(),this.signature(),this.signatureInsertBefore()),!0)},n.prototype.clearPopup=function(){this.id="",this.edit(!1),this.owner(!1),this.name(""),this.email(""),this.replyTo(""),this.bcc(""),this.signature(""),this.signatureInsertBefore(!1),this.email.hasError(!1),this.replyTo.hasError(!1),this.bcc.hasError(!1),this.showBcc(!1),this.showReplyTo(!1),this.submitRequest(!1),this.submitError("")},n.prototype.onShow=function(e){this.clearPopup(),e?(this.edit(!0),this.id=e.id()||"",this.name(e.name()),this.email(e.email()),this.replyTo(e.replyTo()),this.bcc(e.bcc()),this.signature(e.signature()),this.signatureInsertBefore(e.signatureInsertBefore()),this.owner(""===this.id)):this.id=Object(C.fakeMd5)()},n.prototype.onShowWithDelay=function(){this.owner()||T.bMobileDevice||this.email.focused(!0)},n.prototype.onHideWithDelay=function(){this.clearPopup()},n}(N.a)).prototype,c="addOrEditIdentityCommand",l=[i],u=f()(r.prototype,"addOrEditIdentityCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t){e.exports='<span class="rl-cmd-clr-error">Command not found:</span> {{ cmd }}'},function(e,t){e.exports=' <span class="rl-cmd-clr-info">commands:</span> {{ commands }}'},function(e,t){e.exports='theme <span class="rl-cmd-clr-info">[{{ themes }}]</span>'},function(e,t){e.exports='lang <span class="rl-cmd-clr-info">[{{ langs }}]</span>'},function(e,t){e.exports=' <span class="rl-cmd-clr-info">version:</span> {{ version }}'},function(e,t){e.exports='<span class="rl-cmd-clr-success">&gt;</span> {{ cmd }}'},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(2),u=n(0),d=n(27),p=function(n){function o(e){i()(this,o);var t=r()(this,n.call(this));return t.element=e.element||null,t.value=e.value&&e.value.subscribe?e.value:null,t.element&&(t.value?(t.element.css("display","inline-block"),e.verticalAlign&&t.element.css("vertical-align",e.verticalAlign),t.setState(t.value()),t.disposable.push(t.value.subscribe(t.setState,t))):t.element.hide()),t}return c()(o,n),o.prototype.setState=function(e){switch(Object(l.pInt)(e)){case u.SaveSettingsStep.TrueResult:this.element.find(".animated,.error").hide().removeClass("visible").end().find(".success").show().addClass("visible");break;case u.SaveSettingsStep.FalseResult:this.element.find(".animated,.success").hide().removeClass("visible").end().find(".error").show().addClass("visible");break;case u.SaveSettingsStep.Animate:this.element.find(".error,.success").hide().removeClass("visible").end().find(".animated").show().addClass("visible");break;case u.SaveSettingsStep.Idle:default:this.element.find(".animated").hide().end().find(".error,.success").removeClass("visible")}},o}(d.a);t.default=Object(d.b)(p,"SaveTriggerComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(27),u=function(e){function t(){return i()(this,t),r()(this,e.apply(this,arguments))}return c()(t,e),t}(n(48).a);t.default=Object(l.b)(u,"InputComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(10),u=n(2),d=n(27),p=function(n){function o(e){i()(this,o);var t=r()(this,n.call(this,e));return t.options=e.options||"",t.optionsText=e.optionsText||null,t.optionsValue=e.optionsValue||null,t.optionsCaption=e.optionsCaption||null,t.optionsCaption&&(t.optionsCaption=Object(l.i18n)(t.optionsCaption)),t.defautOptionsAfterRender=u.defautOptionsAfterRender,t}return c()(o,n),o}(n(48).a);t.default=Object(d.b)(p,"SelectComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(2),u=n(27),d=function(n){function o(e){i()(this,o);var t=r()(this,n.call(this,e));return t.rows=e.rows||5,t.spellcheck=!Object(l.isUnd)(e.spellcheck)&&!!e.spellcheck,t}return c()(o,n),o}(n(48).a);t.default=Object(u.b)(d,"TextAreaComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(27),u=function(e){function t(){return i()(this,t),r()(this,e.apply(this,arguments))}return c()(t,e),t}(n(48).a);t.default=Object(l.b)(u,"DateComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),a=n.n(o),i=n(11),r=n.n(i),s=n(12),c=n.n(s),l=n(7),u=n.n(l),d=n(27),p=function(o){function i(e){a()(this,i);var t=r()(this,o.call(this));if(e.component&&e.component.templateNodes&&e.element&&e.element[0]&&e.element[0].outerHTML){var n=e.element[0].outerHTML;(n=n?n.replace(/<x-script/i,"<script").replace(/<b><\/b><\/x-script>/i,"<\/script>"):"")?(e.element.text(""),e.element.replaceWith(u()(n).text(e.component.templateNodes[0]&&e.component.templateNodes[0].nodeValue?e.component.templateNodes[0].nodeValue:""))):e.element.remove()}return t}return c()(i,o),i}(d.a);t.default=Object(d.b)(p,"ScriptComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(4),u=n.n(l),d=n(1),p=n(27),h=function(n){function o(e){i()(this,o);var t=r()(this,n.call(this,e));return t.animationBox=d.a.observable(!1).extend({falseTimeout:200}),t.animationCheckmark=d.a.observable(!1).extend({falseTimeout:200}),t.animationBoxSetTrue=u.a.bind(t.animationBoxSetTrue,t),t.animationCheckmarkSetTrue=u.a.bind(t.animationCheckmarkSetTrue,t),t.disposable.push(t.value.subscribe(function(e){t.triggerAnimation(e)},t)),t}return c()(o,n),o.prototype.animationBoxSetTrue=function(){this.animationBox(!0)},o.prototype.animationCheckmarkSetTrue=function(){this.animationCheckmark(!0)},o.prototype.triggerAnimation=function(e){e?(this.animationBoxSetTrue(),u.a.delay(this.animationCheckmarkSetTrue,200)):(this.animationCheckmarkSetTrue(),u.a.delay(this.animationBoxSetTrue,200))},o}(n(76).a);t.default=Object(p.b)(h,"CheckboxMaterialDesignComponent")},function(e,t,n){"use strict";n.r(t);var o=n(8),i=n.n(o),a=n(11),r=n.n(a),s=n(12),c=n.n(s),l=n(27),u=n(4),d=n.n(u),p=n(1),h=n(2),f=function(e){function t(){return i()(this,t),r()(this,e.apply(this,arguments))}return c()(t,e),t}(function(n){function o(e){i()(this,o);var t=r()(this,n.call(this));return t.values=p.a.observableArray([]),t.value=e.value,!Object(h.isUnd)(t.value)&&t.value.subscribe||(t.value=p.a.observable("")),t.inline=!Object(h.isUnd)(e.inline)&&e.inline,t.readOnly=!Object(h.isUnd)(e.readOnly)&&!!e.readOnly,e.values&&t.values(d.a.map(e.values,function(e,t){return{label:e,value:t}})),t.click=d.a.bind(t.click,t),t}return c()(o,n),o.prototype.click=function(e){!this.readOnly&&e&&this.value(e.value)},o}(l.a));t.default=Object(l.b)(f,"RadioComponent")},function(e,t,c){"use strict";c.r(t);var n,o,i,a,r,s,l,u,d=c(8),p=c.n(d),h=c(11),f=c.n(h),m=c(12),b=c.n(m),g=c(3),y=c.n(g),v=c(4),S=c.n(v),O=c(7),w=c.n(O),T=c(55),C=c.n(T),A=c(2),E=c(0),F=c(6),j=c(23),N=c(29),R=c(34),I=c(15),L=c(16),_=c(22),P=c(10),M=c(25),D=c(26),k=c(28),x=c(62),U=c(31),H=c(57),B=c(56),G=c(1),K=new(function(){function e(){p()(this,e),this.templates=G.a.observableArray([]),this.templates.loading=G.a.observable(!1).extend({throttle:100}),this.templatesNames=G.a.observableArray([]).extend({throttle:1e3}),this.templatesNames.skipFirst=!0,this.subscribers()}return e.prototype.subscribers=function(){var t=this;this.templates.subscribe(function(e){t.templatesNames(S.a.compact(S.a.map(e,function(e){return e?e.name:null})))})},e}()),V=c(13),z=c(30),q=c(14),W=new(function(){function e(){var n=this;p()(this,e),this.quota=G.a.observable(0),this.usage=G.a.observable(0),this.percentage=G.a.computed(function(){var e=n.quota(),t=n.usage();return 0<e?y.a.Math.ceil(t/e*100):0})}return e.prototype.populateData=function(e,t){this.quota(e*E.Magics.BitLength1024),this.usage(t*E.Magics.BitLength1024)},e}()),Y=c(33),$=c(5),J=c(68),X=c(17),Z=c(51),Q=c(45),ee=c(36),te=function(i){function a(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;p()(this,a);var o=f()(this,i.call(this,"AccountModel"));return o.email=e,o.count=G.a.observable(n),o.deleteAccess=G.a.observable(!1),o.canBeDeleted=G.a.observable(!!t),o.canBeEdit=o.canBeDeleted,o}return b()(a,i),a.prototype.changeAccountLink=function(){return Object(L.i)(this.email)},a}(ee.a),ne=function(o){function i(e,t){p()(this,i);var n=f()(this,o.call(this,"IdentityModel"));return n.id=G.a.observable(e||""),n.email=G.a.observable(t),n.name=G.a.observable(""),n.replyTo=G.a.observable(""),n.bcc=G.a.observable(""),n.signature=G.a.observable(""),n.signatureInsertBefore=G.a.observable(!1),n.deleteAccess=G.a.observable(!1),n.canBeDeleted=G.a.computed(function(){return""!==n.id()}),n}return b()(i,o),i.prototype.formattedName=function(){var e=this.name(),t=this.email();return""!==e?e+" ("+t+")":t},i}(ee.a),oe=function(i){function a(e,t,n){p()(this,a);var o=f()(this,i.call(this,"TemplateModel"));return o.id=e,o.name=t,o.body=n,o.populated=!0,o.deleteAccess=G.a.observable(!1),o}return b()(a,i),a.prototype.parse=function(e){var t=!1;return e&&"Object/Template"===e["@Object"]&&(this.id=Object(A.pString)(e.ID),this.name=Object(A.pString)(e.Name),this.body=Object(A.pString)(e.Body),this.populated=!!e.Populated,t=!0),t},a}(ee.a),ie=function(u){function d(e,t,n,o,i,a,r,s,c){p()(this,d);var l=f()(this,u.call(this,"OpenPgpKeyModel"));return l.index=e,l.id=n,l.ids=Object(A.isNonEmptyArray)(o)?o:[n],l.guid=t,l.user="",l.users=i,l.email="",l.emails=a,l.armor=s,l.isPrivate=!!r,l.selectUser(c),l.deleteAccess=G.a.observable(!1),l}return b()(d,u),d.prototype.getNativeKey=function(){var e=null;try{if((e=z.a.openpgp.key.readArmored(this.armor))&&!e.err&&e.keys&&e.keys[0])return e}catch(e){Object(A.log)(e)}return null},d.prototype.getNativeKeys=function(){var e=this.getNativeKey();return e&&e.keys?e.keys:null},d.prototype.select=function(e,t){if(this[t]){var n=this[t].indexOf(e);-1!==n&&(this.user=this.users[n],this.email=this.emails[n])}},d.prototype.selectUser=function(e){this.select(e,"users")},d.prototype.selectEmail=function(e){this.select(e,"emails")},d}(ee.a),ae=c(65),re=c(18),se=c.n(re),ce=c(32),le=c(20),ue=c(9),de=c(24);function pe(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}var he,fe,me,be,ge,ye,ve,Se,Oe,we,Te,Ce,Ae,Ee,Fe,je=(n=Object(ue.view)({name:["View/App/Login","View/User/Login"],type:ue.ViewType.Center,templateID:"Login"}),o=Object(ue.command)(function(e){return!e.submitRequest()&&e.facebookLoginEnabled()}),i=Object(ue.command)(function(e){return!e.submitRequest()&&e.googleLoginEnabled()}),a=Object(ue.command)(function(e){return!e.submitRequest()&&e.googleFastLoginEnabled()}),r=Object(ue.command)(function(e){return!e.submitRequest()&&e.twitterLoginEnabled()}),s=Object(ue.command)(function(e){return!e.submitRequest()}),n((pe((u=function(e){function t(){p()(this,t);var o=f()(this,e.call(this));return o.hideSubmitButton=!!$.appSettingsGet("hideSubmitButton"),o.welcome=G.a.observable(!!$.settingsGet("UseLoginWelcomePage")),o.email=G.a.observable(""),o.password=G.a.observable(""),o.signMe=G.a.observable(!1),o.additionalCode=G.a.observable(""),o.additionalCode.error=G.a.observable(!1),o.additionalCode.errorAnimation=G.a.observable(!1).extend({falseTimeout:500}),o.additionalCode.focused=G.a.observable(!1),o.additionalCode.visibility=G.a.observable(!1),o.additionalCodeSignMe=G.a.observable(!1),o.logoImg=Object(A.trim)($.settingsGet("LoginLogo")),o.loginPowered=!!$.settingsGet("LoginPowered"),o.loginDescription=Object(A.trim)($.settingsGet("LoginDescription")),o.mobile=!!$.appSettingsGet("mobile"),o.mobileDevice=!!$.appSettingsGet("mobileDevice"),o.forgotPasswordLinkUrl=$.appSettingsGet("forgotPasswordLinkUrl"),o.registrationLinkUrl=$.appSettingsGet("registrationLinkUrl"),o.emailError=G.a.observable(!1),o.passwordError=G.a.observable(!1),o.emailErrorAnimation=G.a.observable(!1).extend({falseTimeout:500}),o.passwordErrorAnimation=G.a.observable(!1).extend({falseTimeout:500}),o.formHidden=G.a.observable(!1),o.formError=G.a.computed(function(){return o.emailErrorAnimation()||o.passwordErrorAnimation()||o.additionalCode.visibility()&&o.additionalCode.errorAnimation()}),o.emailFocus=G.a.observable(!1),o.passwordFocus=G.a.observable(!1),o.email.subscribe(function(){o.emailError(!1),o.additionalCode(""),o.additionalCode.visibility(!1)}),o.password.subscribe(function(){o.passwordError(!1)}),o.additionalCode.subscribe(function(){o.additionalCode.error(!1)}),o.additionalCode.visibility.subscribe(function(){o.additionalCode.error(!1)}),o.emailError.subscribe(function(e){o.emailErrorAnimation(!!e)}),o.passwordError.subscribe(function(e){o.passwordErrorAnimation(!!e)}),o.additionalCode.error.subscribe(function(e){o.additionalCode.errorAnimation(!!e)}),o.submitRequest=G.a.observable(!1),o.submitError=G.a.observable(""),o.submitErrorAddidional=G.a.observable(""),o.submitError.subscribe(function(e){""===e&&o.submitErrorAddidional("")}),o.allowLanguagesOnLogin=D.a.allowLanguagesOnLogin,o.langRequest=G.a.observable(!1),o.language=ce.a.language,o.languages=ce.a.languages,o.bSendLanguage=!1,o.languageFullName=G.a.computed(function(){return Object(A.convertLangName)(o.language())}),o.signMeType=G.a.observable(E.LoginSignMeType.Unused),o.signMeType.subscribe(function(e){o.signMe(E.LoginSignMeType.DefaultOn===e)}),o.signMeVisibility=G.a.computed(function(){return E.LoginSignMeType.Unused!==o.signMeType()}),o.facebookLoginEnabled=G.a.observable(!1),o.googleLoginEnabled=G.a.observable(!1),o.googleFastLoginEnabled=G.a.observable(!1),o.twitterLoginEnabled=G.a.observable(!1),o.socialLoginEnabled=G.a.computed(function(){var e=o.facebookLoginEnabled(),t=o.googleLoginEnabled(),n=o.twitterLoginEnabled();return e||t||n}),$.settingsGet("AdditionalLoginError")&&!o.submitError()&&o.submitError($.settingsGet("AdditionalLoginError")),o}return b()(t,e),t.prototype.windowOpenFeatures=function(e){return"left=200,top=100,width="+e+",height="+e+",menubar=no,status=no,resizable=yes,scrollbars=yes"},t.prototype.facebookCommand=function(){return y.a.open(Object(L.A)(),"Facebook",this.windowOpenFeatures(500)),!0},t.prototype.googleCommand=function(){return y.a.open(Object(L.B)(),"Google",this.windowOpenFeatures(550)),!0},t.prototype.googleFastCommand=function(){return y.a.open(Object(L.B)(!0),"Google",this.windowOpenFeatures(550)),!0},t.prototype.twitterCommand=function(){return y.a.open(Object(L.C)(),"Twitter",this.windowOpenFeatures(500)),!0},t.prototype.submitCommand=function(){var n=this;if(Object(A.triggerAutocompleteInputChange)(),this.emailError(!1),this.passwordError(!1),this.emailError(""===Object(A.trim)(this.email())),this.passwordError(""===Object(A.trim)(this.password())),this.additionalCode.visibility()&&(this.additionalCode.error(!1),this.additionalCode.error(""===Object(A.trim)(this.additionalCode()))),this.emailError()||this.passwordError()||this.additionalCode.visibility()&&this.additionalCode.error()){switch(!0){case this.emailError():this.emailFocus(!0);break;case this.passwordError():this.passwordFocus(!0);break;case this.additionalCode.visibility()&&this.additionalCode.error():this.additionalCode.focused(!0)}return!1}var e,o=0,i="";return N.f("user-login-submit",[function(e,t){o=e||0,i=t||""}]),0<o?(this.submitError(Object(P.getNotification)(o)),!1):""!==i?(this.submitError(i),!1):(this.submitRequest(!0),F.$win.trigger("rl.tooltips.diactivate"),e=this.password(),X.a.login(function(e,t){F.$win.trigger("rl.tooltips.diactivate"),F.$win.trigger("rl.tooltips.activate"),E.StorageResultType.Success===e&&t&&"Login"===t.Action?t.Result?t.TwoFactorAuth?(n.additionalCode(""),n.additionalCode.visibility(!0),n.submitRequest(!1),S.a.delay(function(){return n.additionalCode.focused(!0)},E.Magics.Time100ms)):t.Admin?Object(le.a)().redirectToAdminPanel():Object(le.a)().loginAndLogoutReload(!1):t.ErrorCode?(n.submitRequest(!1),-1<Object(A.inArray)(t.ErrorCode,[E.Notification.InvalidInputArgument])&&(t.ErrorCode=E.Notification.AuthError),n.submitError(Object(P.getNotificationFromResponse)(t)),""===n.submitError()?n.submitError(Object(P.getNotification)(E.Notification.UnknownError)):t.ErrorMessageAdditional&&n.submitErrorAddidional(t.ErrorMessageAdditional)):n.submitRequest(!1):(n.submitRequest(!1),n.submitError(Object(P.getNotification)(E.Notification.UnknownError)))},n.email(),"",e,!!n.signMe(),n.bSendLanguage?n.language():"",n.additionalCode.visibility()?n.additionalCode():"",!!n.additionalCode.visibility()&&!!n.additionalCodeSignMe()),Y.b(E.ClientSideKeyName.LastSignMe,n.signMe()?"-1-":"-0-"),!0)},t.prototype.displayMainForm=function(){this.welcome(!1)},t.prototype.onShow=function(){Object(ue.routeOff)()},t.prototype.onShowWithDelay=function(){""!==this.email()&&""!==this.password()?this.passwordFocus(!0):""===this.email()?this.emailFocus(!0):""===this.password()?this.passwordFocus(!0):this.emailFocus(!0)},t.prototype.onHide=function(){this.emailFocus(!1),this.passwordFocus(!1)},t.prototype.onBuild=function(){var t=this,e=Y.a(E.ClientSideKeyName.LastSignMe),n=($.settingsGet("SignMe")||"unused").toLowerCase(),o=$.appSettingsGet("jsHash"),i=function(e){0===(e=Object(A.pInt)(e))?(t.submitRequest(!0),Object(le.a)().loginAndLogoutReload(!1)):t.submitError(Object(P.getNotification)(e))};switch(this.facebookLoginEnabled(!!$.settingsGet("AllowFacebookSocial")),this.twitterLoginEnabled(!!$.settingsGet("AllowTwitterSocial")),this.googleLoginEnabled(!!$.settingsGet("AllowGoogleSocial")&&!!$.settingsGet("AllowGoogleSocialAuth")),this.googleFastLoginEnabled(!!$.settingsGet("AllowGoogleSocial")&&!!$.settingsGet("AllowGoogleSocialAuthFast")),n){case E.LoginSignMeTypeAsString.DefaultOff:case E.LoginSignMeTypeAsString.DefaultOn:switch(this.signMeType(E.LoginSignMeTypeAsString.DefaultOn===n?E.LoginSignMeType.DefaultOn:E.LoginSignMeType.DefaultOff),e){case"-1-":this.signMeType(E.LoginSignMeType.DefaultOn);break;case"-0-":this.signMeType(E.LoginSignMeType.DefaultOff)}break;case E.LoginSignMeTypeAsString.Unused:default:this.signMeType(E.LoginSignMeType.Unused)}this.email(D.a.devEmail),this.password(D.a.devPassword),(this.googleLoginEnabled()||this.googleFastLoginEnabled())&&(y.a["rl_"+o+"_google_login_service"]=i),this.facebookLoginEnabled()&&(y.a["rl_"+o+"_facebook_login_service"]=i),this.twitterLoginEnabled()&&(y.a["rl_"+o+"_twitter_login_service"]=i),S.a.delay(function(){ce.a.language.subscribe(function(e){t.langRequest(!0),Object(P.reload)(!1,e).then(function(){t.langRequest(!1),t.bSendLanguage=!0},function(){t.langRequest(!1)})})},E.Magics.Time50ms),Object(A.triggerAutocompleteInputChange)(!0)},t.prototype.submitForm=function(){this.submitCommand()},t.prototype.selectLanguage=function(){Object(ue.showScreenPopup)(c(112),[this.language,this.languages(),ce.a.userLanguage()])},t.prototype.selectLanguageOnTab=function(e){var t=this;return!!e||(S.a.delay(function(){t.emailFocus(!0)},E.Magics.Time50ms),!1)},t}(de.a)).prototype,"facebookCommand",[o],se()(u.prototype,"facebookCommand"),u.prototype),pe(u.prototype,"googleCommand",[i],se()(u.prototype,"googleCommand"),u.prototype),pe(u.prototype,"googleFastCommand",[a],se()(u.prototype,"googleFastCommand"),u.prototype),pe(u.prototype,"twitterCommand",[r],se()(u.prototype,"twitterCommand"),u.prototype),pe(u.prototype,"submitCommand",[s],se()(u.prototype,"submitCommand"),u.prototype),l=u))||l),Ne=function(e){function t(){return p()(this,t),f()(this,e.call(this,"login",[je]))}return b()(t,e),t.prototype.onShow=function(){Object(le.a)().setWindowTitle("")},t}(ae.a),Re=c(19),Ie=c.n(Re),Le=function(t){function n(){p()(this,n);var e=f()(this,t.call(this));return e.logoImg=Object(A.trim)($.settingsGet("UserLogo")),e.logoTitle=Object(A.trim)($.settingsGet("UserLogoTitle")),e.mobile=!!$.appSettingsGet("mobile"),e.mobileDevice=!!$.appSettingsGet("mobileDevice"),e.allowSettings=!!$.capa(E.Capa.Settings),e.allowHelp=!!$.capa(E.Capa.Help),e.currentAudio=D.a.currentAudio,e.accountEmail=U.a.email,e.accounts=U.a.accounts,e.accountsUnreadCount=U.a.accountsUnreadCount,e.accountMenuDropdownTrigger=G.a.observable(!1),e.capaAdditionalAccounts=G.a.observable($.capa(E.Capa.AdditionalAccounts)),e.addAccountClick=S.a.bind(e.addAccountClick,e),_.b("audio.stop",function(){return D.a.currentAudio("")}),_.b("audio.start",function(e){return D.a.currentAudio(e)}),e}return b()(n,t),n.prototype.stopPlay=function(){_.a("audio.api.stop")},n.prototype.accountClick=function(e,t){return e&&t&&!Object(A.isUnd)(t.which)&&1===t.which&&(U.a.accounts.loading(!0),S.a.delay(function(){return U.a.accounts.loading(!1)},E.Magics.Time1s)),!0},n.prototype.emailTitle=function(){return U.a.email()},n.prototype.settingsClick=function(){$.capa(E.Capa.Settings)&&Object(ue.setHash)(Object(L.z)())},n.prototype.settingsHelp=function(){$.capa(E.Capa.Help)&&Object(ue.showScreenPopup)(c(175))},n.prototype.addAccountClick=function(){this.capaAdditionalAccounts()&&Object(ue.showScreenPopup)(c(156))},n.prototype.logoutClick=function(){Object(le.a)().logout()},n.prototype.onBuild=function(){var e=this;Ie()("`",[E.KeyState.MessageList,E.KeyState.MessageView,E.KeyState.Settings],function(){e.viewModelVisibility()&&(q.a.messageFullScreenMode(!1),e.accountMenuDropdownTrigger(!0))}),Ie()("shift+/",[E.KeyState.MessageList,E.KeyState.MessageView,E.KeyState.Settings],function(){return!e.viewModelVisibility()||(Object(ue.showScreenPopup)(c(175)),!1)})},n}(de.a),_e=Object(ue.view)({name:"View/User/MailBox/SystemDropDown",type:ue.ViewType.Right,templateID:"SystemDropDown"})(he=function(e){function t(){return p()(this,t),f()(this,e.apply(this,arguments))}return b()(t,e),t}(Le))||he,Pe=Object(ue.view)({name:"View/User/MailBox/FolderList",type:ue.ViewType.Left,templateID:"MailFolderList"})(fe=function(t){function n(){p()(this,n);var e=f()(this,t.call(this));return e.oContentVisible=null,e.oContentScrollable=null,e.composeInEdit=D.a.composeInEdit,e.messageList=q.a.messageList,e.folderList=V.a.folderList,e.folderListSystem=V.a.folderListSystem,e.foldersChanging=V.a.foldersChanging,e.moveAction=F.moveAction,e.foldersListWithSingleInboxRootFolder=V.a.foldersListWithSingleInboxRootFolder,e.leftPanelDisabled=F.leftPanelDisabled,e.iDropOverTimer=0,e.allowComposer=!!$.capa(E.Capa.Composer),e.allowContacts=!!D.a.contactsIsAllowed(),e.allowFolders=!!$.capa(E.Capa.Folders),e.folderListFocused=G.a.computed(function(){return E.Focused.FolderList===D.a.focusedState()}),e.isInboxStarred=G.a.computed(function(){return V.a.currentFolder()&&V.a.currentFolder().isInbox()&&-1<Object(A.trim)(q.a.messageListSearch()).indexOf("is:flagged")}),e}return b()(n,t),n.prototype.onBuild=function(a){this.oContentVisible=w()(".b-content",a),this.oContentScrollable=w()(".content",this.oContentVisible);var r=this,s=$.appSettingsGet("mobile"),t=function(e,t,n){var o=Object(F.moveAction)();s&&Object(F.leftPanelDisabled)(!0),t.preventDefault(),n&&t.stopPropagation();var i=G.a.dataFor(e);i&&(o?(Object(F.moveAction)(!1),Object(le.a)().moveMessagesToFolder(V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),i.fullNameRaw,!1)):(E.Layout.NoPreview===k.a.layout()&&q.a.message(null),i.fullNameRaw===V.a.currentFolderFullNameRaw()&&Object(I.q)(i.fullNameRaw,""),n?Object(ue.setHash)(Object(L.o)(i.fullNameHash,1,"is:flagged")):Object(ue.setHash)(Object(L.o)(i.fullNameHash))),D.a.focusedState(E.Focused.MessageList))};a.on("click",".b-folders .e-item .e-link .e-collapsed-sign",function(e){var t=G.a.dataFor(this);if(t&&e){var n=t.collapsed();Object(le.a)().setExpandedFolder(t.fullNameHash,n),t.collapsed(!n),e.preventDefault(),e.stopPropagation()}}).on("click",".b-folders .e-item .e-link.selectable .inbox-star-icon",function(e){t(this,e,!r.isInboxStarred())}).on("click",".b-folders .e-item .e-link.selectable",function(e){t(this,e,!1)}),Ie()("up, down",E.KeyState.FolderList,function(e,t){var n=t&&"up"===t.shortcut?E.EventKeyCode.Up:E.EventKeyCode.Down,o=w()(".b-folders .e-item .e-link:not(.hidden):visible",a);if(e&&o.length){var i=o.index(o.filter(".focused"));-1<i&&o.eq(i).removeClass("focused"),E.EventKeyCode.Up===n&&0<i?i-=1:E.EventKeyCode.Down===n&&i<o.length-1&&(i+=1),o.eq(i).addClass("focused"),r.scrollToFocused()}return!1}),Ie()("enter",E.KeyState.FolderList,function(){var e=w()(".b-folders .e-item .e-link:not(.hidden).focused",a);return e.length&&e[0]&&(D.a.focusedState(E.Focused.MessageList),e.click()),!1}),Ie()("space",E.KeyState.FolderList,function(){var e=w()(".b-folders .e-item .e-link:not(.hidden).focused",a);if(e.length&&e[0]){var t=G.a.dataFor(e[0]);if(t){var n=t.collapsed();Object(le.a)().setExpandedFolder(t.fullNameHash,n),t.collapsed(!n)}}return!1}),Ie()("esc, tab, shift+tab, right",E.KeyState.FolderList,function(){return D.a.focusedState(E.Focused.MessageList),Object(F.moveAction)(!1),!1}),D.a.focusedState.subscribe(function(e){w()(".b-folders .e-item .e-link.focused",a).removeClass("focused"),E.Focused.FolderList===e&&w()(".b-folders .e-item .e-link.selected",a).addClass("focused")})},n.prototype.messagesDropOver=function(e){y.a.clearTimeout(this.iDropOverTimer),e&&e.collapsed()&&(this.iDropOverTimer=y.a.setTimeout(function(){e.collapsed(!1),Object(le.a)().setExpandedFolder(e.fullNameHash,!0),Object(A.windowResize)()},E.Magics.Time500ms))},n.prototype.messagesDropOut=function(){y.a.clearTimeout(this.iDropOverTimer)},n.prototype.scrollToFocused=function(){if(!this.oContentVisible||!this.oContentScrollable)return!1;var e=w()(".e-item .e-link.focused",this.oContentScrollable),t=e.position(),n=this.oContentVisible.height(),o=e.outerHeight();return!(!t||!(t.top<0||t.top+o>n)||(t.top<0?this.oContentScrollable.scrollTop(this.oContentScrollable.scrollTop()+t.top-20):this.oContentScrollable.scrollTop(this.oContentScrollable.scrollTop()+t.top-n+o+20),0))},n.prototype.messagesDrop=function(e,t){if(e&&t&&t.helper){var n=t.helper.data("rl-folder"),o=F.$html.hasClass("rl-ctrl-key-pressed"),i=t.helper.data("rl-uids");Object(A.isNormal)(n)&&""!==n&&Object(A.isArray)(i)&&Object(le.a)().moveMessagesToFolder(n,i,e.fullNameRaw,o)}},n.prototype.composeClick=function(){$.capa(E.Capa.Composer)&&Object(ue.showScreenPopup)(c(64))},n.prototype.createFolder=function(){Object(ue.showScreenPopup)(c(176))},n.prototype.configureFolders=function(){Object(ue.setHash)(Object(L.z)("folders"))},n.prototype.contactsClick=function(){this.allowContacts&&Object(ue.showScreenPopup)(c(181))},n}(de.a))||fe,Me=c(79),De=c.n(Me),ke=c(100),xe=c.n(ke),Ue=c(120);function He(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}var Be,Ge,Ke,Ve,ze,qe,We,Ye,$e=function(e){return e.canBeMoved()},Je=(me=Object(ue.view)({name:"View/User/MailBox/MessageList",type:ue.ViewType.Right,templateID:"MailMessageList"}),be=Object(ue.command)(),ge=Object(ue.command)(),ye=Object(ue.command)($e),ve=Object(ue.command)($e),Se=Object(ue.command)($e),Oe=Object(ue.command)($e),we=Object(ue.command)($e),Te=Object(ue.command)($e),Ce=Object(ue.command)($e),Ae=Object(ue.command)($e),me((He((Fe=function(e){function t(){p()(this,t);var o=f()(this,e.call(this));return o.sLastUid=null,o.bPrefetch=!1,o.emptySubjectValue="",o.iGoToUpUpOrDownDownTimeout=0,o.mobile=!!$.appSettingsGet("mobile"),o.newMoveToFolder=D.a.newMoveToFolder,o.allowReload=!!$.capa(E.Capa.Reload),o.allowSearch=!!$.capa(E.Capa.Search),o.allowSearchAdv=!!$.capa(E.Capa.SearchAdv),o.allowComposer=!!$.capa(E.Capa.Composer),o.allowMessageListActions=!!$.capa(E.Capa.MessageListActions),o.allowDangerousActions=!!$.capa(E.Capa.DangerousActions),o.allowFolders=!!$.capa(E.Capa.Folders),o.popupVisibility=F.popupVisibility,o.message=q.a.message,o.messageList=q.a.messageList,o.messageListDisableAutoSelect=q.a.messageListDisableAutoSelect,o.folderList=V.a.folderList,o.composeInEdit=D.a.composeInEdit,o.leftPanelDisabled=F.leftPanelDisabled,o.selectorMessageSelected=q.a.selectorMessageSelected,o.selectorMessageFocused=q.a.selectorMessageFocused,o.isMessageSelected=q.a.isMessageSelected,o.messageListSearch=q.a.messageListSearch,o.messageListThreadUid=q.a.messageListThreadUid,o.messageListError=q.a.messageListError,o.folderMenuForMove=V.a.folderMenuForMove,o.useCheckboxesInList=k.a.useCheckboxesInList,o.mainMessageListSearch=q.a.mainMessageListSearch,o.messageListEndFolder=q.a.messageListEndFolder,o.messageListEndThreadUid=q.a.messageListEndThreadUid,o.messageListChecked=q.a.messageListChecked,o.messageListCheckedOrSelected=q.a.messageListCheckedOrSelected,o.messageListCheckedOrSelectedUidsWithSubMails=q.a.messageListCheckedOrSelectedUidsWithSubMails,o.messageListCompleteLoadingThrottle=q.a.messageListCompleteLoadingThrottle,o.messageListCompleteLoadingThrottleForAnimation=q.a.messageListCompleteLoadingThrottleForAnimation,Object(P.initOnStartOrLangChange)(function(){o.emptySubjectValue=Object(P.i18n)("MESSAGE_LIST/EMPTY_SUBJECT_TEXT")}),o.userQuota=W.quota,o.userUsageSize=W.usage,o.userUsageProc=W.percentage,o.moveDropdownTrigger=G.a.observable(!1),o.moreDropdownTrigger=G.a.observable(!1),o.dragOver=G.a.observable(!1).extend({throttle:1}),o.dragOverEnter=G.a.observable(!1).extend({throttle:1}),o.dragOverArea=G.a.observable(null),o.dragOverBodyArea=G.a.observable(null),o.messageListItemTemplate=G.a.computed(function(){return o.mobile||E.Layout.SidePreview===k.a.layout()?"MailMessageListItem":"MailMessageListItemNoPreviewPane"}),o.messageListSearchDesc=G.a.computed(function(){var e=q.a.messageListEndSearch();return""===e?"":Object(P.i18n)("MESSAGE_LIST/SEARCH_RESULT_FOR",{SEARCH:e})}),o.messageListPagenator=G.a.computed(Object(A.computedPagenatorHelper)(q.a.messageListPage,q.a.messageListPageCount)),o.checkAll=G.a.computed({read:function(){return 0<q.a.messageListChecked().length},write:function(t){t=!!t,S.a.each(q.a.messageList(),function(e){e.checked(t)})}}),o.inputMessageListSearchFocus=G.a.observable(!1),o.sLastSearchValue="",o.inputProxyMessageListSearch=G.a.computed({read:o.mainMessageListSearch,write:function(e){o.sLastSearchValue=e}}),o.isIncompleteChecked=G.a.computed(function(){var e=q.a.messageList().length,t=q.a.messageListChecked().length;return 0<e&&0<t&&t<e}),o.hasMessages=G.a.computed(function(){return 0<o.messageList().length}),o.hasCheckedOrSelectedLines=G.a.computed(function(){return 0<o.messageListCheckedOrSelected().length}),o.isSpamFolder=G.a.computed(function(){return V.a.spamFolder()===o.messageListEndFolder()&&""!==V.a.spamFolder()}),o.isSpamDisabled=G.a.computed(function(){return j.r===V.a.spamFolder()}),o.isTrashFolder=G.a.computed(function(){return V.a.trashFolder()===o.messageListEndFolder()&&""!==V.a.trashFolder()}),o.isDraftFolder=G.a.computed(function(){return V.a.draftFolder()===o.messageListEndFolder()&&""!==V.a.draftFolder()}),o.isSentFolder=G.a.computed(function(){return V.a.sentFolder()===o.messageListEndFolder()&&""!==V.a.sentFolder()}),o.isArchiveFolder=G.a.computed(function(){return V.a.archiveFolder()===o.messageListEndFolder()&&""!==V.a.archiveFolder()}),o.isArchiveDisabled=G.a.computed(function(){return j.r===V.a.archiveFolder()}),o.isArchiveVisible=G.a.computed(function(){return!o.isArchiveFolder()&&!o.isArchiveDisabled()&&!o.isDraftFolder()}),o.isSpamVisible=G.a.computed(function(){return!(o.isSpamFolder()||o.isSpamDisabled()||o.isDraftFolder()||o.isSentFolder())}),o.isUnSpamVisible=G.a.computed(function(){return o.isSpamFolder()&&!o.isSpamDisabled()&&!o.isDraftFolder()&&!o.isSentFolder()}),o.mobileCheckedStateShow=G.a.computed(function(){var e=0<o.messageListChecked().length;return!o.mobile||e}),o.mobileCheckedStateHide=G.a.computed(function(){var e=0<o.messageListChecked().length;return!o.mobile||!e}),o.messageListFocused=G.a.computed(function(){return E.Focused.MessageList===D.a.focusedState()}),o.canBeMoved=o.hasCheckedOrSelectedLines,o.quotaTooltip=S.a.bind(o.quotaTooltip,o),o.selector=new Ue.a(o.messageList,o.selectorMessageSelected,o.selectorMessageFocused,".messageListItem .actionHandle",".messageListItem.selected",".messageListItem .checkboxMessage",".messageListItem.focused"),o.selector.on("onItemSelect",function(e){q.a.selectMessage(e)}),o.selector.on("onItemGetUid",function(e){return e?e.generateUid():""}),o.selector.on("onAutoSelect",function(){return o.useAutoSelect()}),o.selector.on("onUpUpOrDownDown",function(e){o.goToUpUpOrDownDown(e)}),_.b("mailbox.message-list.selector.go-down",function(e){o.selector.goDown(e)}),_.b("mailbox.message-list.selector.go-up",function(e){o.selector.goUp(e)}),_.b("mailbox.message.show",function(t,n){var e=S.a.find(o.messageList(),function(e){return e&&t===e.folderFullNameRaw&&n===e.uid});"INBOX"===t&&Object(ue.setHash)(Object(L.o)(t,1)),e?o.selector.selectMessageItem(e):("INBOX"!==t&&Object(ue.setHash)(Object(L.o)(t,1)),q.a.selectMessageByFolderAndUid(t,n))}),q.a.messageListEndHash.subscribe(function(){o.selector.scrollToTop()}),o}return b()(t,e),t.prototype.clearCommand=function(){$.capa(E.Capa.DangerousActions)&&Object(ue.showScreenPopup)(c(208),[V.a.currentFolder()])},t.prototype.reloadCommand=function(){!q.a.messageListCompleteLoadingThrottleForAnimation()&&this.allowReload&&Object(le.a)().reloadMessageList(!1,!0)},t.prototype.multyForwardCommand=function(){$.capa(E.Capa.Composer)&&Object(ue.showScreenPopup)(c(64),[E.ComposeType.ForwardAsAttachment,q.a.messageListCheckedOrSelected()])},t.prototype.deleteWithoutMoveCommand=function(){$.capa(E.Capa.DangerousActions)&&Object(le.a)().deleteMessagesFromFolder(E.FolderType.Trash,V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),!1)},t.prototype.deleteCommand=function(){Object(le.a)().deleteMessagesFromFolder(E.FolderType.Trash,V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),!0)},t.prototype.archiveCommand=function(){Object(le.a)().deleteMessagesFromFolder(E.FolderType.Archive,V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),!0)},t.prototype.spamCommand=function(){Object(le.a)().deleteMessagesFromFolder(E.FolderType.Spam,V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),!0)},t.prototype.notSpamCommand=function(){Object(le.a)().deleteMessagesFromFolder(E.FolderType.NotSpam,V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),!0)},t.prototype.moveCommand=function(){},t.prototype.moveNewCommand=function(e,t){this.newMoveToFolder()&&this.mobileCheckedStateShow()&&(e&&t&&t.preventDefault&&(t.preventDefault(),t.stopPropagation&&t.stopPropagation()),Object(F.moveAction)()?(D.a.focusedState(E.Focused.MessageList),Object(F.moveAction)(!1)):(D.a.focusedState(E.Focused.FolderList),Object(F.moveAction)(!0)))},t.prototype.hideLeft=function(e,t){t.preventDefault(),t.stopPropagation(),Object(F.leftPanelDisabled)(!0)},t.prototype.showLeft=function(e,t){t.preventDefault(),t.stopPropagation(),Object(F.leftPanelDisabled)(!1)},t.prototype.composeClick=function(){$.capa(E.Capa.Composer)&&Object(ue.showScreenPopup)(c(64))},t.prototype.goToUpUpOrDownDown=function(e){var a=this;return!(0<this.messageListChecked().length||(y.a.clearTimeout(this.iGoToUpUpOrDownDownTimeout),this.iGoToUpUpOrDownDownTimeout=y.a.setTimeout(function(){var t=null,n=null,o=null,i=null;S.a.find(a.messageListPagenator(),function(e){if(e){if(i&&(n=e),e.current&&(i=e,t=o),n)return!0;o=e}return!1}),E.Layout.NoPreview!==k.a.layout()||a.message()?a.selector.iSelectNextHelper=e?-1:1:a.selector.iFocusedNextHelper=e?-1:1,(e?t:n)&&(a.selector.unselect(),a.gotoPage(e?t:n))},E.Magics.Time350ms),0))},t.prototype.useAutoSelect=function(){return!this.messageListDisableAutoSelect()&&!/is:unseen/.test(this.mainMessageListSearch())&&E.Layout.NoPreview!==k.a.layout()},t.prototype.searchEnterAction=function(){this.mainMessageListSearch(this.sLastSearchValue),this.inputMessageListSearchFocus(!1)},t.prototype.printableMessageCountForDeletion=function(){var e=this.messageListCheckedOrSelectedUidsWithSubMails().length;return 1<e?" ("+(e<100?e:"99+")+")":""},t.prototype.cancelSearch=function(){this.mainMessageListSearch(""),this.inputMessageListSearchFocus(!1)},t.prototype.cancelThreadUid=function(){Object(ue.setHash)(Object(L.o)(V.a.currentFolderFullNameHash(),q.a.messageListPageBeforeThread(),q.a.messageListSearch()))},t.prototype.moveSelectedMessagesToFolder=function(e,t){return this.canBeMoved()&&Object(le.a)().moveMessagesToFolder(V.a.currentFolderFullNameRaw(),q.a.messageListCheckedOrSelectedUidsWithSubMails(),e,t),!1},t.prototype.dragAndDronHelper=function(e){e&&e.checked(!0);var t=Object(A.draggablePlace)(),n=function(){var e=q.a.messageListCheckedOrSelectedUidsWithSubMails();t.data("rl-uids",e),t.find(".text").text(""+e.length)};return t.data("rl-folder",V.a.currentFolderFullNameRaw()),n(),S.a.defer(n),t},t.prototype.setAction=function(e,t,n){Object(le.a)().messageListAction(e,t,n)},t.prototype.setActionForAll=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";if(""!==e){var o=0,i=[],a=Object(I.e)(e);if(a){switch(t){case E.MessageSetAction.SetSeen:(a=Object(I.e)(e))&&(S.a.each(q.a.messageList(),function(e){e.unseen()&&(o+=1),e.unseen(!1),i.push(e.uid)}),n?(a.messageCountUnread(a.messageCountUnread()-o),a.messageCountUnread()<0&&a.messageCountUnread(0)):a.messageCountUnread(0),Object(I.c)(e)),X.a.messageSetSeenToAll(A.noop,e,!0,n?i:null);break;case E.MessageSetAction.UnsetSeen:(a=Object(I.e)(e))&&(S.a.each(q.a.messageList(),function(e){e.unseen()||(o+=1),e.unseen(!0),i.push(e.uid)}),n?(a.messageCountUnread(a.messageCountUnread()+o),a.messageCountAll()<a.messageCountUnread()&&a.messageCountUnread(a.messageCountAll())):a.messageCountUnread(a.messageCountAll()),Object(I.c)(e)),X.a.messageSetSeenToAll(A.noop,e,!1,n?i:null)}Object(le.a)().reloadFlagsCurrentMessageListAndMessageFromCache()}}},t.prototype.listSetSeen=function(){this.setAction(V.a.currentFolderFullNameRaw(),E.MessageSetAction.SetSeen,q.a.messageListCheckedOrSelected())},t.prototype.listSetAllSeen=function(){this.setActionForAll(V.a.currentFolderFullNameRaw(),E.MessageSetAction.SetSeen,this.messageListEndThreadUid())},t.prototype.listUnsetSeen=function(){this.setAction(V.a.currentFolderFullNameRaw(),E.MessageSetAction.UnsetSeen,q.a.messageListCheckedOrSelected())},t.prototype.listSetFlags=function(){this.setAction(V.a.currentFolderFullNameRaw(),E.MessageSetAction.SetFlag,q.a.messageListCheckedOrSelected())},t.prototype.listUnsetFlags=function(){this.setAction(V.a.currentFolderFullNameRaw(),E.MessageSetAction.UnsetFlag,q.a.messageListCheckedOrSelected())},t.prototype.flagMessages=function(e){var t=this.messageListCheckedOrSelected();if(e){var n=S.a.map(t,function(e){return e.uid});0<n.length&&-1<Object(A.inArray)(e.uid,n)?this.setAction(e.folderFullNameRaw,e.flagged()?E.MessageSetAction.UnsetFlag:E.MessageSetAction.SetFlag,t):this.setAction(e.folderFullNameRaw,e.flagged()?E.MessageSetAction.UnsetFlag:E.MessageSetAction.SetFlag,[e])}},t.prototype.flagMessagesFast=function(e){var t=this.messageListCheckedOrSelected();if(0<t.length)if(Object(A.isUnd)(e)){var n=S.a.filter(t,function(e){return e.flagged()});this.setAction(t[0].folderFullNameRaw,t.length===n.length?E.MessageSetAction.UnsetFlag:E.MessageSetAction.SetFlag,t)}else this.setAction(t[0].folderFullNameRaw,e?E.MessageSetAction.SetFlag:E.MessageSetAction.UnsetFlag,t)},t.prototype.seenMessagesFast=function(e){var t=this.messageListCheckedOrSelected();if(0<t.length)if(Object(A.isUnd)(e)){var n=S.a.filter(t,function(e){return e.unseen()});this.setAction(t[0].folderFullNameRaw,0<n.length?E.MessageSetAction.SetSeen:E.MessageSetAction.UnsetSeen,t)}else this.setAction(t[0].folderFullNameRaw,e?E.MessageSetAction.SetSeen:E.MessageSetAction.UnsetSeen,t)},t.prototype.gotoPage=function(e){e&&Object(ue.setHash)(Object(L.o)(V.a.currentFolderFullNameHash(),e.value,q.a.messageListSearch(),q.a.messageListThreadUid()))},t.prototype.gotoThread=function(e){e&&0<e.threadsLen()&&(q.a.messageListPageBeforeThread(q.a.messageListPage()),Object(ue.setHash)(Object(L.o)(V.a.currentFolderFullNameHash(),1,q.a.messageListSearch(),e.uid)))},t.prototype.clearListIsVisible=function(){return""===this.messageListSearchDesc()&&""===this.messageListError()&&""===this.messageListEndThreadUid()&&0<this.messageList().length&&(this.isSpamFolder()||this.isTrashFolder())},t.prototype.onBuild=function(e){var t=this,n=this;this.oContentVisible=w()(".b-content",e),this.oContentScrollable=w()(".content",this.oContentVisible),this.selector.init(this.oContentVisible,this.oContentScrollable,E.KeyState.MessageList),this.mobile&&e.on("click",function(){Object(F.leftPanelDisabled)(!0)}),e.on("click",".messageList .b-message-list-wrapper",function(){E.Focused.MessageView===D.a.focusedState()&&D.a.focusedState(E.Focused.MessageList)}).on("click",".e-pagenator .e-page",function(){n.gotoPage(G.a.dataFor(this))}).on("click",".messageList .checkboxCkeckAll",function(){t.checkAll(!t.checkAll())}).on("click",".messageList .messageListItem .flagParent",function(){n.flagMessages(G.a.dataFor(this))}).on("click",".messageList .messageListItem .threads-len",function(){n.gotoThread(G.a.dataFor(this))}).on("dblclick",".messageList .messageListItem .actionHandle",function(){n.gotoThread(G.a.dataFor(this))}),this.initUploaderForAppend(),this.initShortcuts(),!F.bMobileDevice&&xe.a&&$.capa(E.Capa.Prefetch)&&(xe.a.setIdleDuration(E.Magics.ifvisibleIdle10s),xe.a.idle(function(){t.prefetchNextTick()}))},t.prototype.initShortcuts=function(){var n=this;Ie()("enter",E.KeyState.MessageList,function(){return!n.message()||!n.useAutoSelect()||(_.a("mailbox.message-view.toggle-full-screen"),!1)}),$.capa(E.Capa.MessageListActions)&&(Ie()("z",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.archiveCommand(),!1}),Ie()("delete, shift+delete, shift+3",E.KeyState.MessageList,function(e,t){return!e||(0<q.a.messageListCheckedOrSelected().length&&(t&&"shift+delete"===t.shortcut?n.deleteWithoutMoveCommand():n.deleteCommand()),!1)})),$.capa(E.Capa.Reload)&&Ie()("ctrl+r, command+r",[E.KeyState.FolderList,E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.reloadCommand(),!1}),Ie()("ctrl+a, command+a",E.KeyState.MessageList,function(){return n.checkAll(!(n.checkAll()&&!n.isIncompleteChecked())),!1}),$.capa(E.Capa.Composer)&&Ie()("w,c",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return Object(ue.showScreenPopup)(c(64)),!1}),$.capa(E.Capa.MessageListActions)&&Ie()("i",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.flagMessagesFast(),!1}),Ie()("t",[E.KeyState.MessageList],function(){var e=n.selectorMessageSelected();return e||(e=n.selectorMessageFocused()),e&&0<e.threadsLen()&&n.gotoThread(e),!1}),$.capa(E.Capa.MessageListActions)&&Ie()("m",E.KeyState.MessageList,function(){return n.newMoveToFolder()?n.moveNewCommand():n.moveDropdownTrigger(!0),!1}),$.capa(E.Capa.MessageListActions)&&(Ie()("q",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.seenMessagesFast(!0),!1}),Ie()("u",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.seenMessagesFast(!1),!1})),$.capa(E.Capa.Composer)&&Ie()("shift+f",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.multyForwardCommand(),!1}),$.capa(E.Capa.Search)&&Ie()("/",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.inputMessageListSearchFocus(!0),!1}),Ie()("esc",E.KeyState.MessageList,function(){return""!==n.messageListSearchDesc()?(n.cancelSearch(),!1):""===n.messageListEndThreadUid()||(n.cancelThreadUid(),!1)}),Ie()("tab, shift+tab, left, right",E.KeyState.MessageList,function(e,t){return e&&t&&("shift+tab"===t.shortcut||"left"===t.shortcut)?D.a.focusedState(E.Focused.FolderList):n.message()&&D.a.focusedState(E.Focused.MessageView),!1}),Ie()("ctrl+left, command+left",E.KeyState.MessageView,A.noopFalse),Ie()("ctrl+right, command+right",E.KeyState.MessageView,A.noopFalse)},t.prototype.prefetchNextTick=function(){var o=this;if(xe.a&&!this.bPrefetch&&!xe.a.now()&&this.viewModelVisibility()){var e=S.a.find(this.messageList(),function(e){return e&&!Object(I.m)(e.folderFullNameRaw,e.uid)});e&&(this.bPrefetch=!0,Object(I.b)(e.folderFullNameRaw,e.uid),X.a.message(function(e,t){var n=!(E.StorageResultType.Success!==e||!t||!t.Result);S.a.delay(function(){o.bPrefetch=!1,n&&o.prefetchNextTick()},E.Magics.Time1s)},e.folderFullNameRaw,e.uid))}},t.prototype.advancedSearchClick=function(){$.capa(E.Capa.SearchAdv)&&Object(ue.showScreenPopup)(c(209),[this.mainMessageListSearch()])},t.prototype.quotaTooltip=function(){return Object(P.i18n)("MESSAGE_LIST/QUOTA_SIZE",{SIZE:Object(A.friendlySize)(this.userUsageSize()),PROC:this.userUsageProc(),LIMIT:Object(A.friendlySize)(this.userQuota())})},t.prototype.initUploaderForAppend=function(){var t=this;if(!$.appSettingsGet("allowAppendMessage")||!this.dragOverArea())return!1;var e=new De.a({action:Object(L.b)(),name:"AppendFile",queueSize:1,multipleSizeLimit:1,hidden:{Folder:function(){return V.a.currentFolderFullNameRaw()}},dragAndDropElement:this.dragOverArea(),dragAndDropBodyElement:this.dragOverBodyArea()});return this.dragOver.subscribe(function(e){e&&t.selector.scrollToTop()}),e.on("onDragEnter",function(){t.dragOverEnter(!0)}).on("onDragLeave",function(){t.dragOverEnter(!1)}).on("onBodyDragEnter",function(){t.dragOver(!0)}).on("onBodyDragLeave",function(){t.dragOver(!1)}).on("onSelect",function(e,t){return!(!e||!t||"message/rfc822"!==t.Type||(q.a.messageListLoading(!0),0))}).on("onComplete",function(){Object(le.a)().reloadMessageList(!0,!0)}),!!e},t}(de.a)).prototype,"clearCommand",[be],se()(Fe.prototype,"clearCommand"),Fe.prototype),He(Fe.prototype,"reloadCommand",[ge],se()(Fe.prototype,"reloadCommand"),Fe.prototype),He(Fe.prototype,"multyForwardCommand",[ye],se()(Fe.prototype,"multyForwardCommand"),Fe.prototype),He(Fe.prototype,"deleteWithoutMoveCommand",[ve],se()(Fe.prototype,"deleteWithoutMoveCommand"),Fe.prototype),He(Fe.prototype,"deleteCommand",[Se],se()(Fe.prototype,"deleteCommand"),Fe.prototype),He(Fe.prototype,"archiveCommand",[Oe],se()(Fe.prototype,"archiveCommand"),Fe.prototype),He(Fe.prototype,"spamCommand",[we],se()(Fe.prototype,"spamCommand"),Fe.prototype),He(Fe.prototype,"notSpamCommand",[Te],se()(Fe.prototype,"notSpamCommand"),Fe.prototype),He(Fe.prototype,"moveCommand",[Ce],se()(Fe.prototype,"moveCommand"),Fe.prototype),He(Fe.prototype,"moveNewCommand",[Ae],se()(Fe.prototype,"moveNewCommand"),Fe.prototype),Ee=Fe))||Ee),Xe=c(46);function Ze(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}var Qe,et,tt,nt,ot,it,at,rt,st,ct,lt,ut,dt,pt,ht,ft=(Be=Object(ue.view)({name:"View/User/MailBox/MessageView",type:ue.ViewType.Right,templateID:"MailMessageView"}),Ge=Object(ue.command)(),Ke=Object(ue.command)(function(e){return e.messageVisibility()}),Ve=Object(ue.command)(function(e){return e.messageVisibility()}),ze=Object(ue.command)(function(e){return!e.messageListAndMessageViewLoading()}),qe=Object(ue.command)(function(e){return!e.messageListAndMessageViewLoading()}),Be((Ze((Ye=function(i){function a(){p()(this,a);var o=f()(this,i.call(this)),n="",e=function(e){return Object(ue.createCommand)(function(){o.lastReplyAction(e),o.replyOrforward(e)},o.canBeRepliedOrForwarded)},t=function(t,n){return Object(ue.createCommand)(function(){var e=o.message();e&&o.allowMessageListActions&&(o.message(null),Object(le.a)().deleteMessagesFromFolder(t,e.folderFullNameRaw,[e.uid],n))},o.messageVisibility)};return o.oDom=null,o.oHeaderDom=null,o.oMessageScrollerDom=null,o.bodyBackgroundColor=G.a.observable(""),o.pswp=null,o.moveAction=F.moveAction,o.allowComposer=!!$.capa(E.Capa.Composer),o.allowMessageActions=!!$.capa(E.Capa.MessageActions),o.allowMessageListActions=!!$.capa(E.Capa.MessageListActions),o.logoImg=Object(A.trim)($.settingsGet("UserLogoMessage")),o.logoIframe=Object(A.trim)($.settingsGet("UserIframeMessage")),o.mobile=!!$.appSettingsGet("mobile"),o.attachmentsActions=D.a.attachmentsActions,o.message=q.a.message,o.messageListChecked=q.a.messageListChecked,o.hasCheckedMessages=q.a.hasCheckedMessages,o.messageListCheckedOrSelectedUidsWithSubMails=q.a.messageListCheckedOrSelectedUidsWithSubMails,o.messageLoadingThrottle=q.a.messageLoadingThrottle,o.messagesBodiesDom=q.a.messagesBodiesDom,o.useThreads=k.a.useThreads,o.replySameFolder=k.a.replySameFolder,o.layout=k.a.layout,o.usePreviewPane=k.a.usePreviewPane,o.isMessageSelected=q.a.isMessageSelected,o.messageActiveDom=q.a.messageActiveDom,o.messageError=q.a.messageError,o.fullScreenMode=q.a.messageFullScreenMode,o.messageListOfThreadsLoading=G.a.observable(!1).extend({rateLimit:1}),o.highlightUnselectedAttachments=G.a.observable(!1).extend({falseTimeout:2e3}),o.showAttachmnetControls=G.a.observable(!1),o.showAttachmnetControlsState=function(e){Y.b(E.ClientSideKeyName.MessageAttachmnetControls,!!e)},o.allowAttachmnetControls=G.a.computed(function(){return 0<o.attachmentsActions().length&&$.capa(E.Capa.AttachmentsActions)}),o.downloadAsZipAllowed=G.a.computed(function(){return-1<Object(A.inArray)("zip",o.attachmentsActions())&&o.allowAttachmnetControls()}),o.downloadAsZipLoading=G.a.observable(!1),o.downloadAsZipError=G.a.observable(!1).extend({falseTimeout:7e3}),o.saveToOwnCloudAllowed=G.a.computed(function(){return-1<Object(A.inArray)("owncloud",o.attachmentsActions())&&o.allowAttachmnetControls()}),o.saveToOwnCloudLoading=G.a.observable(!1),o.saveToOwnCloudSuccess=G.a.observable(!1).extend({falseTimeout:2e3}),o.saveToOwnCloudError=G.a.observable(!1).extend({falseTimeout:7e3}),o.saveToOwnCloudSuccess.subscribe(function(e){e&&o.saveToOwnCloudError(!1)}),o.saveToOwnCloudError.subscribe(function(e){e&&o.saveToOwnCloudSuccess(!1)}),o.saveToDropboxAllowed=G.a.computed(function(){return-1<Object(A.inArray)("dropbox",o.attachmentsActions())&&o.allowAttachmnetControls()}),o.saveToDropboxLoading=G.a.observable(!1),o.saveToDropboxSuccess=G.a.observable(!1).extend({falseTimeout:2e3}),o.saveToDropboxError=G.a.observable(!1).extend({falseTimeout:7e3}),o.saveToDropboxSuccess.subscribe(function(e){e&&o.saveToDropboxError(!1)}),o.saveToDropboxError.subscribe(function(e){e&&o.saveToDropboxSuccess(!1)}),o.showAttachmnetControls.subscribe(function(t){o.message()&&S.a.each(o.message().attachments(),function(e){e&&e.checked(!!t)})}),o.lastReplyAction_=G.a.observable(""),o.lastReplyAction=G.a.computed({read:o.lastReplyAction_,write:function(e){o.lastReplyAction_(-1===Object(A.inArray)(e,[E.ComposeType.Reply,E.ComposeType.ReplyAll,E.ComposeType.Forward])?E.ComposeType.Reply:e)}}),o.lastReplyAction(Y.a(E.ClientSideKeyName.LastReplyAction)||E.ComposeType.Reply),o.lastReplyAction_.subscribe(function(e){Y.b(E.ClientSideKeyName.LastReplyAction,e)}),o.showFullInfo=G.a.observable("1"===Y.a(E.ClientSideKeyName.MessageHeaderFullInfo)),o.moreDropdownTrigger=G.a.observable(!1),o.messageDomFocused=G.a.observable(!1).extend({rateLimit:0}),o.messageVisibility=G.a.computed(function(){return!o.messageLoadingThrottle()&&!!o.message()}),o.message.subscribe(function(e){e||q.a.selectorMessageSelected(null)}),o.canBeRepliedOrForwarded=G.a.computed(function(){var e=o.messageVisibility();return!o.isDraftFolder()&&e}),o.replyCommand=e(E.ComposeType.Reply),o.replyAllCommand=e(E.ComposeType.ReplyAll),o.forwardCommand=e(E.ComposeType.Forward),o.forwardAsAttachmentCommand=e(E.ComposeType.ForwardAsAttachment),o.editAsNewCommand=e(E.ComposeType.EditAsNew),o.deleteCommand=t(E.FolderType.Trash,!0),o.deleteWithoutMoveCommand=t(E.FolderType.Trash,!1),o.archiveCommand=t(E.FolderType.Archive,!0),o.spamCommand=t(E.FolderType.Spam,!0),o.notSpamCommand=t(E.FolderType.NotSpam,!0),o.dropboxEnabled=M.a.dropbox.enabled,o.dropboxApiKey=M.a.dropbox.apiKey,o.viewBodyTopValue=G.a.observable(0),o.viewFolder="",o.viewUid="",o.viewHash="",o.viewSubject=G.a.observable(""),o.viewFromShort=G.a.observable(""),o.viewFromDkimData=G.a.observable(["none",""]),o.viewToShort=G.a.observable(""),o.viewFrom=G.a.observable(""),o.viewTo=G.a.observable(""),o.viewCc=G.a.observable(""),o.viewBcc=G.a.observable(""),o.viewReplyTo=G.a.observable(""),o.viewTimeStamp=G.a.observable(0),o.viewSize=G.a.observable(""),o.viewLineAsCss=G.a.observable(""),o.viewViewLink=G.a.observable(""),o.viewUnsubscribeLink=G.a.observable(""),o.viewDownloadLink=G.a.observable(""),o.viewUserPic=G.a.observable(j.f),o.viewUserPicVisible=G.a.observable(!1),o.viewIsImportant=G.a.observable(!1),o.viewIsFlagged=G.a.observable(!1),o.viewFromDkimVisibility=G.a.computed(function(){return"none"!==o.viewFromDkimData()[0]}),o.viewFromDkimStatusIconClass=G.a.computed(function(){switch(o.viewFromDkimData()[0]){case"none":return"icon-none iconcolor-display-none";case"pass":return"icon-ok iconcolor-green";default:return"icon-warning-alt iconcolor-red"}}),o.viewFromDkimStatusTitle=G.a.computed(function(){var e=o.viewFromDkimData();if(Object(A.isNonEmptyArray)(e)){if(e[0]&&e[1])return e[1];if(e[0])return"DKIM: "+e[0]}return""}),o.messageActiveDom.subscribe(function(e){o.bodyBackgroundColor(e?o.detectDomBackgroundColor(e):"")},o),o.message.subscribe(function(e){o.messageActiveDom(null),e?(o.showAttachmnetControls(!1),Y.a(E.ClientSideKeyName.MessageAttachmnetControls)&&S.a.delay(function(){o.showAttachmnetControls(!0)},E.Magics.Time50ms),o.viewHash!==e.hash&&o.scrollMessageToTop(),o.viewFolder=e.folderFullNameRaw,o.viewUid=e.uid,o.viewHash=e.hash,o.viewSubject(e.subject()),o.viewFromShort(e.fromToLine(!0,!0)),o.viewFromDkimData(e.fromDkimData()),o.viewToShort(e.toToLine(!0,!0)),o.viewFrom(e.fromToLine(!1)),o.viewTo(e.toToLine(!1)),o.viewCc(e.ccToLine(!1)),o.viewBcc(e.bccToLine(!1)),o.viewReplyTo(e.replyToToLine(!1)),o.viewTimeStamp(e.dateTimeStampInUTC()),o.viewSize(e.friendlySize()),o.viewLineAsCss(e.lineAsCss()),o.viewViewLink(e.viewLink()),o.viewUnsubscribeLink(e.getFirstUnsubsribeLink()),o.viewDownloadLink(e.downloadLink()),o.viewIsImportant(e.isImportant()),o.viewIsFlagged(e.flagged()),n=e.fromAsSingleEmail(),Object(I.k)(n,function(e,t){e!==o.viewUserPic()&&n===t&&(o.viewUserPicVisible(!1),o.viewUserPic(j.f),""!==e&&(o.viewUserPicVisible(!0),o.viewUserPic(e)))})):(o.viewFolder="",o.viewUid="",o.viewHash="",o.scrollMessageToTop())}),o.message.viewTrigger.subscribe(function(){var e=o.message();e?o.viewIsFlagged(e.flagged()):o.viewIsFlagged(!1)}),o.fullScreenMode.subscribe(function(e){F.$html.toggleClass("rl-message-fullscreen",e),Object(A.windowResize)()}),o.messageLoadingThrottle.subscribe(A.windowResizeCallback),o.messageFocused=G.a.computed(function(){return E.Focused.MessageView===D.a.focusedState()}),o.messageListAndMessageViewLoading=G.a.computed(function(){return q.a.messageListCompleteLoadingThrottle()||q.a.messageLoadingThrottle()}),_.b("mailbox.message-view.toggle-full-screen",function(){o.toggleFullScreen()}),o.attachmentPreview=S.a.bind(o.attachmentPreview,o),o}return b()(a,i),a.prototype.closeMessageCommand=function(){q.a.message(null)},a.prototype.messageVisibilityCommand=function(){},a.prototype.messageEditCommand=function(){this.editMessage()},a.prototype.goUpCommand=function(){_.a("mailbox.message-list.selector.go-up",[E.Layout.NoPreview!==this.layout()||!!this.message()])},a.prototype.goDownCommand=function(){_.a("mailbox.message-list.selector.go-down",[E.Layout.NoPreview!==this.layout()||!!this.message()])},a.prototype.detectDomBackgroundColor=function(e){var t,n,o,i,a=5,r="";if(e&&1===e.length){for(var s=e;""===r&&!((a-=1)<=0)&&(i=void 0,s=(i=(o=s)?o.children():null)&&1===i.length&&i.is("table,div,center")?i:null);)n=void 0,n="",(t=s)&&(n=t.css("background-color")||"",t.is("table")||(n=Object(A.isTransparent)(n)?"":n)),r=n;r=Object(A.isTransparent)(r)?"":r}return r},a.prototype.fullScreen=function(){this.fullScreenMode(!0),Object(A.windowResize)()},a.prototype.unFullScreen=function(){this.fullScreenMode(!1),Object(A.windowResize)()},a.prototype.toggleFullScreen=function(){Object(A.removeSelection)(),this.fullScreenMode(!this.fullScreenMode()),Object(A.windowResize)()},a.prototype.replyOrforward=function(e){$.capa(E.Capa.Composer)&&Object(ue.showScreenPopup)(c(64),[e,q.a.message()])},a.prototype.checkHeaderHeight=function(){this.oHeaderDom&&this.viewBodyTopValue(this.message()?this.oHeaderDom.height()+E.Magics.Size20px+E.Magics.Size1px:0)},a.prototype.attachmentPreview=function(t){if(t&&t.isImage()&&!t.isLinked&&this.message()&&this.message().attachments()){var n=0,o=0,e=w()("<div>"),i=S.a.compact(S.a.map(this.message().attachments(),function(e){return e&&!e.isLinked&&e.isImage()?(e===t&&(n=o),o+=1,{src:e.linkPreview(),thumb:e.linkThumbnail(),subHtml:e.fileName,downloadUrl:e.linkPreview()}):null}));return 0<i.length&&(e.on("onBeforeOpen.lg",function(){Object(F.useKeyboardShortcuts)(!1),Object(A.removeInFocus)(!0)}),e.on("onCloseAfter.lg",function(){Object(F.useKeyboardShortcuts)(!0)}),e.lightGallery({dynamic:!0,loadYoutubeThumbnail:!1,loadVimeoThumbnail:!1,thumbWidth:80,thumbContHeight:95,showThumbByDefault:!1,mode:"lg-lollipop",index:n,dynamicEl:i})),!1}return!0},a.prototype.onBuild=function(e){var t=this,n=this,o=S.a.bind(this.checkHeaderHeight,this);this.oDom=e,this.fullScreenMode.subscribe(function(e){e&&t.message()&&D.a.focusedState(E.Focused.MessageView)}),this.showAttachmnetControls.subscribe(o),this.fullScreenMode.subscribe(o),this.showFullInfo.subscribe(o),this.message.subscribe(o),_.b("window.resize",S.a.throttle(function(){S.a.delay(o,1),S.a.delay(o,E.Magics.Time200ms),S.a.delay(o,E.Magics.Time500ms)},E.Magics.Time50ms)),this.showFullInfo.subscribe(function(e){Object(A.windowResize)(),Object(A.windowResize)(E.Magics.Time200ms),Y.b(E.ClientSideKeyName.MessageHeaderFullInfo,e?"1":"0")}),M.a.appendDropbox(),this.oHeaderDom=w()(".messageItemHeader",e),this.oHeaderDom=this.oHeaderDom[0]?this.oHeaderDom:null,this.mobile&&e.on("click",function(){Object(F.leftPanelDisabled)(!0)}),e.on("click","a",function(e){return!(e&&E.Magics.EventWhichMouseMiddle!==e.which&&Object(A.mailToHelper)(w()(this).attr("href"),$.capa(E.Capa.Composer)?c(64):null))}).on("click",".attachmentsPlace .attachmentIconParent",function(e){e&&e.stopPropagation&&e.stopPropagation()}).on("click",".attachmentsPlace .showPreplay",function(e){e&&e.stopPropagation&&e.stopPropagation();var t=G.a.dataFor(this);if(t&&Xe.a.supported)switch(!0){case Xe.a.supportedMp3&&t.isMp3():Xe.a.playMp3(t.linkDownload(),t.fileName);break;case Xe.a.supportedOgg&&t.isOgg():Xe.a.playOgg(t.linkDownload(),t.fileName);break;case Xe.a.supportedWav&&t.isWav():Xe.a.playWav(t.linkDownload(),t.fileName)}}).on("click",".attachmentsPlace .attachmentItem .attachmentNameParent",function(){var e=G.a.dataFor(this);e&&e.download&&Object(le.a)().download(e.linkDownload())}).on("click",".messageItemHeader .subjectParent .flagParent",function(){var e=n.message();e&&Object(le.a)().messageListAction(e.folderFullNameRaw,e.flagged()?E.MessageSetAction.UnsetFlag:E.MessageSetAction.SetFlag,[e])}).on("click",".thread-list .flagParent",function(){var e=G.a.dataFor(this);return e&&e.folder&&e.uid&&Object(le.a)().messageListAction(e.folder,e.flagged()?E.MessageSetAction.UnsetFlag:E.MessageSetAction.SetFlag,[e]),n.threadsDropdownTrigger(!0),!1}),D.a.focusedState.subscribe(function(e){E.Focused.MessageView!==e&&(t.scrollMessageToTop(),t.scrollMessageToLeft())}),F.keyScopeReal.subscribe(function(e){t.messageDomFocused(E.KeyState.MessageView===e&&!Object(A.inFocus)())}),this.oMessageScrollerDom=e.find(".messageItem .content"),this.oMessageScrollerDom=this.oMessageScrollerDom&&this.oMessageScrollerDom[0]?this.oMessageScrollerDom:null,this.initShortcuts()},a.prototype.escShortcuts=function(){return!this.viewModelVisibility()||!this.message()||(this.fullScreenMode()?(this.fullScreenMode(!1),E.Layout.NoPreview!==this.layout()&&D.a.focusedState(E.Focused.MessageList)):E.Layout.NoPreview===this.layout()?this.message(null):D.a.focusedState(E.Focused.MessageList),!1)},a.prototype.initShortcuts=function(){var n=this;Ie()("esc, backspace",E.KeyState.MessageView,S.a.bind(this.escShortcuts,this)),Ie()("enter",E.KeyState.MessageView,function(){return n.toggleFullScreen(),!1}),Ie()("r",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return!q.a.message()||(n.replyCommand(),!1)}),Ie()("a",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return!q.a.message()||(n.replyAllCommand(),!1)}),Ie()("f",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return!q.a.message()||(n.forwardCommand(),!1)}),Ie()("ctrl+i, command+i",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return q.a.message()&&n.showFullInfo(!n.showFullInfo()),!1}),Ie()("b",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return!q.a.message()||!q.a.message().body||(q.a.message().body.find(".rlBlockquoteSwitcher").click(),!1)}),Ie()("ctrl+up, command+up, ctrl+left, command+left",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.goUpCommand(),!1}),Ie()("ctrl+down, command+down, ctrl+right, command+right",[E.KeyState.MessageList,E.KeyState.MessageView],function(){return n.goDownCommand(),!1}),Ie()("ctrl+p, command+p",[E.KeyState.MessageView,E.KeyState.MessageList],function(){return n.message()&&n.message().printMessage(),!1}),Ie()("delete, shift+delete",E.KeyState.MessageView,function(e,t){return!e||(t&&"shift+delete"===t.shortcut?n.deleteWithoutMoveCommand():n.deleteCommand(),!1)}),Ie()("tab, shift+tab, left",E.KeyState.MessageView,function(e,t){if(!n.fullScreenMode()&&n.message()&&E.Layout.NoPreview!==n.layout())if(e&&t&&"left"===t.shortcut){if(n.oMessageScrollerDom&&0<n.oMessageScrollerDom.scrollLeft())return!0;D.a.focusedState(E.Focused.MessageList)}else D.a.focusedState(E.Focused.MessageList);else if(n.message()&&E.Layout.NoPreview===n.layout()&&e&&t&&"left"===t.shortcut)return!0;return!1})},a.prototype.isDraftFolder=function(){return q.a.message()&&V.a.draftFolder()===q.a.message().folderFullNameRaw},a.prototype.isSentFolder=function(){return q.a.message()&&V.a.sentFolder()===q.a.message().folderFullNameRaw},a.prototype.isSpamFolder=function(){return q.a.message()&&V.a.spamFolder()===q.a.message().folderFullNameRaw},a.prototype.isSpamDisabled=function(){return q.a.message()&&V.a.spamFolder()===j.r},a.prototype.isArchiveFolder=function(){return q.a.message()&&V.a.archiveFolder()===q.a.message().folderFullNameRaw},a.prototype.isArchiveDisabled=function(){return q.a.message()&&V.a.archiveFolder()===j.r},a.prototype.isDraftOrSentFolder=function(){return this.isDraftFolder()||this.isSentFolder()},a.prototype.composeClick=function(){$.capa(E.Capa.Composer)&&Object(ue.showScreenPopup)(c(64))},a.prototype.editMessage=function(){$.capa(E.Capa.Composer)&&q.a.message()&&Object(ue.showScreenPopup)(c(64),[E.ComposeType.Draft,q.a.message()])},a.prototype.scrollMessageToTop=function(){this.oMessageScrollerDom&&(E.Magics.Size50px<this.oMessageScrollerDom.scrollTop()?this.oMessageScrollerDom.scrollTop(E.Magics.Size50px).animate({scrollTop:0},E.Magics.Time200ms):this.oMessageScrollerDom.scrollTop(0),Object(A.windowResize)())},a.prototype.scrollMessageToLeft=function(){this.oMessageScrollerDom&&(this.oMessageScrollerDom.scrollLeft(0),Object(A.windowResize)())},a.prototype.getAttachmentsHashes=function(){var e=this.message()?this.message().attachments():[];return S.a.compact(S.a.map(e,function(e){return e&&!e.isLinked&&e.checked()?e.download:""}))},a.prototype.downloadAsZip=function(){var t=this,e=this.getAttachmentsHashes();0<e.length?Z.a.attachmentsActions("Zip",e,this.downloadAsZipLoading).then(function(e){e&&e.Result&&e.Result.Files&&e.Result.Files[0]&&e.Result.Files[0].Hash?Object(le.a)().download(Object(L.c)(e.Result.Files[0].Hash)):t.downloadAsZipError(!0)}).catch(function(){t.downloadAsZipError(!0)}):this.highlightUnselectedAttachments(!0)},a.prototype.saveToOwnCloud=function(){var t=this,e=this.getAttachmentsHashes();0<e.length?Z.a.attachmentsActions("OwnCloud",e,this.saveToOwnCloudLoading).then(function(e){e&&e.Result?t.saveToOwnCloudSuccess(!0):t.saveToOwnCloudError(!0)}).catch(function(){t.saveToOwnCloudError(!0)}):this.highlightUnselectedAttachments(!0)},a.prototype.saveToDropbox=function(){var e=this,n=[],t=this.getAttachmentsHashes();0<t.length?y.a.Dropbox&&Z.a.attachmentsActions("Dropbox",t,this.saveToDropboxLoading).then(function(t){t&&t.Result&&t.Result.Url&&t.Result.ShortLife&&t.Result.Files&&(y.a.Dropbox&&Object(A.isArray)(t.Result.Files)?(S.a.each(t.Result.Files,function(e){n.push({url:t.Result.Url+Object(L.c)(e.Hash,t.Result.ShortLife),filename:e.FileName})}),y.a.Dropbox.save({files:n,progress:function(){e.saveToDropboxLoading(!0),e.saveToDropboxError(!1),e.saveToDropboxSuccess(!1)},cancel:function(){e.saveToDropboxSuccess(!1),e.saveToDropboxError(!1),e.saveToDropboxLoading(!1)},success:function(){e.saveToDropboxSuccess(!0),e.saveToDropboxLoading(!1)},error:function(){e.saveToDropboxError(!0),e.saveToDropboxLoading(!1)}})):e.saveToDropboxError(!0))}).catch(function(){e.saveToDropboxError(!0)}):this.highlightUnselectedAttachments(!0)},a.prototype.showImages=function(e){e&&e.showExternalImages&&e.showExternalImages(!0),this.checkHeaderHeight()},a.prototype.printableCheckedMessageCount=function(){var e=this.messageListCheckedOrSelectedUidsWithSubMails().length;return 0<e?e<100?e:"99+":""},a.prototype.readReceipt=function(e){e&&""!==e.readReceipt()&&(X.a.sendReadReceiptMessage(A.noop,e.folderFullNameRaw,e.uid,e.readReceipt(),Object(P.i18n)("READ_RECEIPT/SUBJECT",{SUBJECT:e.subject()}),Object(P.i18n)("READ_RECEIPT/BODY",{"READ-RECEIPT":U.a.email()})),e.isReadReceipt(!0),Object(I.u)(e),Object(le.a)().reloadFlagsCurrentMessageListAndMessageFromCache()),this.checkHeaderHeight()},a}(de.a)).prototype,"closeMessageCommand",[Ge],se()(Ye.prototype,"closeMessageCommand"),Ye.prototype),Ze(Ye.prototype,"messageVisibilityCommand",[Ke],se()(Ye.prototype,"messageVisibilityCommand"),Ye.prototype),Ze(Ye.prototype,"messageEditCommand",[Ve],se()(Ye.prototype,"messageEditCommand"),Ye.prototype),Ze(Ye.prototype,"goUpCommand",[ze],se()(Ye.prototype,"goUpCommand"),Ye.prototype),Ze(Ye.prototype,"goDownCommand",[qe],se()(Ye.prototype,"goDownCommand"),Ye.prototype),We=Ye))||We),mt=function(e){function t(){return p()(this,t),f()(this,e.call(this,"mailbox",[_e,Pe,Je,ft]))}return b()(t,e),t.prototype.updateWindowTitle=function(){var e=V.a.foldersInboxUnreadCount(),t=U.a.email();$.appSettingsGet("listPermanentFiltered")&&(e=0),Object(le.a)().setWindowTitle((""===t?"":(0<e?"("+e+") ":" ")+t+" - ")+Object(P.i18n)("TITLES/MAILBOX"))},t.prototype.onShow=function(){this.updateWindowTitle(),D.a.focusedState(E.Focused.None),D.a.focusedState(E.Focused.MessageList),$.appSettingsGet("mobile")&&Object(F.leftPanelDisabled)(!0),$.capa(E.Capa.Folders)?Object(F.leftPanelType)(""):Object(F.leftPanelType)($.capa(E.Capa.Composer)||$.capa(E.Capa.Contacts)?"short":"none")},t.prototype.onRoute=function(e,t,n){var o=e.replace(/^(.+)~([\d]+)$/,"$2"),i=Object(I.e)(Object(I.f)(e.replace(/~([\d]+)$/,"")));i&&(e===o&&(o=""),V.a.currentFolder(i),q.a.messageListPage(t),q.a.messageListSearch(n),q.a.messageListThreadUid(o),Object(le.a)().reloadMessageList())},t.prototype.onStart=function(){var e=this;V.a.folderList.subscribe(A.windowResizeCallback),q.a.messageList.subscribe(A.windowResizeCallback),q.a.message.subscribe(A.windowResizeCallback),S.a.delay(function(){return k.a.layout.valueHasMutated()},E.Magics.Time50ms),S.a.delay(function(){return Object(ue.warmUpScreenPopup)(c(64))},E.Magics.Time500ms),_.b("mailbox.inbox-unread-count",function(t){V.a.foldersInboxUnreadCount(t);var n=U.a.email();S.a.each(U.a.accounts(),function(e){e&&n===e.email&&e.count(t)}),e.updateWindowTitle()})},t.prototype.onBuild=function(){F.bMobileDevice||$.appSettingsGet("mobile")||S.a.defer(function(){Object(le.a)().initHorizontalLayoutResizer(E.ClientSideKeyName.MessageListSize)}),F.$html.on("click","#rl-right",function(){Object(F.moveAction)(!1)})},t.prototype.routes=function(){var n=Object(I.h)(),e=function(e,t){return t[0]=Object(A.pString)(t[0]),t[1]=Object(A.pInt)(t[1]),t[1]=t[1]<=0?1:t[1],t[2]=Object(A.pString)(t[2]),""===e&&(t[0]=n,t[1]=1),[Object(A.decodeURI)(t[0]),t[1],Object(A.decodeURI)(t[2])]};return[[/^([a-zA-Z0-9~]+)\/p([1-9][0-9]*)\/(.+)\/?$/,{normalize_:e}],[/^([a-zA-Z0-9~]+)\/p([1-9][0-9]*)$/,{normalize_:e}],[/^([a-zA-Z0-9~]+)\/(.+)\/?$/,{normalize_:function(e,t){return t[0]=Object(A.pString)(t[0]),t[1]=Object(A.pString)(t[1]),""===e&&(t[0]=n),[Object(A.decodeURI)(t[0]),1,Object(A.decodeURI)(t[1])]}}],[/^([^\/]*)$/,{normalize_:e}]]},t}(ae.a),bt=c(116),gt=function(){function e(){var t=this;p()(this,e),this.language=ce.a.language,this.languages=ce.a.languages,this.messagesPerPage=k.a.messagesPerPage,this.messagesPerPageArray=j.j,this.editorDefaultType=k.a.editorDefaultType,this.layout=k.a.layout,this.usePreviewPane=k.a.usePreviewPane,this.soundNotificationIsSupported=x.a.soundNotificationIsSupported,this.enableSoundNotification=x.a.enableSoundNotification,this.enableDesktopNotification=x.a.enableDesktopNotification,this.isDesktopNotificationSupported=x.a.isDesktopNotificationSupported,this.isDesktopNotificationDenied=x.a.isDesktopNotificationDenied,this.showImages=k.a.showImages,this.useCheckboxesInList=k.a.useCheckboxesInList,this.threadsAllowed=D.a.threadsAllowed,this.useThreads=k.a.useThreads,this.replySameFolder=k.a.replySameFolder,this.allowLanguagesOnSettings=D.a.allowLanguagesOnSettings,this.languageFullName=G.a.computed(function(){return Object(A.convertLangName)(t.language())}),this.languageTrigger=G.a.observable(E.SaveSettingsStep.Idle).extend({throttle:E.Magics.Time100ms}),this.mppTrigger=G.a.observable(E.SaveSettingsStep.Idle),this.editorDefaultTypeTrigger=G.a.observable(E.SaveSettingsStep.Idle),this.layoutTrigger=G.a.observable(E.SaveSettingsStep.Idle),this.isAnimationSupported=F.bAnimationSupported,this.identities=B.a.identities,this.identityMain=G.a.computed(function(){var e=t.identities();return Object(A.isArray)(e)?S.a.find(e,function(e){return e&&""===e.id()}):null}),this.identityMainDesc=G.a.computed(function(){var e=t.identityMain();return e?e.formattedName():"---"}),this.editorDefaultTypes=G.a.computed(function(){return Object(P.trigger)(),[{id:E.EditorDefaultType.Html,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_EDITOR_HTML")},{id:E.EditorDefaultType.Plain,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_EDITOR_PLAIN")},{id:E.EditorDefaultType.HtmlForced,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_EDITOR_HTML_FORCED")},{id:E.EditorDefaultType.PlainForced,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_EDITOR_PLAIN_FORCED")}]}),this.layoutTypes=G.a.computed(function(){return Object(P.trigger)(),[{id:E.Layout.NoPreview,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_LAYOUT_NO_SPLIT")},{id:E.Layout.SidePreview,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_LAYOUT_VERTICAL_SPLIT")},{id:E.Layout.BottomPreview,name:Object(P.i18n)("SETTINGS_GENERAL/LABEL_LAYOUT_HORIZONTAL_SPLIT")}]})}return e.prototype.editMainIdentity=function(){var e=this.identityMain();e&&Object(ue.showScreenPopup)(c(157),[e])},e.prototype.testSoundNotification=function(){x.a.playSoundNotification(!0)},e.prototype.onBuild=function(){var i=this;S.a.delay(function(){var e=Object(A.settingsSaveHelperSimpleFunction)(i.editorDefaultTypeTrigger,i),t=Object(A.settingsSaveHelperSimpleFunction)(i.mppTrigger,i),n=Object(A.settingsSaveHelperSimpleFunction)(i.layoutTrigger,i),o=function(e){return function(){i.languageTrigger(e),S.a.delay(function(){return i.languageTrigger(E.SaveSettingsStep.Idle)},E.Magics.Time1s)}};i.language.subscribe(function(e){i.languageTrigger(E.SaveSettingsStep.Animate),Object(P.reload)(!1,e).then(o(E.SaveSettingsStep.TrueResult),o(E.SaveSettingsStep.FalseResult)).then(function(){X.a.saveSettings(null,{Language:e})})}),i.editorDefaultType.subscribe(X.a.saveSettingsHelper("EditorDefaultType",null,e)),i.messagesPerPage.subscribe(X.a.saveSettingsHelper("MPP",null,t)),i.showImages.subscribe(X.a.saveSettingsHelper("ShowImages",A.boolToAjax)),i.useCheckboxesInList.subscribe(X.a.saveSettingsHelper("UseCheckboxesInList",A.boolToAjax)),i.enableDesktopNotification.subscribe(function(e){Object(A.timeOutAction)("SaveDesktopNotifications",function(){X.a.saveSettings(null,{DesktopNotifications:Object(A.boolToAjax)(e)})},E.Magics.Time3s)}),i.enableSoundNotification.subscribe(function(e){Object(A.timeOutAction)("SaveSoundNotification",function(){X.a.saveSettings(null,{SoundNotification:Object(A.boolToAjax)(e)})},E.Magics.Time3s)}),i.replySameFolder.subscribe(function(e){Object(A.timeOutAction)("SaveReplySameFolder",function(){X.a.saveSettings(null,{ReplySameFolder:Object(A.boolToAjax)(e)})},E.Magics.Time3s)}),i.useThreads.subscribe(function(e){q.a.messageList([]),X.a.saveSettings(null,{UseThreads:Object(A.boolToAjax)(e)})}),i.layout.subscribe(function(e){q.a.messageList([]),X.a.saveSettings(n,{Layout:e})})},E.Magics.Time50ms)},e.prototype.onShow=function(){this.enableDesktopNotification.valueHasMutated()},e.prototype.selectLanguage=function(){Object(ue.showScreenPopup)(c(112),[this.language,this.languages(),ce.a.userLanguage()])},e}(),yt=function(){function t(){var e=this;p()(this,t),this.contactsAutosave=D.a.contactsAutosave,this.allowContactsSync=H.a.allowContactsSync,this.enableContactsSync=H.a.enableContactsSync,this.contactsSyncUrl=H.a.contactsSyncUrl,this.contactsSyncUser=H.a.contactsSyncUser,this.contactsSyncPass=H.a.contactsSyncPass,this.saveTrigger=G.a.computed(function(){return[e.enableContactsSync()?"1":"0",e.contactsSyncUrl(),e.contactsSyncUser(),e.contactsSyncPass()].join("|")}).extend({throttle:E.Magics.Time500ms})}return t.prototype.onBuild=function(){var e=this;this.contactsAutosave.subscribe(function(e){X.a.saveSettings(null,{ContactsAutosave:Object(A.boolToAjax)(e)})}),this.saveTrigger.subscribe(function(){X.a.saveContactsSyncData(null,e.enableContactsSync(),e.contactsSyncUrl(),e.contactsSyncUser(),e.contactsSyncPass())})},t}(),vt=function(){function e(){p()(this,e),this.allowAdditionalAccount=Object($.capa)(E.Capa.AdditionalAccounts),this.allowIdentities=Object($.capa)(E.Capa.Identities),this.accounts=U.a.accounts,this.identities=B.a.identities,this.accountForDeletion=G.a.observable(null).deleteAccessHelper(),this.identityForDeletion=G.a.observable(null).deleteAccessHelper()}return e.prototype.scrollableOptions=function(e){return{handle:".drag-handle",containment:e||"parent",axis:"y"}},e.prototype.addNewAccount=function(){Object(ue.showScreenPopup)(c(156))},e.prototype.editAccount=function(e){e&&e.canBeEdit()&&Object(ue.showScreenPopup)(c(156),[e])},e.prototype.addNewIdentity=function(){Object(ue.showScreenPopup)(c(157))},e.prototype.editIdentity=function(e){Object(ue.showScreenPopup)(c(157),[e])},e.prototype.deleteAccount=function(t){t&&t.deleteAccess()&&(this.accountForDeletion(null),t&&(this.accounts.remove(function(e){return t===e}),X.a.accountDelete(function(e,t){E.StorageResultType.Success===e&&t&&t.Result&&t.Reload?(Object(ue.routeOff)(),Object(ue.setHash)(Object(L.w)(),!0),Object(ue.routeOff)(),S.a.defer(function(){return y.a.location.reload()})):Object(le.a)().accountsAndIdentities()},t.email)))},e.prototype.deleteIdentity=function(t){t&&t.deleteAccess()&&(this.identityForDeletion(null),t&&(B.a.identities.remove(function(e){return t===e}),X.a.identityDelete(function(){Object(le.a)().accountsAndIdentities()},t.id)))},e.prototype.accountsAndIdentitiesAfterMove=function(){X.a.accountsAndIdentitiesSortOrder(null,U.a.accountsEmails.peek(),B.a.identitiesIDS.peek())},e.prototype.onBuild=function(e){var t=this;e.on("click",".accounts-list .account-item .e-action",function(){var e=G.a.dataFor(this);e&&t.editAccount(e)}).on("click",".identities-list .identity-item .e-action",function(){var e=G.a.dataFor(this);e&&t.editIdentity(e)})},e}(),St=c(98),Ot=function(e){function n(){p()(this,n);var t=f()(this,e.call(this,"FilterConditionModel"));return t.field=G.a.observable(E.FilterConditionField.From),t.type=G.a.observable(E.FilterConditionType.Contains),t.value=G.a.observable(""),t.value.error=G.a.observable(!1),t.valueSecond=G.a.observable(""),t.valueSecond.error=G.a.observable(!1),t.template=G.a.computed(function(){var e="";switch(t.field()){case E.FilterConditionField.Size:e="SettingsFiltersConditionSize";break;case E.FilterConditionField.Header:e="SettingsFiltersConditionMore";break;default:e="SettingsFiltersConditionDefault"}return e},t),t.field.subscribe(function(){t.value(""),t.valueSecond("")}),t.regDisposables([t.template]),t}return b()(n,e),n.prototype.verify=function(){return""===this.value()?(this.value.error(!0),!1):E.FilterConditionField.Header!==this.field()||""!==this.valueSecond()||(this.valueSecond.error(!0),!1)},n.prototype.parse=function(e){return!!(e&&e.Field&&e.Type)&&(this.field(Object(A.pString)(e.Field)),this.type(Object(A.pString)(e.Type)),this.value(Object(A.pString)(e.Value)),this.valueSecond(Object(A.pString)(e.ValueSecond)),!0)},n.prototype.toJson=function(){return{Field:this.field(),Type:this.type(),Value:this.value(),ValueSecond:this.valueSecond()}},n.prototype.cloneSelf=function(){var e=new n;return e.field(this.field()),e.type(this.type()),e.value(this.value()),e.valueSecond(this.valueSecond()),e},n}(ee.a),wt=function(e){function t(){p()(this,t);var i=f()(this,e.call(this,"FilterModel"));return i.enabled=G.a.observable(!0),i.id="",i.name=G.a.observable(""),i.name.error=G.a.observable(!1),i.name.focused=G.a.observable(!1),i.conditions=G.a.observableArray([]),i.conditionsType=G.a.observable(E.FilterRulesType.Any),i.actionValue=G.a.observable(""),i.actionValue.error=G.a.observable(!1),i.actionValueSecond=G.a.observable(""),i.actionValueThird=G.a.observable(""),i.actionValueFourth=G.a.observable(""),i.actionValueFourth.error=G.a.observable(!1),i.actionMarkAsRead=G.a.observable(!1),i.actionKeep=G.a.observable(!0),i.actionNoStop=G.a.observable(!1),i.actionType=G.a.observable(E.FiltersAction.MoveTo),i.actionType.subscribe(function(){i.actionValue(""),i.actionValue.error(!1),i.actionValueSecond(""),i.actionValueThird(""),i.actionValueFourth(""),i.actionValueFourth.error(!1)}),i.nameSub=G.a.computed(function(){var e,t,n="",o=i.actionValue();switch(i.actionType()){case E.FiltersAction.MoveTo:n=Object(P.i18n)("SETTINGS_FILTERS/SUBNAME_MOVE_TO",{FOLDER:(e=o,t=Object(I.e)(e),t?t.fullName.replace("."===t.delimiter?/\./:/[\\\/]+/," / "):e)});break;case E.FiltersAction.Forward:n=Object(P.i18n)("SETTINGS_FILTERS/SUBNAME_FORWARD_TO",{EMAIL:o});break;case E.FiltersAction.Vacation:n=Object(P.i18n)("SETTINGS_FILTERS/SUBNAME_VACATION_MESSAGE");break;case E.FiltersAction.Reject:n=Object(P.i18n)("SETTINGS_FILTERS/SUBNAME_REJECT");break;case E.FiltersAction.Discard:n=Object(P.i18n)("SETTINGS_FILTERS/SUBNAME_DISCARD")}return n?"("+n+")":""}),i.actionTemplate=G.a.computed(function(){var e="";switch(i.actionType()){case E.FiltersAction.Forward:e="SettingsFiltersActionForward";break;case E.FiltersAction.Vacation:e="SettingsFiltersActionVacation";break;case E.FiltersAction.Reject:e="SettingsFiltersActionReject";break;case E.FiltersAction.None:e="SettingsFiltersActionNone";break;case E.FiltersAction.Discard:e="SettingsFiltersActionDiscard";break;case E.FiltersAction.MoveTo:default:e="SettingsFiltersActionMoveToFolder"}return e}),i.regDisposables(i.conditions.subscribe(A.windowResizeCallback)),i.regDisposables(i.name.subscribe(function(e){i.name.error(""===e)})),i.regDisposables(i.actionValue.subscribe(function(e){i.actionValue.error(""===e)})),i.regDisposables([i.actionNoStop,i.actionTemplate]),i.deleteAccess=G.a.observable(!1),i.canBeDeleted=G.a.observable(!0),i}return b()(t,e),t.prototype.generateID=function(){this.id=Object(A.fakeMd5)()},t.prototype.verify=function(){return""===this.name()?(this.name.error(!0),!1):!(0<this.conditions().length&&S.a.find(this.conditions(),function(e){return e&&!e.verify()})||(""===this.actionValue()&&-1<Object(A.inArray)(this.actionType(),[E.FiltersAction.MoveTo,E.FiltersAction.Forward,E.FiltersAction.Reject,E.FiltersAction.Vacation])?(this.actionValue.error(!0),1):E.FiltersAction.Forward===this.actionType()&&-1===this.actionValue().indexOf("@")?(this.actionValue.error(!0),1):E.FiltersAction.Vacation===this.actionType()&&""!==this.actionValueFourth()&&-1===this.actionValueFourth().indexOf("@")?(this.actionValueFourth.error(!0),1):(this.name.error(!1),this.actionValue.error(!1),0)))},t.prototype.toJson=function(){return{ID:this.id,Enabled:this.enabled()?"1":"0",Name:this.name(),ConditionsType:this.conditionsType(),Conditions:S.a.map(this.conditions(),function(e){return e.toJson()}),ActionValue:this.actionValue(),ActionValueSecond:this.actionValueSecond(),ActionValueThird:this.actionValueThird(),ActionValueFourth:this.actionValueFourth(),ActionType:this.actionType(),Stop:this.actionNoStop()?"0":"1",Keep:this.actionKeep()?"1":"0",MarkAsRead:this.actionMarkAsRead()?"1":"0"}},t.prototype.addCondition=function(){this.conditions.push(new Ot)},t.prototype.removeCondition=function(e){this.conditions.remove(e),Object(A.delegateRunOnDestroy)(e)},t.prototype.setRecipients=function(){this.actionValueFourth(U.a.accountsEmails().join(", "))},t.prototype.parse=function(e){var t=!1;return e&&"Object/Filter"===e["@Object"]&&(this.id=Object(A.pString)(e.ID),this.name(Object(A.pString)(e.Name)),this.enabled(!!e.Enabled),this.conditionsType(Object(A.pString)(e.ConditionsType)),this.conditions([]),Object(A.isNonEmptyArray)(e.Conditions)&&this.conditions(S.a.compact(S.a.map(e.Conditions,function(e){var t=new Ot;return t&&t.parse(e)?t:null}))),this.actionType(Object(A.pString)(e.ActionType)),this.actionValue(Object(A.pString)(e.ActionValue)),this.actionValueSecond(Object(A.pString)(e.ActionValueSecond)),this.actionValueThird(Object(A.pString)(e.ActionValueThird)),this.actionValueFourth(Object(A.pString)(e.ActionValueFourth)),this.actionNoStop(!e.Stop),this.actionKeep(!!e.Keep),this.actionMarkAsRead(!!e.MarkAsRead),t=!0),t},t.prototype.cloneSelf=function(){var e=new t;return e.id=this.id,e.enabled(this.enabled()),e.name(this.name()),e.name.error(this.name.error()),e.conditionsType(this.conditionsType()),e.actionMarkAsRead(this.actionMarkAsRead()),e.actionType(this.actionType()),e.actionValue(this.actionValue()),e.actionValue.error(this.actionValue.error()),e.actionValueSecond(this.actionValueSecond()),e.actionValueThird(this.actionValueThird()),e.actionValueFourth(this.actionValueFourth()),e.actionKeep(this.actionKeep()),e.actionNoStop(this.actionNoStop()),e.conditions(S.a.map(this.conditions(),function(e){return e.cloneSelf()})),e},t}(ee.a),Tt=(Qe=Object(ue.command)(function(e){return e.haveChanges()}),ct=(et=function(){function e(){var t=this;p()(this,e),this.modules=St.a.modules,this.filters=St.a.filters,this.inited=G.a.observable(!1),this.serverError=G.a.observable(!1),this.serverErrorDesc=G.a.observable(""),this.haveChanges=G.a.observable(!1),this.saveErrorText=G.a.observable(""),this.filters.subscribe(A.windowResizeCallback),this.serverError.subscribe(function(e){e||t.serverErrorDesc("")},this),this.filterRaw=St.a.raw,this.filterRaw.capa=St.a.capa,this.filterRaw.active=G.a.observable(!1),this.filterRaw.allow=G.a.observable(!1),this.filterRaw.error=G.a.observable(!1),this.filterForDeletion=G.a.observable(null).deleteAccessHelper(),this.filters.subscribe(function(){t.haveChanges(!0)}),this.filterRaw.subscribe(function(){t.haveChanges(!0),t.filterRaw.error(!1)}),this.haveChanges.subscribe(function(){t.saveErrorText("")}),this.filterRaw.active.subscribe(function(){t.haveChanges(!0),t.filterRaw.error(!1)})}return e.prototype.saveChangesCommand=function(){var n=this;if(!this.filters.saving()){if(this.filterRaw.active()&&""===Object(A.trim)(this.filterRaw()))return this.filterRaw.error(!0),!1;this.filters.saving(!0),this.saveErrorText(""),X.a.filtersSave(function(e,t){n.filters.saving(!1),E.StorageResultType.Success===e&&t&&t.Result?(n.haveChanges(!1),n.updateList()):t&&t.ErrorCode?n.saveErrorText(t.ErrorMessageAdditional||Object(P.getNotification)(t.ErrorCode)):n.saveErrorText(Object(P.getNotification)(E.Notification.CantSaveFilters))},this.filters(),this.filterRaw(),this.filterRaw.active())}return!0},e.prototype.scrollableOptions=function(e){return{handle:".drag-handle",containment:e||"parent",axis:"y"}},e.prototype.updateList=function(){var n=this;this.filters.loading()||(this.filters.loading(!0),X.a.filtersGet(function(e,t){n.filters.loading(!1),n.serverError(!1),E.StorageResultType.Success===e&&t&&t.Result&&Object(A.isArray)(t.Result.Filters)?(n.inited(!0),n.serverError(!1),n.filters(S.a.compact(S.a.map(t.Result.Filters,function(e){var t=new wt;return t&&t.parse(e)?t:null}))),n.modules(t.Result.Modules?t.Result.Modules:{}),n.filterRaw(t.Result.Raw||""),n.filterRaw.capa(Object(A.isArray)(t.Result.Capa)?t.Result.Capa.join(" "):""),n.filterRaw.active(!!t.Result.RawIsActive),n.filterRaw.allow(!!t.Result.RawIsAllow)):(n.filters([]),n.modules({}),n.filterRaw(""),n.filterRaw.capa({}),n.serverError(!0),n.serverErrorDesc(t&&t.ErrorCode?Object(P.getNotification)(t.ErrorCode):Object(P.getNotification)(E.Notification.CantGetFilters))),n.haveChanges(!1)}))},e.prototype.deleteFilter=function(e){this.filters.remove(e),Object(A.delegateRunOnDestroy)(e)},e.prototype.addFilter=function(){var e=this,t=new wt;t.generateID(),Object(ue.showScreenPopup)(c(177),[t,function(){e.filters.push(t),e.filterRaw.active(!1)},!1])},e.prototype.editFilter=function(n){var o=this,i=n.cloneSelf();Object(ue.showScreenPopup)(c(177),[i,function(){var e=o.filters(),t=e.indexOf(n);-1<t&&e[t]&&(Object(A.delegateRunOnDestroy)(e[t]),e[t]=i,o.filters(e),o.haveChanges(!0))},!0])},e.prototype.onBuild=function(e){var t=this;e.on("click",".filter-item .e-action",function(){var e=G.a.dataFor(this);e&&t.editFilter(e)})},e.prototype.onShow=function(){this.updateList()},e}()).prototype,lt="saveChangesCommand",ut=[Qe],dt=se()(et.prototype,"saveChangesCommand"),pt=et.prototype,ht={},Object.keys(dt).forEach(function(e){ht[e]=dt[e]}),ht.enumerable=!!ht.enumerable,ht.configurable=!!ht.configurable,("value"in ht||ht.initializer)&&(ht.writable=!0),ht=ut.slice().reverse().reduce(function(e,t){return t(ct,lt,e)||e},ht),pt&&void 0!==ht.initializer&&(ht.value=ht.initializer?ht.initializer.call(pt):void 0,ht.initializer=void 0),void 0===ht.initializer&&(Object.defineProperty(ct,lt,ht),ht=null),et),Ct=function(){function e(){p()(this,e),this.capaAutoLogout=Object($.capa)(E.Capa.AutoLogout),this.capaTwoFactor=Object($.capa)(E.Capa.TwoFactor),this.autoLogout=k.a.autoLogout,this.autoLogout.trigger=G.a.observable(E.SaveSettingsStep.Idle),this.autoLogoutOptions=G.a.computed(function(){return Object(P.trigger)(),[{id:0,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_NEVER_OPTION_NAME")},{id:5,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_MINUTES_OPTION_NAME",{MINUTES:5})},{id:10,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_MINUTES_OPTION_NAME",{MINUTES:10})},{id:30,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_MINUTES_OPTION_NAME",{MINUTES:30})},{id:60,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_MINUTES_OPTION_NAME",{MINUTES:60})},{id:120,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_HOURS_OPTION_NAME",{HOURS:2})},{id:300,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_HOURS_OPTION_NAME",{HOURS:5})},{id:600,name:Object(P.i18n)("SETTINGS_SECURITY/AUTOLOGIN_HOURS_OPTION_NAME",{HOURS:10})}]})}return e.prototype.configureTwoFactor=function(){Object(ue.showScreenPopup)(c(178))},e.prototype.onBuild=function(){var t=this;this.capaAutoLogout&&S.a.delay(function(){var e=Object(A.settingsSaveHelperSimpleFunction)(t.autoLogout.trigger,t);t.autoLogout.subscribe(X.a.saveSettingsHelper("AutoLogout",A.pInt,e))})},e}();function At(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}var Et,Ft,jt,Nt,Rt,It,Lt,_t,Pt,Mt,Dt,kt=(tt=Object(ue.command)(function(e){return!e.googleLoggined()&&!e.googleActions()}),nt=Object(ue.command)(),ot=Object(ue.command)(function(e){return!e.facebookLoggined()&&!e.facebookActions()}),it=Object(ue.command)(),at=Object(ue.command)(function(e){return!e.twitterLoggined()&&!e.twitterActions()}),rt=Object(ue.command)(),At((st=function(){function e(){p()(this,e),this.googleEnable=M.a.google.enabled,this.googleEnableAuth=M.a.google.capa.auth,this.googleEnableAuthFast=M.a.google.capa.authFast,this.googleEnableDrive=M.a.google.capa.drive,this.googleEnablePreview=M.a.google.capa.preview,this.googleActions=M.a.google.loading,this.googleLoggined=M.a.google.loggined,this.googleUserName=M.a.google.userName,this.facebookEnable=M.a.facebook.enabled,this.facebookActions=M.a.facebook.loading,this.facebookLoggined=M.a.facebook.loggined,this.facebookUserName=M.a.facebook.userName,this.twitterEnable=M.a.twitter.enabled,this.twitterActions=M.a.twitter.loading,this.twitterLoggined=M.a.twitter.loggined,this.twitterUserName=M.a.twitter.userName}return e.prototype.connectGoogleCommand=function(){this.googleLoggined()||Object(le.a)().googleConnect()},e.prototype.disconnectGoogleCommand=function(){Object(le.a)().googleDisconnect()},e.prototype.connectFacebookCommand=function(){this.facebookLoggined()||Object(le.a)().facebookConnect()},e.prototype.disconnectFacebookCommand=function(){Object(le.a)().facebookDisconnect()},e.prototype.connectTwitterCommand=function(){this.twitterLoggined()||Object(le.a)().twitterConnect()},e.prototype.disconnectTwitterCommand=function(){Object(le.a)().twitterDisconnect()},e}()).prototype,"connectGoogleCommand",[tt],se()(st.prototype,"connectGoogleCommand"),st.prototype),At(st.prototype,"disconnectGoogleCommand",[nt],se()(st.prototype,"disconnectGoogleCommand"),st.prototype),At(st.prototype,"connectFacebookCommand",[ot],se()(st.prototype,"connectFacebookCommand"),st.prototype),At(st.prototype,"disconnectFacebookCommand",[it],se()(st.prototype,"disconnectFacebookCommand"),st.prototype),At(st.prototype,"connectTwitterCommand",[at],se()(st.prototype,"connectTwitterCommand"),st.prototype),At(st.prototype,"disconnectTwitterCommand",[rt],se()(st.prototype,"disconnectTwitterCommand"),st.prototype),st),xt=(Et=Object(ue.command)(function(e){return!e.changeProcess()&&""!==e.currentPassword()&&""!==e.newPassword()&&""!==e.newPassword2()}),It=(Ft=function(){function t(){var e=this;p()(this,t),this.changeProcess=G.a.observable(!1),this.errorDescription=G.a.observable(""),this.passwordMismatch=G.a.observable(!1),this.passwordUpdateError=G.a.observable(!1),this.passwordUpdateSuccess=G.a.observable(!1),this.currentPassword=G.a.observable(""),this.currentPassword.error=G.a.observable(!1),this.newPassword=G.a.observable(""),this.newPassword2=G.a.observable(""),this.currentPassword.subscribe(function(){e.passwordUpdateError(!1),e.passwordUpdateSuccess(!1),e.currentPassword.error(!1)}),this.newPassword.subscribe(function(){e.passwordUpdateError(!1),e.passwordUpdateSuccess(!1),e.passwordMismatch(!1)}),this.newPassword2.subscribe(function(){e.passwordUpdateError(!1),e.passwordUpdateSuccess(!1),e.passwordMismatch(!1)}),this.onChangePasswordResponse=S.a.bind(this.onChangePasswordResponse,this)}return t.prototype.saveNewPasswordCommand=function(){this.newPassword()!==this.newPassword2()?(this.passwordMismatch(!0),this.errorDescription(Object(P.i18n)("SETTINGS_CHANGE_PASSWORD/ERROR_PASSWORD_MISMATCH"))):(this.changeProcess(!0),this.passwordUpdateError(!1),this.passwordUpdateSuccess(!1),this.currentPassword.error(!1),this.passwordMismatch(!1),this.errorDescription(""),X.a.changePassword(this.onChangePasswordResponse,this.currentPassword(),this.newPassword()))},t.prototype.onHide=function(){this.changeProcess(!1),this.currentPassword(""),this.newPassword(""),this.newPassword2(""),this.errorDescription(""),this.passwordMismatch(!1),this.currentPassword.error(!1)},t.prototype.onChangePasswordResponse=function(e,t){this.changeProcess(!1),this.passwordMismatch(!1),this.errorDescription(""),this.currentPassword.error(!1),E.StorageResultType.Success===e&&t&&t.Result?(this.currentPassword(""),this.newPassword(""),this.newPassword2(""),this.passwordUpdateSuccess(!0),this.currentPassword.error(!1),Object(le.a)().setClientSideToken(t.Result)):(t&&E.Notification.CurrentPasswordIncorrect===t.ErrorCode&&this.currentPassword.error(!0),this.passwordUpdateError(!0),this.errorDescription(Object(P.getNotificationFromResponse)(t,E.Notification.CouldNotSaveNewPassword)))},t}()).prototype,Lt="saveNewPasswordCommand",_t=[Et],Pt=se()(Ft.prototype,"saveNewPasswordCommand"),Mt=Ft.prototype,Dt={},Object.keys(Pt).forEach(function(e){Dt[e]=Pt[e]}),Dt.enumerable=!!Dt.enumerable,Dt.configurable=!!Dt.configurable,("value"in Dt||Dt.initializer)&&(Dt.writable=!0),Dt=_t.slice().reverse().reduce(function(e,t){return t(It,Lt,e)||e},Dt),Mt&&void 0!==Dt.initializer&&(Dt.value=Dt.initializer?Dt.initializer.call(Mt):void 0,Dt.initializer=void 0),void 0===Dt.initializer&&(Object.defineProperty(It,Lt,Dt),Dt=null),Ft),Ut=function(){function t(){var e=this;p()(this,t),this.templates=K.templates,this.processText=G.a.computed(function(){return K.templates.loading()?Object(P.i18n)("SETTINGS_TEMPLETS/LOADING_PROCESS"):""}),this.visibility=G.a.computed(function(){return""===e.processText()?"hidden":"visible"}),this.templateForDeletion=G.a.observable(null).deleteAccessHelper()}return t.prototype.scrollableOptions=function(e){return{handle:".drag-handle",containment:e||"parent",axis:"y"}},t.prototype.addNewTemplate=function(){Object(ue.showScreenPopup)(c(179))},t.prototype.editTemplate=function(e){e&&Object(ue.showScreenPopup)(c(179),[e])},t.prototype.deleteTemplate=function(t){var e=this;t&&t.deleteAccess()&&(this.templateForDeletion(null),t&&(this.templates.remove(function(e){return t===e}),X.a.templateDelete(function(){e.reloadTemplates()},t.id)))},t.prototype.reloadTemplates=function(){Object(le.a)().templates()},t.prototype.onBuild=function(e){var t=this;e.on("click",".templates-list .template-item .e-action",function(){var e=G.a.dataFor(this);e&&t.editTemplate(e)}),this.reloadTemplates()},t}(),Ht=function(){function e(){p()(this,e),this.displaySpecSetting=V.a.displaySpecSetting,this.folderList=V.a.folderList,this.folderListHelp=G.a.observable("").extend({throttle:E.Magics.Time100ms}),this.loading=G.a.computed(function(){var e=V.a.foldersLoading(),t=V.a.foldersCreating(),n=V.a.foldersDeleting(),o=V.a.foldersRenaming();return e||t||n||o}),this.folderForDeletion=G.a.observable(null).deleteAccessHelper(),this.folderForEdit=G.a.observable(null).extend({toggleSubscribeProperty:[this,"edited"]}),this.useImapSubscribe=!!Object($.appSettingsGet)("useImapSubscribe")}return e.prototype.folderEditOnEnter=function(e){var t=e?Object(A.trim)(e.nameForEdit()):"";""!==t&&e.name()!==t&&(Y.b(E.ClientSideKeyName.FoldersLashHash,""),Object(le.a)().foldersPromisesActionHelper(Z.a.folderRename(e.fullNameRaw,t,V.a.foldersRenaming),E.Notification.CantRenameFolder),Object(I.o)(e.fullNameRaw),e.name(t)),e.edited(!1)},e.prototype.folderEditOnEsc=function(e){e&&e.edited(!1)},e.prototype.onShow=function(){V.a.folderList.error("")},e.prototype.onBuild=function(e){var t=this;e.on("mouseover",".delete-folder-parent",function(){t.folderListHelp(Object(P.i18n)("SETTINGS_FOLDERS/HELP_DELETE_FOLDER"))}).on("mouseover",".subscribe-folder-parent",function(){t.folderListHelp(Object(P.i18n)("SETTINGS_FOLDERS/HELP_SHOW_HIDE_FOLDER"))}).on("mouseover",".check-folder-parent",function(){t.folderListHelp(Object(P.i18n)("SETTINGS_FOLDERS/HELP_CHECK_FOR_NEW_MESSAGES"))}).on("mouseout",".subscribe-folder-parent, .check-folder-parent, .delete-folder-parent",function(){t.folderListHelp("")})},e.prototype.createFolder=function(){Object(ue.showScreenPopup)(c(176))},e.prototype.systemFolder=function(){Object(ue.showScreenPopup)(c(119))},e.prototype.deleteFolder=function(n){n&&n.canBeDeleted()&&n.deleteAccess()&&0===n.privateMessageCountAll()?(this.folderForDeletion(null),n&&(Y.b(E.ClientSideKeyName.FoldersLashHash,""),V.a.folderList.remove(function e(t){return n===t||(t.subFolders.remove(e),!1)}),Object(le.a)().foldersPromisesActionHelper(Z.a.folderDelete(n.fullNameRaw,V.a.foldersDeleting),E.Notification.CantDeleteFolder),Object(I.o)(n.fullNameRaw))):0<n.privateMessageCountAll()&&V.a.folderList.error(Object(P.getNotification)(E.Notification.CantDeleteNonEmptyFolder))},e.prototype.subscribeFolder=function(e){Y.b(E.ClientSideKeyName.FoldersLashHash,""),X.a.folderSetSubscribe(A.noop,e.fullNameRaw,!0),e.subScribed(!0)},e.prototype.unSubscribeFolder=function(e){Y.b(E.ClientSideKeyName.FoldersLashHash,""),X.a.folderSetSubscribe(A.noop,e.fullNameRaw,!1),e.subScribed(!1)},e.prototype.checkableTrueFolder=function(e){X.a.folderSetCheckable(A.noop,e.fullNameRaw,!0),e.checkable(!0)},e.prototype.checkableFalseFolder=function(e){X.a.folderSetCheckable(A.noop,e.fullNameRaw,!1),e.checkable(!1)},e}(),Bt=c(40),Gt=function(){function t(){var e=this;p()(this,t),this.theme=Bt.a.theme,this.themes=Bt.a.themes,this.themesObjects=G.a.observableArray([]),this.background={},this.background.name=Bt.a.themeBackgroundName,this.background.hash=Bt.a.themeBackgroundHash,this.background.uploaderButton=G.a.observable(null),this.background.loading=G.a.observable(!1),this.background.error=G.a.observable(""),this.capaUserBackground=G.a.observable(Object($.capa)(E.Capa.UserBackground)),this.themeTrigger=G.a.observable(E.SaveSettingsStep.Idle).extend({throttle:E.Magics.Time100ms}),this.iTimer=0,this.oThemeAjaxRequest=null,this.theme.subscribe(function(t){S.a.each(e.themesObjects(),function(e){e.selected(t===e.name)}),Object(A.changeTheme)(t,e.themeTrigger),X.a.saveSettings(null,{Theme:t})}),this.background.hash.subscribe(function(e){var t=w()("#rl-bg");e?t.attr("style","background-image: none !important;").backstretch(Object(L.J)(e),{fade:E.Magics.Time1s,centeredX:!0,centeredY:!0}).removeAttr("style"):t.data("backstretch")&&t.backstretch("destroy").attr("style","")})}return t.prototype.onBuild=function(){var t=this.theme();this.themesObjects(S.a.map(this.themes(),function(e){return{name:e,nameDisplay:Object(A.convertThemeName)(e),selected:G.a.observable(e===t),themePreviewSrc:Object(L.F)(e)}})),this.initUploader()},t.prototype.onShow=function(){this.background.error("")},t.prototype.clearBackground=function(){var e=this;this.capaUserBackground()&&X.a.clearUserBackground(function(){e.background.name(""),e.background.hash("")})},t.prototype.initUploader=function(){var i=this;this.background.uploaderButton()&&this.capaUserBackground()&&new De.a({action:Object(L.H)(),name:"uploader",queueSize:1,multipleSizeLimit:1,disableDragAndDrop:!0,disableMultiple:!0,clickElement:this.background.uploaderButton()}).on("onStart",function(){return i.background.loading(!0),i.background.error(""),!0}).on("onComplete",function(e,t,n){if(i.background.loading(!1),t&&e&&n&&n.Result&&n.Result.Name&&n.Result.Hash)i.background.name(n.Result.Name),i.background.hash(n.Result.Hash);else{i.background.name(""),i.background.hash("");var o="";if(n.ErrorCode)switch(n.ErrorCode){case E.UploadErrorCode.FileIsTooBig:o=Object(P.i18n)("SETTINGS_THEMES/ERROR_FILE_IS_TOO_BIG");break;case E.UploadErrorCode.FileType:o=Object(P.i18n)("SETTINGS_THEMES/ERROR_FILE_TYPE_ERROR")}!o&&n.ErrorMessage&&(o=n.ErrorMessage),i.background.error(o||Object(P.i18n)("SETTINGS_THEMES/ERROR_UNKNOWN"))}return!0})},t}(),Kt=function(){function e(){p()(this,e),this.openpgpkeys=z.a.openpgpkeys,this.openpgpkeysPublic=z.a.openpgpkeysPublic,this.openpgpkeysPrivate=z.a.openpgpkeysPrivate,this.openPgpKeyForDeletion=G.a.observable(null).deleteAccessHelper(),this.allowDraftAutosave=k.a.allowDraftAutosave,this.isHttps=F.bIsHttps}return e.prototype.addOpenPgpKey=function(){Object(ue.showScreenPopup)(c(211))},e.prototype.generateOpenPgpKey=function(){Object(ue.showScreenPopup)(c(212))},e.prototype.viewOpenPgpKey=function(e){e&&Object(ue.showScreenPopup)(c(213),[e])},e.prototype.deleteOpenPgpKey=function(t){if(t&&t.deleteAccess()&&(this.openPgpKeyForDeletion(null),t&&z.a.openpgpKeyring)){var e=S.a.find(z.a.openpgpkeys(),function(e){return t===e});e&&(z.a.openpgpkeys.remove(e),Object(A.delegateRunOnDestroy)(e),z.a.openpgpKeyring[e.isPrivate?"privateKeys":"publicKeys"].removeForId(e.guid),z.a.openpgpKeyring.store()),Object(le.a)().reloadOpenPgpKeys()}},e.prototype.onBuild=function(){var e=this;S.a.delay(function(){e.allowDraftAutosave.subscribe(X.a.saveSettingsHelper("AllowDraftAutosave",A.boolToAjax))},E.Magics.Time50ms)},e}(),Vt=Object(ue.view)({name:"View/User/Settings/SystemDropDown",type:ue.ViewType.Right,templateID:"SystemDropDown"})(jt=function(e){function t(){return p()(this,t),f()(this,e.apply(this,arguments))}return b()(t,e),t}(Le))||jt,zt=Object(ue.view)({name:"View/User/Settings/Menu",type:ue.ViewType.Left,templateID:"SettingsMenu"})(Nt=function(n){function o(e){p()(this,o);var t=f()(this,n.call(this));return t.leftPanelDisabled=F.leftPanelDisabled,t.mobile=$.appSettingsGet("mobile"),t.menu=e.menu,t}return b()(o,n),o.prototype.onBuild=function(e){this.mobile&&e.on("click",".b-settings-menu .e-item.selectable",function(){Object(F.leftPanelDisabled)(!0)}),Ie()("up, down",E.KeyState.Settings,Object(ue.settingsMenuKeysHendler)(w()(".b-settings-menu .e-item",e)))},o.prototype.link=function(e){return Object(L.z)(e)},o.prototype.backToMailBoxClick=function(){Object(ue.setHash)(Object(L.m)(Object(I.h)()))},o}(de.a))||Nt,qt=Object(ue.view)({name:"View/User/Settings/Pane",type:ue.ViewType.Right,templateID:"SettingsPane"})(Rt=function(t){function n(){p()(this,n);var e=f()(this,t.call(this));return e.mobile=$.appSettingsGet("mobile"),e.leftPanelDisabled=F.leftPanelDisabled,e}return b()(n,t),n.prototype.onShow=function(){q.a.message(null)},n.prototype.hideLeft=function(e,t){t.preventDefault(),t.stopPropagation(),Object(F.leftPanelDisabled)(!0)},n.prototype.showLeft=function(e,t){t.preventDefault(),t.stopPropagation(),Object(F.leftPanelDisabled)(!1)},n.prototype.onBuild=function(e){this.mobile&&e.on("click",function(){Object(F.leftPanelDisabled)(!0)})},n.prototype.backToMailBoxClick=function(){Object(ue.setHash)(Object(L.m)(Object(I.h)()))},n}(de.a))||Rt,Wt=function(t){function n(){p()(this,n);var e=f()(this,t.call(this,[Vt,zt,qt]));return Object(P.initOnStartOrLangChange)(function(){e.sSettingsTitle=Object(P.i18n)("TITLES/SETTINGS")},function(){e.setSettingsTitle()}),e}return b()(n,t),n.prototype.setupSettings=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return $.capa(E.Capa.Settings)?(Object(ue.addSettingsViewModel)(gt,"SettingsGeneral","SETTINGS_LABELS/LABEL_GENERAL_NAME","general",!0),D.a.contactsIsAllowed()&&Object(ue.addSettingsViewModel)(yt,"SettingsContacts","SETTINGS_LABELS/LABEL_CONTACTS_NAME","contacts"),($.capa(E.Capa.AdditionalAccounts)||$.capa(E.Capa.Identities))&&Object(ue.addSettingsViewModel)(vt,"SettingsAccounts",$.capa(E.Capa.AdditionalAccounts)?"SETTINGS_LABELS/LABEL_ACCOUNTS_NAME":"SETTINGS_LABELS/LABEL_IDENTITIES_NAME","accounts"),$.capa(E.Capa.Sieve)&&Object(ue.addSettingsViewModel)(Tt,"SettingsFilters","SETTINGS_LABELS/LABEL_FILTERS_NAME","filters"),($.capa(E.Capa.AutoLogout)||$.capa(E.Capa.TwoFactor))&&Object(ue.addSettingsViewModel)(Ct,"SettingsSecurity","SETTINGS_LABELS/LABEL_SECURITY_NAME","security"),U.a.isRootAccount()&&($.settingsGet("AllowGoogleSocial")&&$.settingsGet("AllowGoogleSocialAuth")||$.settingsGet("AllowFacebookSocial")||$.settingsGet("AllowTwitterSocial"))&&Object(ue.addSettingsViewModel)(kt,"SettingsSocial","SETTINGS_LABELS/LABEL_SOCIAL_NAME","social"),$.settingsGet("ChangePasswordIsAllowed")&&Object(ue.addSettingsViewModel)(xt,"SettingsChangePassword","SETTINGS_LABELS/LABEL_CHANGE_PASSWORD_NAME","change-password"),$.capa(E.Capa.Templates)&&Object(ue.addSettingsViewModel)(Ut,"SettingsTemplates","SETTINGS_LABELS/LABEL_TEMPLATES_NAME","templates"),$.capa(E.Capa.Folders)&&Object(ue.addSettingsViewModel)(Ht,"SettingsFolders","SETTINGS_LABELS/LABEL_FOLDERS_NAME","folders"),$.capa(E.Capa.Themes)&&Object(ue.addSettingsViewModel)(Gt,"SettingsThemes","SETTINGS_LABELS/LABEL_THEMES_NAME","themes"),$.capa(E.Capa.OpenPGP)&&Object(ue.addSettingsViewModel)(Kt,"SettingsOpenPGP","SETTINGS_LABELS/LABEL_OPEN_PGP_NAME","openpgp"),Object(N.g)(!1),e&&e(),!0):(e&&e(),!1)},n.prototype.onShow=function(){this.setSettingsTitle(),Object(F.keyScope)(E.KeyState.Settings),Object(F.leftPanelType)(""),$.appSettingsGet("mobile")&&Object(F.leftPanelDisabled)(!0)},n.prototype.setSettingsTitle=function(){var e=U.a.email();Object(le.a)().setWindowTitle((""===e?"":e+" - ")+this.sSettingsTitle)},n}(bt.a),Yt=function(t){function e(){p()(this,e);var n=f()(this,t.call(this,X.a));return n.moveCache={},n.quotaDebounce=S.a.debounce(n.quota,E.Magics.Time30s),n.moveOrDeleteResponseHelper=S.a.bind(n.moveOrDeleteResponseHelper,n),n.messagesMoveTrigger=S.a.debounce(n.messagesMoveTrigger,500),y.a.setInterval(function(){return _.a("interval.30s")},E.Magics.Time30s),y.a.setInterval(function(){return _.a("interval.1m")},E.Magics.Time1m),y.a.setInterval(function(){return _.a("interval.2m")},E.Magics.Time2m),y.a.setInterval(function(){return _.a("interval.3m")},E.Magics.Time3m),y.a.setInterval(function(){return _.a("interval.5m")},E.Magics.Time5m),y.a.setInterval(function(){return _.a("interval.10m")},E.Magics.Time10m),y.a.setInterval(function(){return _.a("interval.15m")},E.Magics.Time15m),y.a.setInterval(function(){return _.a("interval.20m")},E.Magics.Time20m),y.a.setTimeout(function(){return y.a.setInterval(function(){return _.a("interval.2m-after5m")},E.Magics.Time2m)},E.Magics.Time5m),y.a.setTimeout(function(){return y.a.setInterval(function(){return _.a("interval.5m-after5m")},E.Magics.Time5m)},E.Magics.Time5m),y.a.setTimeout(function(){return y.a.setInterval(function(){return _.a("interval.10m-after5m")},E.Magics.Time10m)},E.Magics.Time5m),w.a.wakeUp(function(){Object(J.a)()&&n.reload(),X.a.jsVersion(function(e,t){E.StorageResultType.Success===e&&t&&!t.Result&&n.reload()},$.appSettingsGet("version"))},{},E.Magics.Time60m),Object(J.a)()&&n.reload(),$.settingsGet("UserBackgroundHash")&&S.a.delay(function(){w()("#rl-bg").attr("style","background-image: none !important;").backstretch(Object(L.J)($.settingsGet("UserBackgroundHash")),{fade:F.bAnimationSupported?E.Magics.Time1s:0,centeredX:!0,centeredY:!0}).removeAttr("style")},E.Magics.Time1s),n.socialUsers=S.a.bind(n.socialUsers,n),n}return b()(e,t),e.prototype.remote=function(){return X.a},e.prototype.reload=function(){y.a.parent&&$.appSettingsGet("inIframe")?y.a.parent.location.reload():y.a.location.reload()},e.prototype.reloadFlagsCurrentMessageListAndMessageFromCache=function(){S.a.each(q.a.messageList(),function(e){Object(I.n)(e)}),Object(I.n)(q.a.message())},e.prototype.reloadMessageList=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(q.a.messageListPage()-1)*k.a.messagesPerPage();t&&Object(I.q)(V.a.currentFolderFullNameRaw(),""),e&&(q.a.messageListPage(1),q.a.messageListPageBeforeThread(1),n=0,Object(ue.setHash)(Object(L.o)(V.a.currentFolderFullNameHash(),q.a.messageListPage(),q.a.messageListSearch(),q.a.messageListThreadUid()),!0,!0)),q.a.messageListLoading(!0),X.a.messageList(function(e,t,n){E.StorageResultType.Success===e&&t&&t.Result?(q.a.messageListError(""),q.a.messageListLoading(!1),q.a.setMessageList(t,n)):E.StorageResultType.Unload===e?(q.a.messageListError(""),q.a.messageListLoading(!1)):E.StorageResultType.Abort!==e&&(q.a.messageList([]),q.a.messageListLoading(!1),q.a.messageListError(t&&t.ErrorCode?Object(P.getNotification)(t.ErrorCode):Object(P.i18n)("NOTIFICATIONS/CANT_GET_MESSAGE_LIST")))},V.a.currentFolderFullNameRaw(),n,k.a.messagesPerPage(),q.a.messageListSearch(),q.a.messageListThreadUid())},e.prototype.recacheInboxMessageList=function(){X.a.messageList(A.noop,Object(I.h)(),0,k.a.messagesPerPage(),"","",!0)},e.prototype.contactsSync=function(n){var o=H.a.contacts;return!(o.importing()||o.syncing()||!H.a.enableContactsSync()||!H.a.allowContactsSync()||(o.syncing(!0),X.a.contactsSync(function(e,t){o.syncing(!1),n&&n(e,t)}),0))},e.prototype.messagesMoveTrigger=function(){var i=this,a=V.a.trashFolder(),r=V.a.spamFolder();S.a.each(this.moveCache,function(e){var t=r===e.To,n=a===e.To,o=!t&&r===e.From&&Object(I.h)()===e.To;X.a.messagesMove(i.moveOrDeleteResponseHelper,e.From,e.To,e.Uid,t?"SPAM":o?"HAM":"",t||n)}),this.moveCache={}},e.prototype.messagesMoveHelper=function(e,t,n){var o="$$"+e+"$$"+t+"$$";this.moveCache[o]||(this.moveCache[o]={From:e,To:t,Uid:[]}),this.moveCache[o].Uid=S.a.union(this.moveCache[o].Uid,n),this.messagesMoveTrigger()},e.prototype.messagesCopyHelper=function(e,t,n){X.a.messagesCopy(this.moveOrDeleteResponseHelper,e,t,n)},e.prototype.messagesDeleteHelper=function(e,t){X.a.messagesDelete(this.moveOrDeleteResponseHelper,e,t)},e.prototype.moveOrDeleteResponseHelper=function(e,t){E.StorageResultType.Success===e&&V.a.currentFolder()&&(t&&Object(A.isArray)(t.Result)&&2===t.Result.length?Object(I.q)(t.Result[0],t.Result[1]):(Object(I.q)(V.a.currentFolderFullNameRaw(),""),t&&-1<Object(A.inArray)(t.ErrorCode,[E.Notification.CantMoveMessage,E.Notification.CantCopyMessage])&&y.a.alert(Object(P.getNotification)(t.ErrorCode))),this.reloadMessageList(0===q.a.messageList().length),this.quotaDebounce())},e.prototype.deleteMessagesFromFolderWithoutCheck=function(e,t){this.messagesDeleteHelper(e,t),q.a.removeMessagesFromList(e,t)},e.prototype.deleteMessagesFromFolder=function(e,t,n,o){var i=this,a=null,r=null;switch(e){case E.FolderType.Spam:a=Object(I.e)(V.a.spamFolder()),r=E.SetSystemFoldersNotification.Spam;break;case E.FolderType.NotSpam:a=Object(I.e)(Object(I.h)());break;case E.FolderType.Trash:a=Object(I.e)(V.a.trashFolder()),r=E.SetSystemFoldersNotification.Trash;break;case E.FolderType.Archive:a=Object(I.e)(V.a.archiveFolder()),r=E.SetSystemFoldersNotification.Archive}(o=!!Object(A.isUnd)(o)||!!o)&&(E.FolderType.Spam===e&&j.r===V.a.spamFolder()||E.FolderType.Trash===e&&j.r===V.a.trashFolder()||E.FolderType.Archive===e&&j.r===V.a.archiveFolder())&&(o=!1),!a&&o?Object(ue.showScreenPopup)(c(119),[r]):o&&(E.FolderType.Trash!==e||t!==V.a.spamFolder()&&t!==V.a.trashFolder())?a&&(this.messagesMoveHelper(t,a.fullNameRaw,n),q.a.removeMessagesFromList(t,n,a.fullNameRaw)):Object(ue.showScreenPopup)(c(99),[Object(P.i18n)("POPUPS_ASK/DESC_WANT_DELETE_MESSAGES"),function(){i.messagesDeleteHelper(t,n),q.a.removeMessagesFromList(t,n)}])},e.prototype.moveMessagesToFolder=function(e,t,n,o){if(e!==n&&Object(A.isArray)(t)&&0<t.length){var i=Object(I.e)(e),a=Object(I.e)(n);if(i&&a)return!Object(A.isUnd)(o)&&o?this.messagesCopyHelper(i.fullNameRaw,a.fullNameRaw,t):this.messagesMoveHelper(i.fullNameRaw,a.fullNameRaw,t),q.a.removeMessagesFromList(i.fullNameRaw,t,a.fullNameRaw,o),!0}return!1},e.prototype.foldersReload=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=Z.a.foldersReload(V.a.foldersLoading);e&&t.then(function(e){return!!e}).then(e).catch(function(){S.a.delay(function(){e&&e(!1)},1)})},e.prototype.foldersPromisesActionHelper=function(e,t){Z.a.abort("Folders").fastResolve(!0).then(function(){return e}).then(function(){Z.a.foldersReloadWithTimeout(V.a.foldersLoading)},function(e){V.a.folderList.error(Object(P.getNotification)(e,"",t)),Z.a.foldersReloadWithTimeout(V.a.foldersLoading)})},e.prototype.reloadOpenPgpKeys=function(){if(z.a.capaOpenPGP()){var r=[],s=new Q.EmailModel,e=z.a.openpgpKeyring,t=e?e.getAllKeys():[];S.a.each(t,function(e,t){if(e&&e.primaryKey){var n=[],o=[],i=e.getPrimaryUser(),a=i&&i.user?i.user.userId.userid:e.users&&e.users[0]?e.users[0].userId.userid:"";e.users&&S.a.each(e.users,function(e){e.userId&&(s.clear(),s.parse(e.userId.userid),s.validate()&&(n.push(s.email),o.push(e.userId.userid)))}),n.length&&r.push(new ie(t,e.primaryKey.getFingerprint(),e.primaryKey.getKeyId().toHex().toLowerCase(),S.a.uniq(S.a.compact(S.a.map(e.getKeyIds(),function(e){return e&&e.toHex?e.toHex():null}))),o,n,e.isPrivate(),e.armor(),a))}}),Object(A.delegateRunOnDestroy)(z.a.openpgpkeys()),z.a.openpgpkeys(r)}},e.prototype.accountsCounts=function(){return!1},e.prototype.accountsAndIdentities=function(a){var r=this;U.a.accounts.loading(!0),B.a.identities.loading(!0),X.a.accountsAndIdentities(function(e,t){if(U.a.accounts.loading(!1),B.a.identities.loading(!1),E.StorageResultType.Success===e&&t.Result){var n={},o=U.a.email(),i=$.settingsGet("ParentEmail");i=""===i?o:i,Object(A.isArray)(t.Result.Accounts)&&(S.a.each(U.a.accounts(),function(e){n[e.email]=e.count()}),Object(A.delegateRunOnDestroy)(U.a.accounts()),U.a.accounts(S.a.map(t.Result.Accounts,function(e){return new te(e,e!==i,n[e]||0)}))),!Object(A.isUnd)(a)&&a&&(S.a.delay(function(){return r.accountsCounts()},5e3),_.b("interval.10m-after5m",function(){return r.accountsCounts()})),Object(A.isArray)(t.Result.Identities)&&(Object(A.delegateRunOnDestroy)(B.a.identities()),B.a.identities(S.a.map(t.Result.Identities,function(e){var t=Object(A.pString)(e.Id),n=Object(A.pString)(e.Email),o=new ne(t,n);return o.name(Object(A.pString)(e.Name)),o.replyTo(Object(A.pString)(e.ReplyTo)),o.bcc(Object(A.pString)(e.Bcc)),o.signature(Object(A.pString)(e.Signature)),o.signatureInsertBefore(!!e.SignatureInsertBefore),o})))}})},e.prototype.templates=function(){K.templates.loading(!0),X.a.templates(function(e,t){K.templates.loading(!1),E.StorageResultType.Success===e&&t.Result&&Object(A.isArray)(t.Result.Templates)&&(Object(A.delegateRunOnDestroy)(K.templates()),K.templates(S.a.compact(S.a.map(t.Result.Templates,function(e){var t=new oe;return t.parse(e)?t:null}))))})},e.prototype.quota=function(){X.a.quota(function(e,t){E.StorageResultType.Success===e&&t&&t.Result&&Object(A.isArray)(t.Result)&&1<t.Result.length&&Object(A.isPosNumeric)(t.Result[0],!0)&&Object(A.isPosNumeric)(t.Result[1],!0)&&W.populateData(Object(A.pInt)(t.Result[1]),Object(A.pInt)(t.Result[0]))})},e.prototype.folderInformation=function(e,t){var c=this;""!==Object(A.trim)(e)&&X.a.folderInformation(function(e,t){if(E.StorageResultType.Success===e&&t&&t.Result&&t.Result.Hash&&t.Result.Folder){var n="",o=!1,i=!1,a=Object(I.e)(t.Result.Folder);if(a){if(a.interval=Object(R.momentNowUnix)(),t.Result.Hash&&Object(I.q)(t.Result.Folder,t.Result.Hash),Object(A.isNormal)(t.Result.MessageCount)&&a.messageCountAll(t.Result.MessageCount),Object(A.isNormal)(t.Result.MessageUnseenCount)&&(Object(A.pInt)(a.messageCountUnread())!==Object(A.pInt)(t.Result.MessageUnseenCount)&&(i=!0),a.messageCountUnread(t.Result.MessageUnseenCount)),i&&Object(I.c)(a.fullNameRaw),t.Result.Flags){for(n in t.Result.Flags)if(Object(A.has)(t.Result.Flags,n)){o=!0;var r=t.Result.Flags[n];Object(I.v)(a.fullNameRaw,n.toString(),[!r.IsSeen,!!r.IsFlagged,!!r.IsAnswered,!!r.IsForwarded,!!r.IsReadReceipt])}o&&c.reloadFlagsCurrentMessageListAndMessageFromCache()}q.a.initUidNextAndNewMessages(a.fullNameRaw,t.Result.UidNext,t.Result.NewMessages);var s=Object(I.g)(t.Result.Folder);(t.Result.Hash!==s||""===s||i)&&(a.fullNameRaw===V.a.currentFolderFullNameRaw()?c.reloadMessageList():Object(I.h)()===a.fullNameRaw&&c.recacheInboxMessageList())}}},e,t)},e.prototype.folderInformationMultiply=function(){var r=this,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=V.a.getNextFolderNames();Object(A.isNonEmptyArray)(e)&&X.a.folderInformationMultiply(function(e,t){if(E.StorageResultType.Success===e&&t&&t.Result&&t.Result.List&&Object(A.isNonEmptyArray)(t.Result.List)){var a=Object(R.momentNowUnix)();S.a.each(t.Result.List,function(e){var t=Object(I.g)(e.Folder),n=Object(I.e)(e.Folder),o=!1;if(n)if(n.interval=a,e.Hash&&Object(I.q)(e.Folder,e.Hash),Object(A.isNormal)(e.MessageCount)&&n.messageCountAll(e.MessageCount),Object(A.isNormal)(e.MessageUnseenCount)&&(Object(A.pInt)(n.messageCountUnread())!==Object(A.pInt)(e.MessageUnseenCount)&&(o=!0),n.messageCountUnread(e.MessageUnseenCount)),o&&Object(I.c)(n.fullNameRaw),e.Hash!==t||""===t)n.fullNameRaw===V.a.currentFolderFullNameRaw()&&r.reloadMessageList();else if(o&&n.fullNameRaw===V.a.currentFolderFullNameRaw()){var i=q.a.messageList();Object(A.isNonEmptyArray)(i)&&r.folderInformation(n.fullNameRaw,i)}}),n&&S.a.delay(function(){return r.folderInformationMultiply(!0)},2e3)}},e)},e.prototype.messageListAction=function(t,n,e){var o,i=null,a=0;if(!Object(A.isUnd)(e)&&e||(e=q.a.messageListChecked()),o=S.a.uniq(S.a.compact(S.a.map(e,function(e){return e&&e.uid?e.uid:null}))),""!==t&&0<o.length){switch(n){case E.MessageSetAction.SetSeen:S.a.each(o,function(e){a+=Object(I.w)(t,e,n)}),(i=Object(I.e)(t))&&i.messageCountUnread(i.messageCountUnread()-a),X.a.messageSetSeen(A.noop,t,o,!0);break;case E.MessageSetAction.UnsetSeen:S.a.each(o,function(e){a+=Object(I.w)(t,e,n)}),(i=Object(I.e)(t))&&i.messageCountUnread(i.messageCountUnread()-a+o.length),X.a.messageSetSeen(A.noop,t,o,!1);break;case E.MessageSetAction.SetFlag:S.a.each(o,function(e){Object(I.w)(t,e,n)}),X.a.messageSetFlagged(A.noop,t,o,!0);break;case E.MessageSetAction.UnsetFlag:S.a.each(o,function(e){Object(I.w)(t,e,n)}),X.a.messageSetFlagged(A.noop,t,o,!1)}this.reloadFlagsCurrentMessageListAndMessageFromCache(),q.a.message.viewTrigger(!q.a.message.viewTrigger())}},e.prototype.googleConnect=function(){y.a.open(Object(L.B)(),"Google","left=200,top=100,width=650,height=600,menubar=no,status=no,resizable=yes,scrollbars=yes")},e.prototype.twitterConnect=function(){y.a.open(Object(L.C)(),"Twitter","left=200,top=100,width=650,height=350,menubar=no,status=no,resizable=yes,scrollbars=yes")},e.prototype.facebookConnect=function(){y.a.open(Object(L.A)(),"Facebook","left=200,top=100,width=650,height=335,menubar=no,status=no,resizable=yes,scrollbars=yes")},e.prototype.socialUsers=function(){!0===(0<arguments.length&&void 0!==arguments[0]&&arguments[0])&&(M.a.google.loading(!0),M.a.facebook.loading(!0),M.a.twitter.loading(!0)),X.a.socialUsers(function(e,t){E.StorageResultType.Success===e&&t&&t.Result?(M.a.google.userName(t.Result.Google||""),M.a.facebook.userName(t.Result.Facebook||""),M.a.twitter.userName(t.Result.Twitter||"")):(M.a.google.userName(""),M.a.facebook.userName(""),M.a.twitter.userName("")),M.a.google.loading(!1),M.a.facebook.loading(!1),M.a.twitter.loading(!1)})},e.prototype.googleDisconnect=function(){M.a.google.loading(!0),X.a.googleDisconnect(this.socialUsers)},e.prototype.facebookDisconnect=function(){M.a.facebook.loading(!0),X.a.facebookDisconnect(this.socialUsers)},e.prototype.twitterDisconnect=function(){M.a.twitter.loading(!0),X.a.twitterDisconnect(this.socialUsers)},e.prototype.getAutocomplete=function(e,n){X.a.suggestions(function(e,t){E.StorageResultType.Success===e&&t&&Object(A.isArray)(t.Result)?n(S.a.compact(S.a.map(t.Result,function(e){return e&&e[0]?new Q.EmailModel(e[0],e[1]):null}))):E.StorageResultType.Abort!==e&&n([])},e)},e.prototype.setExpandedFolder=function(e,t){var n=Y.a(E.ClientSideKeyName.ExpandedFolders);Object(A.isArray)(n)||(n=[]),t?(n.push(e),n=S.a.uniq(n)):n=S.a.without(n,e),Y.b(E.ClientSideKeyName.ExpandedFolders,n)},e.prototype.initHorizontalLayoutResizer=function(n){var o=null,i=null,a=function(e){e&&(o&&o.attr("style","height:"+e+"px"),i&&i.attr("style","top:"+(55+e)+"px"))},r={helper:"ui-resizable-helper-h",minHeight:200,maxHeight:500,handles:"s",create:function(e){e&&e.target&&w()(e.target).find(".ui-resizable-handle").on("mousedown",function(){F.$html.addClass("rl-resizer")}).on("mouseup",function(){F.$html.removeClass("rl-resizer")})},resize:S.a.debounce(function(){F.$html.addClass("rl-resizer")},500,!0),start:function(){F.$html.addClass("rl-resizer")},stop:function(e,t){F.$html.removeClass("rl-resizer"),t&&t.size&&t.size.height&&(Y.b(n,t.size.height),a(t.size.height),Object(A.windowResize)())}},t=function(e){if(e)o&&o.hasClass("ui-resizable")&&o.resizable("destroy").removeAttr("style"),i&&i.removeAttr("style");else if(F.$html.hasClass("rl-bottom-preview-pane")){o=w()(".b-message-list-wrapper"),i=w()(".b-message-view-wrapper"),o.hasClass("ui-resizable")||o.resizable(r);var t=Object(A.pInt)(Y.a(n))||300;a(200<t?t:200)}};t(!1),_.b("layout",function(e){t(E.Layout.BottomPreview!==e)})},e.prototype.initVerticalLayoutResizer=function(n){var o=w()("#rl-left"),i=w()("#rl-right"),e=Y.a(n)||null,a=function(e){e&&(Object(F.leftPanelWidth)(e),F.$html.removeClass("rl-resizer"),o.css({width:e+"px"}),i.css({left:e+"px"}))},t=function(e){if(e)o.resizable("disable"),a(60);else{o.resizable("enable");var t=Object(A.pInt)(Y.a(n))||155;a(155<t?t:155)}},r=S.a.debounce(function(){F.$html.addClass("rl-resizer")},500,!0);null!==e&&a(155<e?e:155),o.resizable({helper:"ui-resizable-helper-w",minWidth:155,maxWidth:E.Magics.Size350px,handles:"e",create:function(e){e&&e.target&&w()(e.target).find(".ui-resizable-handle").on("mousedown",function(){F.$html.addClass("rl-resizer")}).on("mouseup",function(){F.$html.removeClass("rl-resizer")})},resize:r,start:function(){F.$html.addClass("rl-resizer")},stop:function(e,t){F.$html.removeClass("rl-resizer"),t&&t.size&&t.size.width&&(Y.b(n,t.size.width),Object(F.leftPanelWidth)(t.size.width),i.css({left:t.size.width+"px"}),o.css({position:"",top:"",left:"",height:""}))}}),_.b("left-panel.off",function(){t(!0)}),_.b("left-panel.on",function(){t(!1)})},e.prototype.logout=function(){var e=this;X.a.logout(function(){e.loginAndLogoutReload(!1,!0,$.settingsGet("ParentEmail")&&0<$.settingsGet("ParentEmail").length)})},e.prototype.bootstartTwoFactorScreen=function(){Object(ue.showScreenPopup)(c(178),[!0])},e.prototype.bootstartWelcomePopup=function(e){Object(ue.showScreenPopup)(c(214),[e])},e.prototype.bootstartLoginScreen=function(){F.$html.removeClass("rl-user-auth").addClass("rl-user-no-auth");var e=Object(A.pString)($.appSettingsGet("customLoginLink"));e?(Object(ue.routeOff)(),Object(ue.setHash)(Object(L.w)(),!0),Object(ue.routeOff)(),S.a.defer(function(){y.a.location.href=e})):(Object(ue.startScreens)([Ne]),Object(N.f)("rl-start-login-screens"),_.a("rl.bootstart-login-screens"))},e.prototype.bootend=function(){C.a&&C.a.set(100).end(),Object(ue.hideLoading)()},e.prototype.bootstart=function(){var n=this;t.prototype.bootstart.call(this),D.a.populate(),k.a.populate(),x.a.populate(),U.a.populate(),H.a.populate();var o=Object(A.pInt)($.settingsGet("ContactsSyncInterval")),e=$.appSettingsGet("jsHash"),i=Object(A.pString)($.settingsGet("StartupUrl")),a=$.settingsGet("AllowGoogleSocial"),r=$.settingsGet("AllowFacebookSocial"),s=$.settingsGet("AllowTwitterSocial");C.a&&C.a.set(90),F.leftPanelDisabled.subscribe(function(e){_.a("left-panel."+(e?"off":"on"))}),this.setWindowTitle(""),$.settingsGet("Auth")?(F.$html.addClass("rl-user-auth"),$.capa(E.Capa.TwoFactor)&&$.capa(E.Capa.TwoFactorForce)&&$.settingsGet("RequireTwoFactor")?(this.bootend(),this.bootstartTwoFactorScreen()):(this.setWindowTitle(Object(P.i18n)("TITLES/LOADING")),this.foldersReload(function(e){if(n.bootend(),e){if(""!==i&&(Object(ue.routeOff)(),Object(ue.setHash)(Object(L.w)(i),!0),Object(ue.routeOn)()),A.jassl&&y.a.crypto&&y.a.crypto.getRandomValues&&$.capa(E.Capa.OpenPGP)){var t=function(e){if(z.a.openpgp=e,y.a.Worker)try{z.a.openpgp.initWorker({path:Object(L.t)()})}catch(e){Object(A.log)(e)}z.a.openpgpKeyring=new e.Keyring,z.a.capaOpenPGP(!0),_.a("openpgp.init"),n.reloadOpenPgpKeys()};y.a.openpgp?t(y.a.openpgp):Object(A.jassl)(Object(L.s)()).then(function(){y.a.openpgp&&t(y.a.openpgp)})}else z.a.capaOpenPGP(!1);Object(ue.startScreens)([mt,$.capa(E.Capa.Settings)?Wt:null]),(a||r||s)&&n.socialUsers(!0),_.b("interval.2m",function(){return n.folderInformation(Object(I.h)())}),_.b("interval.3m",function(){var e=V.a.currentFolderFullNameRaw();Object(I.h)()!==e&&n.folderInformation(e)}),_.b("interval.2m-after5m",function(){return n.folderInformationMultiply()}),_.b("interval.15m",function(){return n.quota()}),_.b("interval.20m",function(){return n.foldersReload()}),o=(o=5<=o?o:20)<=320?o:320,S.a.delay(function(){return n.contactsSync()},E.Magics.Time10s),S.a.delay(function(){return n.folderInformationMultiply(!0)},E.Magics.Time2s),y.a.setInterval(function(){return n.contactsSync()},6e4*o+5e3),n.accountsAndIdentities(!0),S.a.delay(function(){var e=V.a.currentFolderFullNameRaw();Object(I.h)()!==e&&n.folderInformation(e)},1e3),S.a.delay(function(){return n.quota()},5e3),S.a.delay(function(){return X.a.appDelayStart(A.noop)},35e3),_.b("rl.auto-logout",function(){return n.logout()}),Object(N.f)("rl-start-user-screens"),_.a("rl.bootstart-user-screens"),$.settingsGet("WelcomePageUrl")&&S.a.delay(function(){return n.bootstartWelcomePopup($.settingsGet("WelcomePageUrl"))},1e3),$.settingsGet("AccountSignMe")&&y.a.navigator.registerProtocolHandler&&$.capa(E.Capa.Composer)&&S.a.delay(function(){try{y.a.navigator.registerProtocolHandler("mailto",y.a.location.protocol+"//"+y.a.location.host+y.a.location.pathname+"?mailto&to=%s",""+($.settingsGet("Title")||"RainLoop"))}catch(e){}$.settingsGet("MailToEmail")&&Object(A.mailToHelper)($.settingsGet("MailToEmail"),c(64))},500),F.bMobileDevice||S.a.defer(function(){return n.initVerticalLayoutResizer(E.ClientSideKeyName.FolderListSize)})}else n.logout()}))):(this.bootend(),this.bootstartLoginScreen()),a&&(y.a["rl_"+e+"_google_service"]=function(){M.a.google.loading(!0),n.socialUsers()}),r&&(y.a["rl_"+e+"_facebook_service"]=function(){M.a.facebook.loading(!0),n.socialUsers()}),s&&(y.a["rl_"+e+"_twitter_service"]=function(){M.a.twitter.loading(!0),n.socialUsers()}),_.b("interval.1m",function(){return Object(R.reload)()}),Object(N.f)("rl-start-screens"),_.a("rl.bootstart-end")},e}(c(117).a);t.default=new Yt},,function(e,t){e.exports=window.qr},function(e,t,n){"use strict";n.r(t),n.d(t,"KeyboardShortcutsHelpPopupView",function(){return g}),n.d(t,"default",function(){return g});var o,i=n(8),a=n.n(i),r=n(11),s=n.n(r),c=n(12),l=n.n(c),u=n(4),d=n.n(u),p=n(19),h=n.n(p),f=n(0),m=n(9),b=n(24),g=Object(m.popup)({name:"View/Popup/KeyboardShortcutsHelp",templateID:"PopupsKeyboardShortcutsHelp"})(o=function(t){function n(){a()(this,n);var e=s()(this,t.call(this));return e.sDefaultKeyScope=f.KeyState.PopupKeyboardShortcutsHelp,e}return l()(n,t),n.prototype.onBuild=function(a){h()("tab, shift+tab, left, right",f.KeyState.PopupKeyboardShortcutsHelp,d.a.throttle(function(e,t){if(e&&t){var n=a.find(".nav.nav-tabs > li"),o=t&&("tab"===t.shortcut||"right"===t.shortcut),i=n.index(n.filter(".active"));return!o&&0<i?i-=1:o&&i<n.length-1?i+=1:i=o?0:n.length-1,n.eq(i).find('a[data-toggle="tab"]').tab("show"),!1}return!0},f.Magics.Time100ms))},n}(b.a))||o},function(e,t,n){"use strict";n.r(t),n.d(t,"FolderCreateView",function(){return I}),n.d(t,"default",function(){return I});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(0),T=n(23),C=n(6),A=n(2),E=n(13),F=n(51),j=n(20),N=n(9),R=n(24),I=(o=Object(N.popup)({name:"View/Popup/FolderCreate",templateID:"PopupsFolderCreate"}),i=Object(N.command)(function(e){return e.simpleFolderNameValidation(e.folderName())}),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.folderName=O.a.observable(""),e.folderName.focused=O.a.observable(!1),e.selectedParentValue=O.a.observable(T.r),e.parentFolderSelectList=O.a.computed(function(){var e=[],t=E.a.folderList();e.push(["",""]);var n=null;return""!==E.a.namespace&&(n=function(e){return E.a.namespace!==e.fullNameRaw.substr(0,E.a.namespace.length)}),Object(A.folderListOptionsBuilder)([],t,[],e,null,n,null,function(e){return e?e.isSystemFolder()?e.name()+" "+e.manageFolderSystemName():e.name():""})}),e.defautOptionsAfterRender=A.defautOptionsAfterRender,e}return S()(n,t),n.prototype.createFolderCommand=function(){var e=this.selectedParentValue();""===e&&1<E.a.namespace.length&&(e=E.a.namespace.substr(0,E.a.namespace.length-1)),Object(j.a)().foldersPromisesActionHelper(F.a.folderCreate(this.folderName(),e,E.a.foldersCreating),w.Notification.CantCreateFolder),this.cancelCommand()},n.prototype.simpleFolderNameValidation=function(e){return/^[^\\\/]+$/g.test(Object(A.trim)(e))},n.prototype.clearPopup=function(){this.folderName(""),this.selectedParentValue(""),this.folderName.focused(!1)},n.prototype.onShow=function(){this.clearPopup()},n.prototype.onShowWithDelay=function(){C.bMobileDevice||this.folderName.focused(!0)},n}(R.a)).prototype,c="createFolderCommand",l=[i],u=f()(r.prototype,"createFolderCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"FilterPopupView",function(){return L}),n.d(t,"default",function(){return L});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(4),w=n.n(O),T=n(1),C=n(0),A=n(6),E=n(2),F=n(10),j=n(98),N=n(13),R=n(9),I=n(24),L=(o=Object(R.popup)({name:"View/Popup/Filter",templateID:"PopupsFilter"}),i=Object(R.command)(),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.isNew=T.a.observable(!0),e.modules=j.a.modules,e.fTrueCallback=null,e.filter=T.a.observable(null),e.allowMarkAsRead=T.a.observable(!1),e.defautOptionsAfterRender=E.defautOptionsAfterRender,e.folderSelectList=N.a.folderMenuForFilters,e.selectedFolderValue=T.a.observable(""),e.selectedFolderValue.subscribe(function(){e.filter()&&e.filter().actionValue.error(!1)}),e.actionTypeOptions=T.a.observableArray([]),e.fieldOptions=T.a.observableArray([]),e.typeOptions=T.a.observableArray([]),e.typeOptionsSize=T.a.observableArray([]),Object(F.initOnStartOrLangChange)(w.a.bind(e.populateOptions,e)),e.modules.subscribe(e.populateOptions,e),e}return S()(n,t),n.prototype.saveFilterCommand=function(){if(this.filter()){if(C.FiltersAction.MoveTo===this.filter().actionType()&&this.filter().actionValue(this.selectedFolderValue()),!this.filter().verify())return!1;this.fTrueCallback&&this.fTrueCallback(this.filter()),this.modalVisibility()&&Object(E.delegateRun)(this,"closeCommand")}return!0},n.prototype.populateOptions=function(){this.actionTypeOptions([]);var e=this.modules();e&&(e.markasread&&this.allowMarkAsRead(!0),e.moveto&&this.actionTypeOptions.push({id:C.FiltersAction.MoveTo,name:Object(F.i18n)("POPUPS_FILTER/SELECT_ACTION_MOVE_TO")}),e.redirect&&this.actionTypeOptions.push({id:C.FiltersAction.Forward,name:Object(F.i18n)("POPUPS_FILTER/SELECT_ACTION_FORWARD_TO")}),e.reject&&this.actionTypeOptions.push({id:C.FiltersAction.Reject,name:Object(F.i18n)("POPUPS_FILTER/SELECT_ACTION_REJECT")}),e.vacation&&this.actionTypeOptions.push({id:C.FiltersAction.Vacation,name:Object(F.i18n)("POPUPS_FILTER/SELECT_ACTION_VACATION_MESSAGE")})),this.actionTypeOptions.push({id:C.FiltersAction.Discard,name:Object(F.i18n)("POPUPS_FILTER/SELECT_ACTION_DISCARD")}),this.fieldOptions([{id:C.FilterConditionField.From,name:Object(F.i18n)("POPUPS_FILTER/SELECT_FIELD_FROM")},{id:C.FilterConditionField.Recipient,name:Object(F.i18n)("POPUPS_FILTER/SELECT_FIELD_RECIPIENTS")},{id:C.FilterConditionField.Subject,name:Object(F.i18n)("POPUPS_FILTER/SELECT_FIELD_SUBJECT")},{id:C.FilterConditionField.Size,name:Object(F.i18n)("POPUPS_FILTER/SELECT_FIELD_SIZE")},{id:C.FilterConditionField.Header,name:Object(F.i18n)("POPUPS_FILTER/SELECT_FIELD_HEADER")}]),this.typeOptions([{id:C.FilterConditionType.Contains,name:Object(F.i18n)("POPUPS_FILTER/SELECT_TYPE_CONTAINS")},{id:C.FilterConditionType.NotContains,name:Object(F.i18n)("POPUPS_FILTER/SELECT_TYPE_NOT_CONTAINS")},{id:C.FilterConditionType.EqualTo,name:Object(F.i18n)("POPUPS_FILTER/SELECT_TYPE_EQUAL_TO")},{id:C.FilterConditionType.NotEqualTo,name:Object(F.i18n)("POPUPS_FILTER/SELECT_TYPE_NOT_EQUAL_TO")}]),e&&e.regex&&this.typeOptions.push({id:C.FilterConditionType.Regex,name:"Regex"}),this.typeOptionsSize([{id:C.FilterConditionType.Over,name:Object(F.i18n)("POPUPS_FILTER/SELECT_TYPE_OVER")},{id:C.FilterConditionType.Under,name:Object(F.i18n)("POPUPS_FILTER/SELECT_TYPE_UNDER")}])},n.prototype.removeCondition=function(e){this.filter()&&this.filter().removeCondition(e)},n.prototype.clearPopup=function(){this.isNew(!0),this.fTrueCallback=null,this.filter(null)},n.prototype.onShow=function(e,t,n){this.clearPopup(),this.fTrueCallback=t,this.filter(e),e&&this.selectedFolderValue(e.actionValue()),this.isNew(!n),!n&&e&&e.name.focused(!0)},n.prototype.onShowWithDelay=function(){this.isNew()&&this.filter()&&!A.bMobileDevice&&this.filter().name.focused(!0)},n}(I.a)).prototype,c="saveFilterCommand",l=[i],u=f()(r.prototype,"saveFilterCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"TwoFactorConfigurationPopupView",function(){return A}),n.d(t,"default",function(){return A});var o,i=n(8),a=n.n(i),r=n(11),s=n.n(r),c=n(12),l=n.n(c),u=n(3),d=n.n(u),p=n(4),h=n.n(p),f=n(1),m=n(174),b=n.n(m),g=n(0),y=n(2),v=n(10),S=n(5),O=n(17),w=n(20),T=n(9),C=n(24),A=Object(T.popup)({name:"View/Popup/TwoFactorConfiguration",templateID:"PopupsTwoFactorConfiguration"})(o=function(e){function t(){a()(this,t);var n=s()(this,e.call(this));return n.lock=f.a.observable(!1),n.capaTwoFactor=S.capa(g.Capa.TwoFactor),n.processing=f.a.observable(!1),n.clearing=f.a.observable(!1),n.secreting=f.a.observable(!1),n.viewUser=f.a.observable(""),n.twoFactorStatus=f.a.observable(!1),n.twoFactorTested=f.a.observable(!1),n.viewSecret=f.a.observable(""),n.viewBackupCodes=f.a.observable(""),n.viewUrlTitle=f.a.observable(""),n.viewUrl=f.a.observable(""),n.viewEnable_=f.a.observable(!1),n.viewEnable=f.a.computed({read:n.viewEnable_,write:function(e){(e=!!e)&&n.twoFactorTested()?(n.viewEnable_(e),O.a.enableTwoFactor(function(e,t){g.StorageResultType.Success===e&&t&&t.Result||n.viewEnable_(!1)},!0)):(e||n.viewEnable_(e),O.a.enableTwoFactor(function(e,t){g.StorageResultType.Success===e&&t&&t.Result||n.viewEnable_(!1)},!1))}}),n.viewTwoFactorEnableTooltip=f.a.computed(function(){return Object(v.trigger)(),n.twoFactorTested()||n.viewEnable_()?"":Object(v.i18n)("POPUPS_TWO_FACTOR_CFG/TWO_FACTOR_SECRET_TEST_BEFORE_DESC")}),n.viewTwoFactorStatus=f.a.computed(function(){return Object(v.trigger)(),Object(v.i18n)(n.twoFactorStatus()?"POPUPS_TWO_FACTOR_CFG/TWO_FACTOR_SECRET_CONFIGURED_DESC":"POPUPS_TWO_FACTOR_CFG/TWO_FACTOR_SECRET_NOT_CONFIGURED_DESC")}),n.twoFactorAllowedEnable=f.a.computed(function(){return n.viewEnable()||n.twoFactorTested()}),n.onResult=h.a.bind(n.onResult,n),n.onShowSecretResult=h.a.bind(n.onShowSecretResult,n),n}return l()(t,e),t.prototype.showSecret=function(){this.secreting(!0),O.a.showTwoFactorSecret(this.onShowSecretResult)},t.prototype.hideSecret=function(){this.viewSecret(""),this.viewBackupCodes(""),this.viewUrlTitle(""),this.viewUrl("")},t.prototype.createTwoFactor=function(){this.processing(!0),O.a.createTwoFactor(this.onResult)},t.prototype.logout=function(){Object(w.a)().logout()},t.prototype.testTwoFactor=function(){Object(T.showScreenPopup)(n(210),[this.twoFactorTested])},t.prototype.clearTwoFactor=function(){this.viewSecret(""),this.viewBackupCodes(""),this.viewUrlTitle(""),this.viewUrl(""),this.twoFactorTested(!1),this.clearing(!0),O.a.clearTwoFactor(this.onResult)},t.prototype.onShow=function(e){this.lock(!!e),this.viewSecret(""),this.viewBackupCodes(""),this.viewUrlTitle(""),this.viewUrl("")},t.prototype.onHide=function(){this.lock()&&d.a.location.reload()},t.prototype.getQr=function(){return"otpauth://totp/"+d.a.encodeURIComponent(this.viewUser())+"?secret="+d.a.encodeURIComponent(this.viewSecret())+"&issuer="+d.a.encodeURIComponent("")},t.prototype.onResult=function(e,t){this.processing(!1),this.clearing(!1),g.StorageResultType.Success===e&&t&&t.Result?(this.viewUser(Object(y.pString)(t.Result.User)),this.viewEnable_(!!t.Result.Enable),this.twoFactorStatus(!!t.Result.IsSet),this.twoFactorTested(!!t.Result.Tested),this.viewSecret(Object(y.pString)(t.Result.Secret)),this.viewBackupCodes(Object(y.pString)(t.Result.BackupCodes).replace(/[\s]+/g,"  ")),this.viewUrlTitle(Object(y.pString)(t.Result.UrlTitle)),this.viewUrl(b.a.toDataURL({level:"M",size:8,value:this.getQr()}))):(this.viewUser(""),this.viewEnable_(!1),this.twoFactorStatus(!1),this.twoFactorTested(!1),this.viewSecret(""),this.viewBackupCodes(""),this.viewUrlTitle(""),this.viewUrl(""))},t.prototype.onShowSecretResult=function(e,t){this.secreting(!1),g.StorageResultType.Success===e&&t&&t.Result?(this.viewSecret(Object(y.pString)(t.Result.Secret)),this.viewUrlTitle(Object(y.pString)(t.Result.UrlTitle)),this.viewUrl(b.a.toDataURL({level:"M",size:6,value:this.getQr()}))):(this.viewSecret(""),this.viewUrlTitle(""),this.viewUrl(""))},t.prototype.onBuild=function(){this.capaTwoFactor&&(this.processing(!0),O.a.getTwoFactor(this.onResult))},t}(C.a))||o},function(e,t,n){"use strict";n.r(t),n.d(t,"TemplatePopupView",function(){return R}),n.d(t,"default",function(){return R});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(0),T=n(2),C=n(10),A=n(95),E=n(17),F=n(20),j=n(9),N=n(24),R=(o=Object(j.popup)({name:"View/Popup/Template",templateID:"PopupsTemplate"}),i=Object(j.command)(function(e){return!e.submitRequest()}),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.editor=null,e.signatureDom=O.a.observable(null),e.id=O.a.observable(""),e.name=O.a.observable(""),e.name.error=O.a.observable(!1),e.name.focus=O.a.observable(!1),e.body=O.a.observable(""),e.body.loading=O.a.observable(!1),e.body.error=O.a.observable(!1),e.name.subscribe(function(){e.name.error(!1)}),e.body.subscribe(function(){e.body.error(!1)}),e.submitRequest=O.a.observable(!1),e.submitError=O.a.observable(""),e}return S()(n,t),n.prototype.addTemplateCommand=function(){var n=this;return this.populateBodyFromEditor(),this.name.error(""===Object(T.trim)(this.name())),this.body.error(""===Object(T.trim)(this.body())||":HTML:"===Object(T.trim)(this.body())),!this.name.error()&&!this.body.error()&&(this.submitRequest(!0),E.a.templateSetup(function(e,t){n.submitRequest(!1),w.StorageResultType.Success===e&&t?t.Result?(Object(F.a)().templates(),n.cancelCommand()):t.ErrorCode&&n.submitError(Object(C.getNotification)(t.ErrorCode)):n.submitError(Object(C.getNotification)(w.Notification.UnknownError))},this.id(),this.name(),this.body()),!0)},n.prototype.clearPopup=function(){this.id(""),this.name(""),this.name.error(!1),this.body(""),this.body.loading(!1),this.body.error(!1),this.submitRequest(!1),this.submitError(""),this.editor&&this.editor.setPlain("",!1)},n.prototype.populateBodyFromEditor=function(){this.editor&&this.body(this.editor.getDataWithHtmlMark())},n.prototype.editorSetBody=function(e){var t=this;!this.editor&&this.signatureDom()?this.editor=new A.HtmlEditor(this.signatureDom(),function(){t.populateBodyFromEditor()},function(){t.editor.setHtmlOrPlain(e)}):this.editor.setHtmlOrPlain(e)},n.prototype.onShow=function(n){var o=this;this.clearPopup(),n&&n.id?(this.id(n.id),this.name(n.name),this.body(n.body),n.populated?this.editorSetBody(this.body()):(this.body.loading(!0),this.body.error(!1),E.a.templateGetById(function(e,t){o.body.loading(!1),w.StorageResultType.Success===e&&t&&t.Result&&"Object/Template"===t.Result["@Object"]&&Object(T.isNormal)(t.Result.Body)?(n.body=t.Result.Body,n.populated=!0,o.body(n.body),o.body.error(!1)):(o.body(""),o.body.error(!0)),o.editorSetBody(o.body())},this.id()))):this.editorSetBody("")},n.prototype.onShowWithDelay=function(){this.name.focus(!0)},n}(N.a)).prototype,c="addTemplateCommand",l=[i],u=f()(r.prototype,"addTemplateCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},,function(e,t,r){"use strict";r.r(t);var n,o,i,a,s,c,l,u,d,p=r(18),h=r.n(p),f=r(8),m=r.n(f),b=r(11),g=r.n(b),y=r(12),v=r.n(y),S=r(3),O=r.n(S),w=r(4),T=r.n(w),C=r(7),A=r.n(C),E=r(1),F=r(19),j=r.n(F),N=r(79),R=r.n(N),I=r(0),L=r(2),_=r(23),P=r(6),M=r(120),D=r(16),k=r(10),x=r(28),U=r(57),H=r(17),B=r(5),G=r(45),K=r(36),V=function(t){function n(){m()(this,n);var e=g()(this,t.call(this,"ContactModel"));return e.idContact=0,e.display="",e.properties=[],e.readOnly=!1,e.focused=E.a.observable(!1),e.selected=E.a.observable(!1),e.checked=E.a.observable(!1),e.deleted=E.a.observable(!1),e}return v()(n,t),n.prototype.getNameAndEmailHelper=function(){var t="",n="";return Object(L.isNonEmptyArray)(this.properties)&&T.a.each(this.properties,function(e){e&&(I.ContactPropertyType.FirstName===e[0]?t=Object(L.trim)(e[1]+" "+t):I.ContactPropertyType.LastName===e[0]?t=Object(L.trim)(t+" "+e[1]):""===n&&I.ContactPropertyType.Email===e[0]&&(n=e[1]))}),""===n?null:[n,t]},n.prototype.parse=function(e){var t=this,n=!1;return e&&"Object/Contact"===e["@Object"]&&(this.idContact=Object(L.pInt)(e.IdContact),this.display=Object(L.pString)(e.Display),this.readOnly=!!e.ReadOnly,Object(L.isNonEmptyArray)(e.Properties)&&T.a.each(e.Properties,function(e){e&&e.Type&&Object(L.isNormal)(e.Value)&&Object(L.isNormal)(e.TypeStr)&&t.properties.push([Object(L.pInt)(e.Type),Object(L.pString)(e.Value),Object(L.pString)(e.TypeStr)])}),n=!0),n},n.prototype.srcAttr=function(){return Object(D.j)()},n.prototype.generateUid=function(){return Object(L.pString)(this.idContact)},n.prototype.lineAsCss=function(){var e=[];return this.deleted()&&e.push("deleted"),this.selected()&&e.push("selected"),this.checked()&&e.push("checked"),this.focused()&&e.push("focused"),e.join(" ")},n}(K.a),z=function(r){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:I.ContactPropertyType.Unknown,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"";m()(this,s);var a=g()(this,r.call(this,"ContactPropertyModel"));return a.type=E.a.observable(Object(L.pInt)(e)),a.typeStr=E.a.observable(Object(L.pString)(t)),a.focused=E.a.observable(!!o),a.value=E.a.observable(Object(L.pString)(n)),a.placeholder=E.a.observable(i),a.placeholderValue=E.a.computed(function(){var e=a.placeholder();return e?Object(k.i18n)(e):""}),a.largeValue=E.a.computed(function(){return I.ContactPropertyType.Note===a.type()}),a.regDisposables([a.placeholderValue,a.largeValue]),a}return v()(s,r),s}(K.a),q=r(20),W=r(9),Y=r(24);function $(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}r.d(t,"ContactsPopupView",function(){return J}),r.d(t,"default",function(){return J});var J=(n=Object(W.popup)({name:"View/Popup/Contacts",templateID:"PopupsContacts"}),o=Object(W.command)(),i=Object(W.command)(function(e){return 0<e.contactsCheckedOrSelected().length}),a=Object(W.command)(function(e){return 0<e.contactsCheckedOrSelected().length}),s=Object(W.command)(),c=Object(W.command)(function(e){var t=e.viewHasNonEmptyRequaredProperties(),n=e.viewReadOnly();return!e.viewSaving()&&t&&!n}),l=Object(W.command)(function(e){return!e.contacts.syncing()&&!e.contacts.importing()}),n(($((d=function(e){function a(){m()(this,a);var o=g()(this,e.call(this)),t=function(e){e&&0<e.length&&(o.viewProperties.removeAll(e),Object(L.delegateRunOnDestroy)(e))};return o.bBackToCompose=!1,o.sLastComposeFocusedField="",o.allowContactsSync=U.a.allowContactsSync,o.enableContactsSync=U.a.enableContactsSync,o.allowExport=!P.bMobileDevice,o.search=E.a.observable(""),o.contactsCount=E.a.observable(0),o.contacts=U.a.contacts,o.currentContact=E.a.observable(null),o.importUploaderButton=E.a.observable(null),o.contactsPage=E.a.observable(1),o.contactsPageCount=E.a.computed(function(){var e=O.a.Math.ceil(o.contactsCount()/_.c);return e<=0?1:e}),o.contactsPagenator=E.a.computed(Object(L.computedPagenatorHelper)(o.contactsPage,o.contactsPageCount)),o.emptySelection=E.a.observable(!0),o.viewClearSearch=E.a.observable(!1),o.viewID=E.a.observable(""),o.viewReadOnly=E.a.observable(!1),o.viewProperties=E.a.observableArray([]),o.viewSaveTrigger=E.a.observable(I.SaveSettingsStep.Idle),o.viewPropertiesNames=o.viewProperties.filter(function(e){return-1<Object(L.inArray)(e.type(),[I.ContactPropertyType.FirstName,I.ContactPropertyType.LastName])}),o.viewPropertiesOther=o.viewProperties.filter(function(e){return-1<Object(L.inArray)(e.type(),[I.ContactPropertyType.Note])}),o.viewPropertiesOther=E.a.computed(function(){var e=T.a.filter(o.viewProperties(),function(e){return-1<Object(L.inArray)(e.type(),[I.ContactPropertyType.Nick])});return T.a.sortBy(e,function(e){return e.type()})}),o.viewPropertiesEmails=o.viewProperties.filter(function(e){return I.ContactPropertyType.Email===e.type()}),o.viewPropertiesWeb=o.viewProperties.filter(function(e){return I.ContactPropertyType.Web===e.type()}),o.viewHasNonEmptyRequaredProperties=E.a.computed(function(){var e=o.viewPropertiesNames(),t=o.viewPropertiesEmails(),n=function(e){return""!==Object(L.trim)(e.value())};return!(!T.a.find(e,n)&&!T.a.find(t,n))}),o.viewPropertiesPhones=o.viewProperties.filter(function(e){return I.ContactPropertyType.Phone===e.type()}),o.viewPropertiesEmailsNonEmpty=o.viewPropertiesNames.filter(function(e){return""!==Object(L.trim)(e.value())}),o.viewPropertiesEmailsEmptyAndOnFocused=o.viewPropertiesEmails.filter(function(e){var t=e.focused();return""===Object(L.trim)(e.value())&&!t}),o.viewPropertiesPhonesEmptyAndOnFocused=o.viewPropertiesPhones.filter(function(e){var t=e.focused();return""===Object(L.trim)(e.value())&&!t}),o.viewPropertiesWebEmptyAndOnFocused=o.viewPropertiesWeb.filter(function(e){var t=e.focused();return""===Object(L.trim)(e.value())&&!t}),o.viewPropertiesOtherEmptyAndOnFocused=E.a.computed(function(){return T.a.filter(o.viewPropertiesOther(),function(e){var t=e.focused();return""===Object(L.trim)(e.value())&&!t})}),o.viewPropertiesEmailsEmptyAndOnFocused.subscribe(function(e){t(e)}),o.viewPropertiesPhonesEmptyAndOnFocused.subscribe(function(e){t(e)}),o.viewPropertiesWebEmptyAndOnFocused.subscribe(function(e){t(e)}),o.viewPropertiesOtherEmptyAndOnFocused.subscribe(function(e){t(e)}),o.viewSaving=E.a.observable(!1),o.useCheckboxesInList=x.a.useCheckboxesInList,o.search.subscribe(function(){o.reloadContactList()}),o.contacts.subscribe(L.windowResizeCallback),o.viewProperties.subscribe(L.windowResizeCallback),o.contactsChecked=E.a.computed(function(){return T.a.filter(o.contacts(),function(e){return e.checked()})}),o.contactsCheckedOrSelected=E.a.computed(function(){var e=o.contactsChecked(),t=o.currentContact();return T.a.union(e,t?[t]:[])}),o.contactsCheckedOrSelectedUids=E.a.computed(function(){return T.a.map(o.contactsCheckedOrSelected(),function(e){return e.idContact})}),o.selector=new M.a(o.contacts,o.currentContact,null,".e-contact-item .actionHandle",".e-contact-item.selected",".e-contact-item .checkboxItem",".e-contact-item.focused"),o.selector.on("onItemSelect",function(e){o.populateViewContact(e||null),e||o.emptySelection(!0)}),o.selector.on("onItemGetUid",function(e){return e?e.generateUid():""}),o.bDropPageAfterDelete=!1,o.watchDirty=E.a.observable(!1),o.watchHash=E.a.observable(!1),o.viewHash=E.a.computed(function(){return""+T.a.map(o.viewProperties(),function(e){return e.value()}).join("")}),o.viewHash.subscribe(function(){!o.watchHash()||o.viewReadOnly()||o.watchDirty()||o.watchDirty(!0)}),o.sDefaultKeyScope=I.KeyState.ContactList,o}return v()(a,e),a.prototype.newCommand=function(){this.populateViewContact(null),this.currentContact(null)},a.prototype.deleteCommand=function(){this.deleteSelectedContacts(),this.emptySelection(!0)},a.prototype.newMessageCommand=function(){if(!B.capa(I.Capa.Composer))return!1;var e=[],t=null,n=null,o=null,i=this.contactsCheckedOrSelected();if(Object(L.isNonEmptyArray)(i)&&(e=T.a.map(i,function(e){if(e){var t=e.getNameAndEmailHelper(),n=t?new G.EmailModel(t[0],t[1]):null;if(n&&n.validate())return n}return null}),e=T.a.compact(e)),Object(L.isNonEmptyArray)(e)){switch(this.bBackToCompose=!1,Object(W.hideScreenPopup)(a),this.sLastComposeFocusedField){case"cc":n=e;break;case"bcc":o=e;break;case"to":default:t=e}this.sLastComposeFocusedField="",T.a.delay(function(){Object(W.showScreenPopup)(r(64),[I.ComposeType.Empty,null,t,n,o])},I.Magics.Time200ms)}return!0},a.prototype.clearCommand=function(){this.search("")},a.prototype.saveCommand=function(){var o=this;this.viewSaving(!0),this.viewSaveTrigger(I.SaveSettingsStep.Animate);var i=Object(L.fakeMd5)(),t=[];T.a.each(this.viewProperties(),function(e){e.type()&&e.type()!==I.ContactPropertyType.FullName&&""!==Object(L.trim)(e.value())&&t.push([e.type(),e.value(),e.typeStr()])}),H.a.contactSave(function(e,t){var n=!1;o.viewSaving(!1),I.StorageResultType.Success===e&&t&&t.Result&&t.Result.RequestUid===i&&0<Object(L.pInt)(t.Result.ResultID)&&(""===o.viewID()&&o.viewID(Object(L.pInt)(t.Result.ResultID)),o.reloadContactList(),n=!0),T.a.delay(function(){o.viewSaveTrigger(n?I.SaveSettingsStep.TrueResult:I.SaveSettingsStep.FalseResult)},I.Magics.Time350ms),n&&(o.watchDirty(!1),T.a.delay(function(){o.viewSaveTrigger(I.SaveSettingsStep.Idle)},I.Magics.Time1s))},i,this.viewID(),t)},a.prototype.syncCommand=function(){var n=this;Object(q.a)().contactsSync(function(e,t){I.StorageResultType.Success===e&&t&&t.Result||O.a.alert(Object(k.getNotification)(t&&t.ErrorCode?t.ErrorCode:I.Notification.ContactsSyncError)),n.reloadContactList(!0)})},a.prototype.getPropertyPlaceholder=function(e){var t="";switch(e){case I.ContactPropertyType.LastName:t="CONTACTS/PLACEHOLDER_ENTER_LAST_NAME";break;case I.ContactPropertyType.FirstName:t="CONTACTS/PLACEHOLDER_ENTER_FIRST_NAME";break;case I.ContactPropertyType.Nick:t="CONTACTS/PLACEHOLDER_ENTER_NICK_NAME"}return t},a.prototype.addNewProperty=function(e,t){this.viewProperties.push(new z(e,t||"","",!0,this.getPropertyPlaceholder(e)))},a.prototype.addNewOrFocusProperty=function(t,e){var n=T.a.find(this.viewProperties(),function(e){return t===e.type()});n?n.focused(!0):this.addNewProperty(t,e)},a.prototype.addNewEmail=function(){this.addNewProperty(I.ContactPropertyType.Email,"Home")},a.prototype.addNewPhone=function(){this.addNewProperty(I.ContactPropertyType.Phone,"Mobile")},a.prototype.addNewWeb=function(){this.addNewProperty(I.ContactPropertyType.Web)},a.prototype.addNewNickname=function(){this.addNewOrFocusProperty(I.ContactPropertyType.Nick)},a.prototype.addNewNotes=function(){this.addNewOrFocusProperty(I.ContactPropertyType.Note)},a.prototype.addNewBirthday=function(){this.addNewOrFocusProperty(I.ContactPropertyType.Birthday)},a.prototype.exportVcf=function(){Object(q.a)().download(Object(D.l)())},a.prototype.exportCsv=function(){Object(q.a)().download(Object(D.k)())},a.prototype.initUploader=function(){var o=this;if(this.importUploaderButton()){var e=new R.a({action:Object(D.I)(),name:"uploader",queueSize:1,multipleSizeLimit:1,disableDragAndDrop:!0,disableMultiple:!0,disableDocumentDropPrevent:!0,clickElement:this.importUploaderButton()});e&&e.on("onStart",function(){o.contacts.importing(!0)}).on("onComplete",function(e,t,n){o.contacts.importing(!1),o.reloadContactList(),e&&t&&n&&n.Result||O.a.alert(Object(k.i18n)("CONTACTS/ERROR_IMPORT_FILE"))})}},a.prototype.removeCheckedOrSelectedContactsFromList=function(){var t=this,n=this.contacts,e=this.contactsCheckedOrSelected(),o=this.currentContact(),i=this.contacts().length;0<e.length&&(T.a.each(e,function(e){o&&o.idContact===e.idContact&&(o=null,t.currentContact(null)),e.deleted(!0),i-=1}),i<=0&&(this.bDropPageAfterDelete=!0),T.a.delay(function(){T.a.each(e,function(e){n.remove(e),Object(L.delegateRunOnDestroy)(e)})},I.Magics.Time500ms))},a.prototype.deleteSelectedContacts=function(){0<this.contactsCheckedOrSelected().length&&(H.a.contactsDelete(T.a.bind(this.deleteResponse,this),this.contactsCheckedOrSelectedUids()),this.removeCheckedOrSelectedContactsFromList())},a.prototype.deleteResponse=function(e,t){var n=this;I.Magics.Time500ms<(I.StorageResultType.Success===e&&t&&t.Time?Object(L.pInt)(t.Time):0)?this.reloadContactList(this.bDropPageAfterDelete):T.a.delay(function(){n.reloadContactList(n.bDropPageAfterDelete)},I.Magics.Time500ms)},a.prototype.removeProperty=function(e){this.viewProperties.remove(e),Object(L.delegateRunOnDestroy)(e)},a.prototype.populateViewContact=function(e){var t="",n="",o="",i=[];this.watchHash(!1),this.emptySelection(!1),this.viewReadOnly(!1),e&&(t=e.idContact,Object(L.isNonEmptyArray)(e.properties)&&T.a.each(e.properties,function(e){e&&e[0]&&(I.ContactPropertyType.LastName===e[0]?n=e[1]:I.ContactPropertyType.FirstName===e[0]?o=e[1]:i.push(new z(e[0],e[2]||"",e[1])))}),this.viewReadOnly(!!e.readOnly)),i.unshift(new z(I.ContactPropertyType.LastName,"",n,!1,this.getPropertyPlaceholder(I.ContactPropertyType.LastName))),i.unshift(new z(I.ContactPropertyType.FirstName,"",o,!e,this.getPropertyPlaceholder(I.ContactPropertyType.FirstName))),this.viewID(t),Object(L.delegateRunOnDestroy)(this.viewProperties()),this.viewProperties([]),this.viewProperties(i),this.watchDirty(!1),this.watchHash(!0)},a.prototype.reloadContactList=function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=(this.contactsPage()-1)*_.c;this.bDropPageAfterDelete=!1,e&&(this.contactsPage(1),t=0),this.contacts.loading(!0),H.a.contacts(function(e,t){var n=0,o=[];I.StorageResultType.Success===e&&t&&t.Result&&t.Result.List&&Object(L.isNonEmptyArray)(t.Result.List)&&(o=T.a.map(t.Result.List,function(e){var t=new V;return t.parse(e)?t:null}),o=T.a.compact(o),n=0<(n=Object(L.pInt)(t.Result.Count))?n:0),i.contactsCount(n),Object(L.delegateRunOnDestroy)(i.contacts()),i.contacts(o),i.contacts.loading(!1),i.viewClearSearch(""!==i.search())},t,_.c,this.search())},a.prototype.onBuild=function(e){var t=this;this.oContentVisible=A()(".b-list-content",e),this.oContentScrollable=A()(".content",this.oContentVisible),this.selector.init(this.oContentVisible,this.oContentScrollable,I.KeyState.ContactList),j()("delete",I.KeyState.ContactList,function(){return t.deleteCommand(),!1}),j()("c, w",I.KeyState.ContactList,function(){return t.newMessageCommand(),!1});var n=this;e.on("click",".e-pagenator .e-page",function(){var e=E.a.dataFor(this);e&&(n.contactsPage(Object(L.pInt)(e.value)),n.reloadContactList())}),this.initUploader()},a.prototype.onShow=function(e,t){this.bBackToCompose=!Object(L.isUnd)(e)&&!!e,this.sLastComposeFocusedField=Object(L.isUnd)(t)?"":t,Object(W.routeOff)(),this.reloadContactList(!0)},a.prototype.onHide=function(){Object(W.routeOn)(),this.currentContact(null),this.emptySelection(!0),this.search(""),this.contactsCount(0),Object(L.delegateRunOnDestroy)(this.contacts()),this.contacts([]),this.sLastComposeFocusedField="",this.bBackToCompose&&(this.bBackToCompose=!1,B.capa(I.Capa.Composer)&&Object(W.showScreenPopup)(r(64)))},a}(Y.a)).prototype,"newCommand",[o],h()(d.prototype,"newCommand"),d.prototype),$(d.prototype,"deleteCommand",[i],h()(d.prototype,"deleteCommand"),d.prototype),$(d.prototype,"newMessageCommand",[a],h()(d.prototype,"newMessageCommand"),d.prototype),$(d.prototype,"clearCommand",[s],h()(d.prototype,"clearCommand"),d.prototype),$(d.prototype,"saveCommand",[c],h()(d.prototype,"saveCommand"),d.prototype),$(d.prototype,"syncCommand",[l],h()(d.prototype,"syncCommand"),d.prototype),u=d))||u)},,,,function(e,t,n){var o;!function(){"use strict";var r={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)&&n.length){var i=s.apply(null,n);i&&e.push(i)}else if("object"===o)for(var a in n)r.call(n,a)&&n[a]&&e.push(a)}}return e.join(" ")}void 0!==e&&e.exports?(s.default=s,e.exports=s):void 0===(o=function(){return s}.apply(t,[]))||(e.exports=o)}()},function(e,t,n){e.exports=function(){"use strict";var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n="undefined"!=typeof document&&document.documentMode,d={rootMargin:"0px",threshold:0,load:function(e){if("picture"===e.nodeName.toLowerCase()){var t=document.createElement("img");n&&e.getAttribute("data-iesrc")&&(t.src=e.getAttribute("data-iesrc")),e.getAttribute("data-alt")&&(t.alt=e.getAttribute("data-alt")),e.appendChild(t)}e.getAttribute("data-src")&&(e.src=e.getAttribute("data-src")),e.getAttribute("data-srcset")&&(e.srcset=e.getAttribute("data-srcset")),e.getAttribute("data-background-image")&&(e.style.backgroundImage="url('"+e.getAttribute("data-background-image")+"')"),e.getAttribute("data-toggle-class")&&e.classList.toggle(e.getAttribute("data-toggle-class"))},loaded:function(){}};function p(e){e.setAttribute("data-loaded",!0)}var h=function(e){return"true"===e.getAttribute("data-loaded")};return function(){var n,o,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=u({},d,e),a=t.rootMargin,r=t.threshold,s=t.load,c=t.loaded,l=void 0;return window.IntersectionObserver&&(l=new IntersectionObserver((n=s,o=c,function(e,t){e.forEach(function(e){0<e.intersectionRatio&&(t.unobserve(e.target),h(e.target)||(n(e.target),p(e.target),o(e.target)))})}),{rootMargin:a,threshold:r})),{observe:function(){for(var e=(n=i)instanceof Element?[n]:n instanceof NodeList?n:document.querySelectorAll(n),t=0;t<e.length;t++)h(e[t])||(l?l.observe(e[t]):(s(e[t]),p(e[t]),c(e[t])));var n},triggerLoad:function(e){h(e)||(s(e),p(e),c(e))}}}}()},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var o=n(113),i=n(172);Object(o.a)(i.default)},function(e,t,n){"use strict";n.r(t),n.d(t,"MessageOpenPgpPopupView",function(){return I}),n.d(t,"default",function(){return I});var o,i,a,r,s,c,l,u,d,p=n(18),h=n.n(p),f=n(8),m=n.n(f),b=n(11),g=n.n(b),y=n(12),v=n.n(y),S=n(4),O=n.n(S),w=n(1),T=n(19),C=n.n(T),A=n(7),E=n.n(A),F=n(2),j=n(0),N=n(9),R=n(24),I=(o=Object(N.popup)({name:"View/Popup/MessageOpenPgp",templateID:"PopupsMessageOpenPgp"}),i=Object(N.command)(function(e){return!e.submitRequest()}),o((s=(r=function(t){function n(){m()(this,n);var e=g()(this,t.call(this));return e.notification=w.a.observable(""),e.selectedKey=w.a.observable(null),e.privateKeys=w.a.observableArray([]),e.password=w.a.observable(""),e.password.focus=w.a.observable(!1),e.buttonFocus=w.a.observable(!1),e.resultCallback=null,e.submitRequest=w.a.observable(!1),e.sDefaultKeyScope=j.KeyState.PopupMessageOpenPGP,e}return v()(n,t),n.prototype.doCommand=function(){var n=this;this.submitRequest(!0),O.a.delay(function(){var t=null;try{if(n.resultCallback&&n.selectedKey()){var e=n.selectedKey().getNativeKeys();if(t=e&&e[0]?e[0]:null)try{t.decrypt(Object(F.pString)(n.password()))||(Object(F.log)("Error: Private key cannot be decrypted"),t=null)}catch(e){Object(F.log)(e),t=null}else Object(F.log)("Error: Private key cannot be found")}}catch(e){Object(F.log)(e),t=null}n.submitRequest(!1),n.cancelCommand(),n.resultCallback(t)},j.Magics.Time100ms)},n.prototype.clearPopup=function(){this.notification(""),this.password(""),this.password.focus(!1),this.buttonFocus(!1),this.selectedKey(!1),this.submitRequest(!1),this.resultCallback=null,this.privateKeys([])},n.prototype.onBuild=function(e){var t=this;C()("tab,shift+tab",j.KeyState.PopupMessageOpenPGP,function(){switch(!0){case t.password.focus():t.buttonFocus(!0);break;case t.buttonFocus():t.password.focus(!0)}return!1});var n=this;e.on("click",".key-list__item",function(){e.find(".key-list__item .key-list__item__radio").addClass("icon-radio-unchecked").removeClass("icon-radio-checked"),E()(this).find(".key-list__item__radio").removeClass("icon-radio-unchecked").addClass("icon-radio-checked"),n.selectedKey(w.a.dataFor(this)),n.password.focus(!0)})},n.prototype.onHideWithDelay=function(){this.clearPopup()},n.prototype.onShowWithDelay=function(){this.password.focus(!0)},n.prototype.onShow=function(e,t){this.clearPopup(),this.resultCallback=e,this.privateKeys(t),this.viewModelDom&&this.viewModelDom.find(".key-list__item").first().click()},n}(R.a)).prototype,c=[i],l=h()(r.prototype,"doCommand"),u=r.prototype,d={},Object.keys(l).forEach(function(e){d[e]=l[e]}),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=c.slice().reverse().reduce(function(e,t){return t(s,"doCommand",e)||e},d),u&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(u):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(s,"doCommand",d),d=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"ComposeOpenPgpPopupView",function(){return _}),n.d(t,"default",function(){return _});var o,i,a,r,s,c,l,u=n(18),d=n.n(u),p=n(8),h=n.n(p),f=n(11),m=n.n(f),b=n(12),g=n.n(b),y=n(4),v=n.n(y),S=n(7),O=n.n(S),w=n(1),T=n(19),C=n.n(T),A=n(2),E=n(0),F=n(10),j=n(30),N=n(45),R=n(9),I=n(24);function L(n,o,e,t,i){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,o,a),a=null),a}var _=(o=Object(R.popup)({name:"View/Popup/ComposeOpenPgp",templateID:"PopupsComposeOpenPgp"}),i=Object(R.command)(function(e){return!e.submitRequest()&&(e.sign()||e.encrypt())}),a=Object(R.command)(),r=Object(R.command)(),s=Object(R.command)(),o((L((l=function(e){function t(){h()(this,t);var o=m()(this,e.call(this));return o.publicKeysOptionsCaption=Object(F.i18n)("PGP_NOTIFICATIONS/ADD_A_PUBLICK_KEY"),o.privateKeysOptionsCaption=Object(F.i18n)("PGP_NOTIFICATIONS/SELECT_A_PRIVATE_KEY"),o.notification=w.a.observable(""),o.sign=w.a.observable(!1),o.encrypt=w.a.observable(!1),o.password=w.a.observable(""),o.password.focus=w.a.observable(!1),o.buttonFocus=w.a.observable(!1),o.text=w.a.observable(""),o.selectedPrivateKey=w.a.observable(null),o.selectedPublicKey=w.a.observable(null),o.signKey=w.a.observable(null),o.encryptKeys=w.a.observableArray([]),o.encryptKeysView=w.a.computed(function(){return v.a.compact(v.a.map(o.encryptKeys(),function(e){return e?e.key:null}))}),o.privateKeysOptions=w.a.computed(function(){var e=v.a.map(j.a.openpgpkeysPrivate(),function(t,n){return o.signKey()&&o.signKey().key.id===t.id?null:v.a.map(t.users,function(e){return{id:t.guid,name:"("+t.id.substr(-8).toUpperCase()+") "+e,key:t,class:n%2?"odd":"even"}})});return v.a.compact(v.a.flatten(e,!0))}),o.publicKeysOptions=w.a.computed(function(){var e=v.a.map(j.a.openpgpkeysPublic(),function(t,n){return-1<Object(A.inArray)(t,o.encryptKeysView())?null:v.a.map(t.users,function(e){return{id:t.guid,name:"("+t.id.substr(-8).toUpperCase()+") "+e,key:t,class:n%2?"odd":"even"}})});return v.a.compact(v.a.flatten(e,!0))}),o.submitRequest=w.a.observable(!1),o.resultCallback=null,o.selectedPrivateKey.subscribe(function(e){e&&(o.selectCommand(),o.updateCommand())}),o.selectedPublicKey.subscribe(function(e){e&&o.addCommand()}),o.sDefaultKeyScope=E.KeyState.PopupComposeOpenPGP,o.defautOptionsAfterRender=A.defautOptionsAfterRender,o.addOptionClass=function(e,t){o.defautOptionsAfterRender(e,t),t&&!Object(A.isUnd)(t.class)&&e&&O()(e).addClass(t.class)},o.deletePublickKey=v.a.bind(o.deletePublickKey,o),o}return g()(t,e),t.prototype.doCommand=function(){var t=this,n=!0,o=null,i=[];if(this.submitRequest(!0),n&&this.sign()&&(this.signKey()?this.signKey().key||(this.notification(Object(F.i18n)("PGP_NOTIFICATIONS/NO_PRIVATE_KEY_FOUND_FOR",{EMAIL:this.signKey().email})),n=!1):(this.notification(Object(F.i18n)("PGP_NOTIFICATIONS/NO_PRIVATE_KEY_FOUND")),n=!1),n)){var e=this.signKey().key.getNativeKeys();o=e[0]||null;try{o&&o.decrypt(Object(A.pString)(this.password()))}catch(t){o=null}o||(this.notification(Object(F.i18n)("PGP_NOTIFICATIONS/NO_PRIVATE_KEY_FOUND")),n=!1)}return n&&this.encrypt()&&(0===this.encryptKeys().length?(this.notification(Object(F.i18n)("PGP_NOTIFICATIONS/NO_PUBLIC_KEYS_FOUND")),n=!1):this.encryptKeys()&&(i=[],v.a.each(this.encryptKeys(),function(e){e&&e.key?i=i.concat(v.a.compact(v.a.flatten(e.key.getNativeKeys()))):e&&e.email&&(t.notification(Object(F.i18n)("PGP_NOTIFICATIONS/NO_PUBLIC_KEYS_FOUND_FOR",{EMAIL:e.email})),n=!1)}),!n||0!==i.length&&this.encryptKeys().length===i.length||(n=!1))),n&&this.resultCallback?v.a.delay(function(){var e=null;try{o&&0===i.length?e=j.a.openpgp.sign({data:t.text(),privateKeys:[o]}):o&&0<i.length?e=j.a.openpgp.encrypt({data:t.text(),publicKeys:i,privateKeys:[o]}):!o&&0<i.length&&(e=j.a.openpgp.encrypt({data:t.text(),publicKeys:i}))}catch(e){Object(A.log)(e),t.notification(Object(F.i18n)("PGP_NOTIFICATIONS/PGP_ERROR",{ERROR:""+e}))}if(e)try{e.then(function(e){t.resultCallback(e.data),t.cancelCommand()}).catch(function(e){t.notification(Object(F.i18n)("PGP_NOTIFICATIONS/PGP_ERROR",{ERROR:""+e}))})}catch(e){t.notification(Object(F.i18n)("PGP_NOTIFICATIONS/PGP_ERROR",{ERROR:""+e}))}t.submitRequest(!1)},E.Magics.Time20ms):this.submitRequest(!1),n},t.prototype.selectCommand=function(){var t=this.selectedPrivateKey(),e=t?v.a.find(this.privateKeysOptions(),function(e){return e&&t===e.id}):null;e&&this.signKey({empty:!e.key,selected:w.a.observable(!!e.key),users:e.key.users,hash:e.key.id.substr(-8).toUpperCase(),key:e.key})},t.prototype.addCommand=function(){var t=this.selectedPublicKey(),e=this.encryptKeys(),n=t?v.a.find(this.publicKeysOptions(),function(e){return e&&t===e.id}):null;n&&(e.push({empty:!n.key,selected:w.a.observable(!!n.key),removable:w.a.observable(!this.sign()||!this.signKey()||this.signKey().key.id!==n.key.id),users:n.key.users,hash:n.key.id.substr(-8).toUpperCase(),key:n.key}),this.encryptKeys(e))},t.prototype.updateCommand=function(){var t=this;v.a.each(this.encryptKeys(),function(e){e.removable(!t.sign()||!t.signKey()||t.signKey().key.id!==e.key.id)})},t.prototype.deletePublickKey=function(e){this.encryptKeys.remove(e)},t.prototype.clearPopup=function(){this.notification(""),this.sign(!1),this.encrypt(!1),this.password(""),this.password.focus(!1),this.buttonFocus(!1),this.signKey(null),this.encryptKeys([]),this.text(""),this.resultCallback=null},t.prototype.onBuild=function(){var e=this;C()("tab,shift+tab",E.KeyState.PopupComposeOpenPGP,function(){switch(!0){case e.password.focus():e.buttonFocus(!0);break;case e.buttonFocus():e.password.focus(!0)}return!1})},t.prototype.onHideWithDelay=function(){this.clearPopup()},t.prototype.onShowWithDelay=function(){this.sign()?this.password.focus(!0):this.buttonFocus(!0)},t.prototype.onShow=function(e,t,n,o,i,a){var r=this;this.clearPopup();var s=[],c="",l=new N.EmailModel;if(this.resultCallback=e,""!==o&&s.push(o),""!==i&&s.push(i),""!==a&&s.push(a),s=s.join(", ").split(","),s=v.a.compact(v.a.map(s,function(e){return l.clear(),l.parse(Object(A.trim)(e)),""!==l.email&&l.email})),n&&n.email()){c=n.email(),s.unshift(c);var u=j.a.findAllPrivateKeysByEmailNotNative(c);u&&u[0]&&this.signKey({users:u[0].users||[c],hash:u[0].id.substr(-8).toUpperCase(),key:u[0]})}this.signKey()&&this.sign(!0),s&&0<s.length&&(this.encryptKeys(v.a.uniq(v.a.compact(v.a.flatten(v.a.map(s,function(t){var e=j.a.findAllPublicKeysByEmailNotNative(t);return e?v.a.map(e,function(e){return{empty:!e,selected:w.a.observable(!!e),removable:w.a.observable(!r.sign()||!r.signKey()||r.signKey().key.id!==e.id),users:e&&e.users||[t],hash:e?e.id.substr(-8).toUpperCase():"",key:e}}):[]}),!0)),function(e){return e.hash})),0<this.encryptKeys().length&&this.encrypt(!0)),this.text(t)},t}(I.a)).prototype,"doCommand",[i],d()(l.prototype,"doCommand"),l.prototype),L(l.prototype,"selectCommand",[a],d()(l.prototype,"selectCommand"),l.prototype),L(l.prototype,"addCommand",[r],d()(l.prototype,"addCommand"),l.prototype),L(l.prototype,"updateCommand",[s],d()(l.prototype,"updateCommand"),l.prototype),c=l))||c)},function(e,t,n){"use strict";n.r(t),n.d(t,"FolderClearPopupView",function(){return R}),n.d(t,"default",function(){return R});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(0),T=n(10),C=n(15),A=n(14),E=n(17),F=n(20),j=n(9),N=n(24),R=(o=Object(j.popup)({name:"View/Popup/FolderClear",templateID:"PopupsFolderClear"}),i=Object(j.command)(function(e){var t=e.selectedFolder();return!e.clearingProcess()&&null!==t}),o((s=(r=function(e){function n(){b()(this,n);var t=y()(this,e.call(this));return t.selectedFolder=O.a.observable(null),t.clearingProcess=O.a.observable(!1),t.clearingError=O.a.observable(""),t.folderFullNameForClear=O.a.computed(function(){var e=t.selectedFolder();return e?e.printableFullName():""}),t.folderNameForClear=O.a.computed(function(){var e=t.selectedFolder();return e?e.localName():""}),t.dangerDescHtml=O.a.computed(function(){return Object(T.i18n)("POPUPS_CLEAR_FOLDER/DANGER_DESC_HTML_1",{FOLDER:t.folderNameForClear()})}),t}return S()(n,e),n.prototype.clearCommand=function(){var n=this,e=this.selectedFolder();e&&(A.a.message(null),A.a.messageList([]),this.clearingProcess(!0),e.messageCountAll(0),e.messageCountUnread(0),Object(C.q)(e.fullNameRaw,""),E.a.folderClear(function(e,t){n.clearingProcess(!1),w.StorageResultType.Success===e&&t&&t.Result?(Object(F.a)().reloadMessageList(!0),n.cancelCommand()):t&&t.ErrorCode?n.clearingError(Object(T.getNotification)(t.ErrorCode)):n.clearingError(Object(T.getNotification)(w.Notification.MailServerError))},e.fullNameRaw))},n.prototype.clearPopup=function(){this.clearingProcess(!1),this.selectedFolder(null)},n.prototype.onShow=function(e){this.clearPopup(),e&&this.selectedFolder(e)},n}(N.a)).prototype,c="clearCommand",l=[i],u=f()(r.prototype,"clearCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"AdvancedSearchPopupView",function(){return R}),n.d(t,"default",function(){return R});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(4),w=n.n(O),T=n(1),C=n(2),A=n(10),E=n(34),F=n(14),j=n(9),N=n(24),R=(o=Object(j.popup)({name:"View/Popup/AdvancedSearch",templateID:"PopupsAdvancedSearch"}),i=Object(j.command)(),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.fromFocus=T.a.observable(!1),e.from=T.a.observable(""),e.to=T.a.observable(""),e.subject=T.a.observable(""),e.text=T.a.observable(""),e.selectedDateValue=T.a.observable(-1),e.hasAttachment=T.a.observable(!1),e.starred=T.a.observable(!1),e.unseen=T.a.observable(!1),e.selectedDates=T.a.computed(function(){return Object(A.trigger)(),[{id:-1,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_ALL")},{id:3,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_3_DAYS")},{id:7,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_7_DAYS")},{id:30,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_MONTH")},{id:90,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_3_MONTHS")},{id:180,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_6_MONTHS")},{id:365,name:Object(A.i18n)("SEARCH/LABEL_ADV_DATE_YEAR")}]}),e}return S()(n,t),n.prototype.searchCommand=function(){var e=this.buildSearchString();""!==e&&F.a.mainMessageListSearch(e),this.cancelCommand()},n.prototype.parseSearchStringValue=function(e){var t=this,n=(e||"").split(/[\s]+/g);w.a.each(n,function(e){switch(e){case"has:attachment":t.hasAttachment(!0);break;case"is:unseen,flagged":t.starred(!0);case"is:unseen":t.unseen(!0)}})},n.prototype.buildSearchStringValue=function(e){return-1<e.indexOf(" ")&&(e='"'+e+'"'),e},n.prototype.buildSearchString=function(){var e=[],t=Object(C.trim)(this.from()),n=Object(C.trim)(this.to()),o=Object(C.trim)(this.subject()),i=Object(C.trim)(this.text()),a=[],r=[];return t&&""!==t&&e.push("from:"+this.buildSearchStringValue(t)),n&&""!==n&&e.push("to:"+this.buildSearchStringValue(n)),o&&""!==o&&e.push("subject:"+this.buildSearchStringValue(o)),this.hasAttachment()&&r.push("attachment"),this.unseen()&&a.push("unseen"),this.starred()&&a.push("flagged"),0<r.length&&e.push("has:"+r.join(",")),0<a.length&&e.push("is:"+a.join(",")),-1<this.selectedDateValue()&&e.push("date:"+Object(E.searchSubtractFormatDateHelper)(this.selectedDateValue())+"/"),i&&""!==i&&e.push("text:"+this.buildSearchStringValue(i)),Object(C.trim)(e.join(" "))},n.prototype.clearPopup=function(){this.from(""),this.to(""),this.subject(""),this.text(""),this.selectedDateValue(-1),this.hasAttachment(!1),this.starred(!1),this.unseen(!1),this.fromFocus(!0)},n.prototype.onShow=function(e){this.clearPopup(),this.parseSearchStringValue(e)},n.prototype.onShowWithDelay=function(){this.fromFocus(!0)},n}(N.a)).prototype,c="searchCommand",l=[i],u=f()(r.prototype,"searchCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"TwoFactorTestPopupView",function(){return F}),n.d(t,"default",function(){return F});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(0),T=n(6),C=n(17),A=n(9),E=n(24),F=(o=Object(A.popup)({name:"View/Popup/TwoFactorTest",templateID:"PopupsTwoFactorTest"}),i=Object(A.command)(function(e){return""!==e.code()&&!e.testing()}),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.code=O.a.observable(""),e.code.focused=O.a.observable(!1),e.code.status=O.a.observable(null),e.koTestedTrigger=null,e.testing=O.a.observable(!1),e}return S()(n,t),n.prototype.testCodeCommand=function(){var n=this;this.testing(!0),C.a.testTwoFactor(function(e,t){n.testing(!1),n.code.status(w.StorageResultType.Success===e&&t&&!!t.Result),n.koTestedTrigger&&n.code.status()&&n.koTestedTrigger(!0)},this.code())},n.prototype.clearPopup=function(){this.code(""),this.code.focused(!1),this.code.status(null),this.testing(!1),this.koTestedTrigger=null},n.prototype.onShow=function(e){this.clearPopup(),this.koTestedTrigger=e},n.prototype.onShowWithDelay=function(){T.bMobileDevice||this.code.focused(!0)},n}(E.a)).prototype,c="testCodeCommand",l=[i],u=f()(r.prototype,"testCodeCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"AddOpenPgpKeyPopupView",function(){return F}),n.d(t,"default",function(){return F});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(1),w=n(2),T=n(30),C=n(20),A=n(9),E=n(24),F=(o=Object(A.popup)({name:"View/Popup/AddOpenPgpKey",templateID:"PopupsAddOpenPgpKey"}),i=Object(A.command)(),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.key=O.a.observable(""),e.key.focus=O.a.observable(!1),e.key.error=O.a.observable(!1),e.key.errorMessage=O.a.observable(""),e.key.subscribe(function(){e.key.error(!1),e.key.errorMessage("")}),e}return S()(n,t),n.prototype.addOpenPgpKeyCommand=function(){var e=/[\-]{3,6}BEGIN[\s]PGP[\s](PRIVATE|PUBLIC)[\s]KEY[\s]BLOCK[\-]{3,6}[\s\S]+?[\-]{3,6}END[\s]PGP[\s](PRIVATE|PUBLIC)[\s]KEY[\s]BLOCK[\-]{3,6}/gi,t=T.a.openpgpKeyring,n=Object(w.trim)(this.key());if(/[\n]/.test(n)&&(n=n.replace(/[\r]+/g,"").replace(/[\n]{2,}/g,"\n\n")),this.key.error(""===n),this.key.errorMessage(""),!t||this.key.error())return!1;var o=null,i=30,a=!1;do{if((o=e.exec(n))&&0<i){if(o[0]&&o[1]&&o[2]&&o[1]===o[2]){var r=null;"PRIVATE"===o[1]?r=t.privateKeys.importKey(o[0]):"PUBLIC"===o[1]&&(r=t.publicKeys.importKey(o[0])),r&&(this.key.error(!0),this.key.errorMessage(r&&r[0]?""+r[0]:""),Object(w.log)(r))}i-=1,a=!1}else a=!0}while(!a);return t.store(),Object(C.a)().reloadOpenPgpKeys(),!this.key.error()&&(Object(w.delegateRun)(this,"cancelCommand"),!0)},n.prototype.clearPopup=function(){this.key(""),this.key.error(!1),this.key.errorMessage("")},n.prototype.onShow=function(){this.clearPopup()},n.prototype.onShowWithDelay=function(){this.key.focus(!0)},n}(E.a)).prototype,c="addOpenPgpKeyCommand",l=[i],u=f()(r.prototype,"addOpenPgpKeyCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"NewOpenPgpKeyPopupView",function(){return R}),n.d(t,"default",function(){return R});var o,i,a,r,s,c,l,u,d,p,h=n(18),f=n.n(h),m=n(8),b=n.n(m),g=n(11),y=n.n(g),v=n(12),S=n.n(v),O=n(4),w=n.n(O),T=n(1),C=n(0),A=n(2),E=n(30),F=n(20),j=n(9),N=n(24),R=(o=Object(j.popup)({name:"View/Popup/NewOpenPgpKey",templateID:"PopupsNewOpenPgpKey"}),i=Object(j.command)(),o((s=(r=function(t){function n(){b()(this,n);var e=y()(this,t.call(this));return e.email=T.a.observable(""),e.email.focus=T.a.observable(""),e.email.error=T.a.observable(!1),e.name=T.a.observable(""),e.password=T.a.observable(""),e.keyBitLength=T.a.observable(C.Magics.BitLength2048),e.submitRequest=T.a.observable(!1),e.submitError=T.a.observable(""),e.email.subscribe(function(){e.email.error(!1)}),e}return S()(n,t),n.prototype.generateOpenPgpKeyCommand=function(){var t=this,e={},n=E.a.openpgpKeyring;return this.email.error(""===Object(A.trim)(this.email())),!(!n||this.email.error()||(e.email=this.email(),""!==this.name()&&(e.name=this.name()),this.submitRequest(!0),this.submitError(""),w.a.delay(function(){try{E.a.openpgp.generateKey({userIds:[e],numBits:Object(A.pInt)(t.keyBitLength()),passphrase:Object(A.trim)(t.password())}).then(function(e){t.submitRequest(!1),e&&e.privateKeyArmored&&(n.privateKeys.importKey(e.privateKeyArmored),n.publicKeys.importKey(e.publicKeyArmored),n.store(),Object(F.a)().reloadOpenPgpKeys(),Object(A.delegateRun)(t,"cancelCommand"))}).catch(function(e){t.submitRequest(!1),t.showError(e)})}catch(e){t.submitRequest(!1),t.showError(e)}},C.Magics.Time100ms),0))},n.prototype.showError=function(e){Object(A.log)(e),e&&e.message&&this.submitError(e.message)},n.prototype.clearPopup=function(){this.name(""),this.password(""),this.email(""),this.email.error(!1),this.keyBitLength(C.Magics.BitLength2048),this.submitError("")},n.prototype.onShow=function(){this.clearPopup()},n.prototype.onShowWithDelay=function(){this.email.focus(!0)},n}(N.a)).prototype,c="generateOpenPgpKeyCommand",l=[i],u=f()(r.prototype,"generateOpenPgpKeyCommand"),d=r.prototype,p={},Object.keys(u).forEach(function(e){p[e]=u[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(s,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(s,c,p),p=null),a=r))||a)},function(e,t,n){"use strict";n.r(t),n.d(t,"ViewOpenPgpKeyPopupView",function(){return g}),n.d(t,"default",function(){return g});var o,i=n(8),a=n.n(i),r=n(11),s=n.n(r),c=n(12),l=n.n(c),u=n(1),d=n(19),p=n.n(d),h=n(0),f=n(2),m=n(9),b=n(24),g=Object(m.popup)({name:"View/Popup/ViewOpenPgpKey",templateID:"PopupsViewOpenPgpKey"})(o=function(t){function n(){a()(this,n);var e=s()(this,t.call(this));return e.key=u.a.observable(""),e.keyDom=u.a.observable(null),e.sDefaultKeyScope=h.KeyState.PopupViewOpenPGP,e}return l()(n,t),n.prototype.clearPopup=function(){this.key("")},n.prototype.selectKey=function(){var e=this.keyDom();e&&Object(f.selectElement)(e)},n.prototype.onShow=function(e){this.clearPopup(),e&&this.key(e.armor)},n.prototype.onBuild=function(){var e=this;p()("ctrl+a, command+a",h.KeyState.PopupViewOpenPGP,function(){return e.selectKey(),!1})},n}(b.a))||o},function(e,t,n){"use strict";n.r(t),n.d(t,"WelcomePagePopupView",function(){return f}),n.d(t,"default",function(){return f});var o,i=n(8),a=n.n(i),r=n(11),s=n.n(r),c=n(12),l=n.n(c),u=n(1),d=n(51),p=n(9),h=n(24),f=Object(p.popup)({name:"View/Popup/WelcomePage",templateID:"PopupsWelcomePage"})(o=function(t){function n(){a()(this,n);var e=s()(this,t.call(this));return e.welcomePageURL=u.a.observable(""),e.closeFocused=u.a.observable(!1),e}return l()(n,t),n.prototype.clearPopup=function(){this.welcomePageURL(""),this.closeFocused(!1)},n.prototype.onShow=function(e){this.clearPopup(),this.welcomePageURL(e)},n.prototype.onShowWithDelay=function(){this.closeFocused(!0)},n.prototype.onHide=function(){d.a.welcomeClose()},n}(h.a))||o}]);
